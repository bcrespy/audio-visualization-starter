!function(n){var t={};function e(l){if(t[l])return t[l].exports;var c=t[l]={i:l,l:!1,exports:{}};return n[l].call(c.exports,c,c.exports,e),c.l=!0,c.exports}e.m=n,e.c=t,e.d=function(n,t,l){e.o(n,t)||Object.defineProperty(n,t,{configurable:!1,enumerable:!0,get:l})},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="/dist/",e(e.s=7)}([function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\r\n * Global settings used by the components\r\n */\nexports.default = {\n\n  // If set to true, the components will log the errors to the console\n  showerrors: true,\n\n  // If set to true, the components will log informations about their running\n  showloginfos: true,\n\n  // If set to true, the analyser will check if the config is properly set\n  checkConfig: true,\n\n  // The key to be pressed to show / hide HUD - if set to false huf can't be toggled\n  hudToggleKey: 'h',\n\n  // If the HUD is displayed or not by default \n  hudDisplayed: true,\n\n  // Volume of the audio at the beginning\n  volume: 0.5\n\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvY29uZmlnL2FwcC5jb25maWcuanM/NWI4OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogR2xvYmFsIHNldHRpbmdzIHVzZWQgYnkgdGhlIGNvbXBvbmVudHNcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuXHJcbiAgLy8gSWYgc2V0IHRvIHRydWUsIHRoZSBjb21wb25lbnRzIHdpbGwgbG9nIHRoZSBlcnJvcnMgdG8gdGhlIGNvbnNvbGVcclxuICBzaG93ZXJyb3JzOiB0cnVlLFxyXG5cclxuICAvLyBJZiBzZXQgdG8gdHJ1ZSwgdGhlIGNvbXBvbmVudHMgd2lsbCBsb2cgaW5mb3JtYXRpb25zIGFib3V0IHRoZWlyIHJ1bm5pbmdcclxuICBzaG93bG9naW5mb3M6IHRydWUsXHJcblxyXG4gIC8vIElmIHNldCB0byB0cnVlLCB0aGUgYW5hbHlzZXIgd2lsbCBjaGVjayBpZiB0aGUgY29uZmlnIGlzIHByb3Blcmx5IHNldFxyXG4gIGNoZWNrQ29uZmlnOiB0cnVlLFxyXG5cclxuICAvLyBUaGUga2V5IHRvIGJlIHByZXNzZWQgdG8gc2hvdyAvIGhpZGUgSFVEIC0gaWYgc2V0IHRvIGZhbHNlIGh1ZiBjYW4ndCBiZSB0b2dnbGVkXHJcbiAgaHVkVG9nZ2xlS2V5OiAnaCcsXHJcblxyXG4gIC8vIElmIHRoZSBIVUQgaXMgZGlzcGxheWVkIG9yIG5vdCBieSBkZWZhdWx0IFxyXG4gIGh1ZERpc3BsYXllZDogdHJ1ZSxcclxuXHJcbiAgLy8gVm9sdW1lIG9mIHRoZSBhdWRpbyBhdCB0aGUgYmVnaW5uaW5nXHJcbiAgdm9sdW1lOiAwLjVcclxuXHJcbn07XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9jb25maWcvYXBwLmNvbmZpZy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5CQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n")},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n      value: true\n});\n\nvar _easings = __webpack_require__(5);\n\nexports.default = {\n      /**\r\n       * These are the options the analyser is checking to see which algorithm is going\r\n       * to run. \r\n       */\n      options: {\n\n            /**\r\n             * The peak detection algorithm compares the moment energy to the recent average\r\n             * energy of the signal. \r\n             */\n            peakDetection: {\n\n                  // If this boolean is set to true, the analyser will run the algorithm\n                  enabled: true,\n\n                  // options used by the peak detection algorithm\n                  options: {\n\n                        // the higher the threshold is, the harder a peak has to hit compared to\n                        // the rest of the audio \n                        threshold: 1.8,\n\n                        // time in ms when a peak is not detectable after one has been detected\n                        ignoreTime: 300,\n\n                        // time in ms during energies are compared to the real-time energy value\n                        energyPersistence: 2000,\n\n                        // the time it takes for a peak to go from 1.0 to 0.0\n                        peakPersistency: 300,\n\n                        // This function is used to ease the decreasing value of a peak over time\n                        easing: _easings.EASINGS.linear\n\n                  }\n            },\n\n            /**\r\n             * The multiband peak detection algorithm splits the signal into multiple bands.\r\n             * For each band, it will run the peak detection algorithm to look for a peak, using\r\n             * the options specified below\r\n             */\n            multibandPeakDetection: {\n                  // If this boolean is set to true, the analuser will run the algorithm\n                  enabled: true,\n\n                  // options used by the multi-band peak detection algorithm\n                  options: {\n\n                        // number of bands in which the frequencies will be split, must be a pow of 2\n                        bands: 8,\n\n                        // the higher the threshold is, the harder a peak has to hit compared to\n                        // the rest of the audio. It is advised to use a lower threshold since the values\n                        // are less enclined to fluctuate\n                        threshold: 1.2,\n\n                        // time in ms when a peak is not detectable after one has been detected\n                        ignoreTime: 300,\n\n                        // time in ms during energies are compared to the real-time energy value\n                        energyPersistence: 1200,\n\n                        // the time it takes for a peak to go from 1.0 to 0.0\n                        peakPersistency: 300,\n\n                        // This function is used to ease the decreasing value of a peak over time\n                        easing: _easings.EASINGS.linear\n\n                  }\n            },\n\n            /**\r\n             * If one of these values are set to true, the analyser will return them with the \r\n             * getAnalysedDataForVisualization() method. This will not impact the algorithms\r\n             * proccessed on the audio. However, some on these values can\'t be set to true if\r\n             * the algorithms computing them are not enabled\r\n             */\n            returns: {\n\n                  // if the analyser returns the time domain data \n                  timedomainData: true,\n\n                  // if the analyser returns the frequencies data \n                  frequenciesData: true,\n\n                  // energy of the signal \n                  energy: true,\n\n                  // history of the last energies \n                  energyHistory: true,\n\n                  // average of the energiesHistory\n                  energyAverage: true,\n\n                  // informations on the peak\n                  peak: true,\n\n                  // all the peaks detected \n                  peakHistory: true,\n\n                  // energy of each band\n                  multibandEnergy: true,\n\n                  // history of each band energy\n                  multibandEnergyHistory: true,\n\n                  // average of each band energies history\n                  multibandEnergyAverage: true,\n\n                  // each band peak informations\n                  multibandPeak: true,\n\n                  // history of each band detected peaks !!! MUST BE EQUAL TO peakHistory due to poor conception (also good optimization)\n                  multibandPeakHistory: true\n\n            }\n      }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvY29uZmlnL2FuYWx5c2VyLmNvbmZpZy5qcz8zZTU4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVBU0lOR1MgfSBmcm9tICcuLi91dGlsaXR5L2Vhc2luZ3MnO1xyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFxyXG57XHJcbiAgLyoqXHJcbiAgICogVGhlc2UgYXJlIHRoZSBvcHRpb25zIHRoZSBhbmFseXNlciBpcyBjaGVja2luZyB0byBzZWUgd2hpY2ggYWxnb3JpdGhtIGlzIGdvaW5nXHJcbiAgICogdG8gcnVuLiBcclxuICAgKi9cclxuICBvcHRpb25zOiB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcGVhayBkZXRlY3Rpb24gYWxnb3JpdGhtIGNvbXBhcmVzIHRoZSBtb21lbnQgZW5lcmd5IHRvIHRoZSByZWNlbnQgYXZlcmFnZVxyXG4gICAgICogZW5lcmd5IG9mIHRoZSBzaWduYWwuIFxyXG4gICAgICovXHJcbiAgICBwZWFrRGV0ZWN0aW9uOiB7XHJcblxyXG4gICAgICAvLyBJZiB0aGlzIGJvb2xlYW4gaXMgc2V0IHRvIHRydWUsIHRoZSBhbmFseXNlciB3aWxsIHJ1biB0aGUgYWxnb3JpdGhtXHJcbiAgICAgIGVuYWJsZWQ6IHRydWUsXHJcblxyXG4gICAgICAvLyBvcHRpb25zIHVzZWQgYnkgdGhlIHBlYWsgZGV0ZWN0aW9uIGFsZ29yaXRobVxyXG4gICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gdGhlIGhpZ2hlciB0aGUgdGhyZXNob2xkIGlzLCB0aGUgaGFyZGVyIGEgcGVhayBoYXMgdG8gaGl0IGNvbXBhcmVkIHRvXHJcbiAgICAgICAgLy8gdGhlIHJlc3Qgb2YgdGhlIGF1ZGlvIFxyXG4gICAgICAgIHRocmVzaG9sZDogMS44LFxyXG5cclxuICAgICAgICAvLyB0aW1lIGluIG1zIHdoZW4gYSBwZWFrIGlzIG5vdCBkZXRlY3RhYmxlIGFmdGVyIG9uZSBoYXMgYmVlbiBkZXRlY3RlZFxyXG4gICAgICAgIGlnbm9yZVRpbWU6IDMwMCxcclxuXHJcbiAgICAgICAgLy8gdGltZSBpbiBtcyBkdXJpbmcgZW5lcmdpZXMgYXJlIGNvbXBhcmVkIHRvIHRoZSByZWFsLXRpbWUgZW5lcmd5IHZhbHVlXHJcbiAgICAgICAgZW5lcmd5UGVyc2lzdGVuY2U6IDIwMDAsXHJcblxyXG4gICAgICAgIC8vIHRoZSB0aW1lIGl0IHRha2VzIGZvciBhIHBlYWsgdG8gZ28gZnJvbSAxLjAgdG8gMC4wXHJcbiAgICAgICAgcGVha1BlcnNpc3RlbmN5OiAzMDAsXHJcblxyXG4gICAgICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBlYXNlIHRoZSBkZWNyZWFzaW5nIHZhbHVlIG9mIGEgcGVhayBvdmVyIHRpbWVcclxuICAgICAgICBlYXNpbmc6IEVBU0lOR1MubGluZWFyXHJcblxyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhlIG11bHRpYmFuZCBwZWFrIGRldGVjdGlvbiBhbGdvcml0aG0gc3BsaXRzIHRoZSBzaWduYWwgaW50byBtdWx0aXBsZSBiYW5kcy5cclxuICAgICAqIEZvciBlYWNoIGJhbmQsIGl0IHdpbGwgcnVuIHRoZSBwZWFrIGRldGVjdGlvbiBhbGdvcml0aG0gdG8gbG9vayBmb3IgYSBwZWFrLCB1c2luZ1xyXG4gICAgICogdGhlIG9wdGlvbnMgc3BlY2lmaWVkIGJlbG93XHJcbiAgICAgKi9cclxuICAgIG11bHRpYmFuZFBlYWtEZXRlY3Rpb246IFxyXG4gICAge1xyXG4gICAgICAvLyBJZiB0aGlzIGJvb2xlYW4gaXMgc2V0IHRvIHRydWUsIHRoZSBhbmFsdXNlciB3aWxsIHJ1biB0aGUgYWxnb3JpdGhtXHJcbiAgICAgIGVuYWJsZWQ6IHRydWUsXHJcblxyXG4gICAgICAvLyBvcHRpb25zIHVzZWQgYnkgdGhlIG11bHRpLWJhbmQgcGVhayBkZXRlY3Rpb24gYWxnb3JpdGhtXHJcbiAgICAgIG9wdGlvbnM6IHtcclxuXHJcbiAgICAgICAgLy8gbnVtYmVyIG9mIGJhbmRzIGluIHdoaWNoIHRoZSBmcmVxdWVuY2llcyB3aWxsIGJlIHNwbGl0LCBtdXN0IGJlIGEgcG93IG9mIDJcclxuICAgICAgICBiYW5kczogOCxcclxuXHJcbiAgICAgICAgLy8gdGhlIGhpZ2hlciB0aGUgdGhyZXNob2xkIGlzLCB0aGUgaGFyZGVyIGEgcGVhayBoYXMgdG8gaGl0IGNvbXBhcmVkIHRvXHJcbiAgICAgICAgLy8gdGhlIHJlc3Qgb2YgdGhlIGF1ZGlvLiBJdCBpcyBhZHZpc2VkIHRvIHVzZSBhIGxvd2VyIHRocmVzaG9sZCBzaW5jZSB0aGUgdmFsdWVzXHJcbiAgICAgICAgLy8gYXJlIGxlc3MgZW5jbGluZWQgdG8gZmx1Y3R1YXRlXHJcbiAgICAgICAgdGhyZXNob2xkOiAxLjIsXHJcblxyXG4gICAgICAgIC8vIHRpbWUgaW4gbXMgd2hlbiBhIHBlYWsgaXMgbm90IGRldGVjdGFibGUgYWZ0ZXIgb25lIGhhcyBiZWVuIGRldGVjdGVkXHJcbiAgICAgICAgaWdub3JlVGltZTogMzAwLFxyXG5cclxuICAgICAgICAvLyB0aW1lIGluIG1zIGR1cmluZyBlbmVyZ2llcyBhcmUgY29tcGFyZWQgdG8gdGhlIHJlYWwtdGltZSBlbmVyZ3kgdmFsdWVcclxuICAgICAgICBlbmVyZ3lQZXJzaXN0ZW5jZTogMTIwMCxcclxuXHJcbiAgICAgICAgLy8gdGhlIHRpbWUgaXQgdGFrZXMgZm9yIGEgcGVhayB0byBnbyBmcm9tIDEuMCB0byAwLjBcclxuICAgICAgICBwZWFrUGVyc2lzdGVuY3k6IDMwMCxcclxuXHJcbiAgICAgICAgLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGVhc2UgdGhlIGRlY3JlYXNpbmcgdmFsdWUgb2YgYSBwZWFrIG92ZXIgdGltZVxyXG4gICAgICAgIGVhc2luZzogRUFTSU5HUy5saW5lYXJcclxuXHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJZiBvbmUgb2YgdGhlc2UgdmFsdWVzIGFyZSBzZXQgdG8gdHJ1ZSwgdGhlIGFuYWx5c2VyIHdpbGwgcmV0dXJuIHRoZW0gd2l0aCB0aGUgXHJcbiAgICAgKiBnZXRBbmFseXNlZERhdGFGb3JWaXN1YWxpemF0aW9uKCkgbWV0aG9kLiBUaGlzIHdpbGwgbm90IGltcGFjdCB0aGUgYWxnb3JpdGhtc1xyXG4gICAgICogcHJvY2Nlc3NlZCBvbiB0aGUgYXVkaW8uIEhvd2V2ZXIsIHNvbWUgb24gdGhlc2UgdmFsdWVzIGNhbid0IGJlIHNldCB0byB0cnVlIGlmXHJcbiAgICAgKiB0aGUgYWxnb3JpdGhtcyBjb21wdXRpbmcgdGhlbSBhcmUgbm90IGVuYWJsZWRcclxuICAgICAqL1xyXG4gICAgcmV0dXJuczoge1xyXG5cclxuICAgICAgLy8gaWYgdGhlIGFuYWx5c2VyIHJldHVybnMgdGhlIHRpbWUgZG9tYWluIGRhdGEgXHJcbiAgICAgIHRpbWVkb21haW5EYXRhOiB0cnVlLFxyXG5cclxuICAgICAgLy8gaWYgdGhlIGFuYWx5c2VyIHJldHVybnMgdGhlIGZyZXF1ZW5jaWVzIGRhdGEgXHJcbiAgICAgIGZyZXF1ZW5jaWVzRGF0YTogdHJ1ZSxcclxuXHJcbiAgICAgIC8vIGVuZXJneSBvZiB0aGUgc2lnbmFsIFxyXG4gICAgICBlbmVyZ3k6IHRydWUsXHJcblxyXG4gICAgICAvLyBoaXN0b3J5IG9mIHRoZSBsYXN0IGVuZXJnaWVzIFxyXG4gICAgICBlbmVyZ3lIaXN0b3J5OiB0cnVlLFxyXG5cclxuICAgICAgLy8gYXZlcmFnZSBvZiB0aGUgZW5lcmdpZXNIaXN0b3J5XHJcbiAgICAgIGVuZXJneUF2ZXJhZ2U6IHRydWUsXHJcblxyXG4gICAgICAvLyBpbmZvcm1hdGlvbnMgb24gdGhlIHBlYWtcclxuICAgICAgcGVhazogdHJ1ZSxcclxuXHJcbiAgICAgIC8vIGFsbCB0aGUgcGVha3MgZGV0ZWN0ZWQgXHJcbiAgICAgIHBlYWtIaXN0b3J5OiB0cnVlLFxyXG5cclxuICAgICAgLy8gZW5lcmd5IG9mIGVhY2ggYmFuZFxyXG4gICAgICBtdWx0aWJhbmRFbmVyZ3k6IHRydWUsXHJcblxyXG4gICAgICAvLyBoaXN0b3J5IG9mIGVhY2ggYmFuZCBlbmVyZ3lcclxuICAgICAgbXVsdGliYW5kRW5lcmd5SGlzdG9yeTogdHJ1ZSxcclxuXHJcbiAgICAgIC8vIGF2ZXJhZ2Ugb2YgZWFjaCBiYW5kIGVuZXJnaWVzIGhpc3RvcnlcclxuICAgICAgbXVsdGliYW5kRW5lcmd5QXZlcmFnZTogdHJ1ZSxcclxuXHJcbiAgICAgIC8vIGVhY2ggYmFuZCBwZWFrIGluZm9ybWF0aW9uc1xyXG4gICAgICBtdWx0aWJhbmRQZWFrOiB0cnVlLFxyXG5cclxuICAgICAgLy8gaGlzdG9yeSBvZiBlYWNoIGJhbmQgZGV0ZWN0ZWQgcGVha3MgISEhIE1VU1QgQkUgRVFVQUwgVE8gcGVha0hpc3RvcnkgZHVlIHRvIHBvb3IgY29uY2VwdGlvbiAoYWxzbyBnb29kIG9wdGltaXphdGlvbilcclxuICAgICAgbXVsdGliYW5kUGVha0hpc3Rvcnk6IHRydWVcclxuXHJcbiAgICB9XHJcbiAgfSxcclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NvbmZpZy9hbmFseXNlci5jb25maWcuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFHQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJBO0FBTkE7QUFDQTtBQTBCQTs7Ozs7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQkE7QUFMQTtBQUNBO0FBNkJBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBckNBO0FBM0VBO0FBTEEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///1\n')},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\n/**\r\n * This class provides a simple loader screen\r\n */\nvar Loader = exports.Loader = function () {\n  /**\r\n   * Append a very simple loader screen to the DOM\r\n   * method loaded() has to be called to make the screen disappear\r\n   * @param {string=} loadingText the text to be displayed on the loading screen\r\n   */\n  function Loader(loadingText) {\n    var _this = this;\n\n    _classCallCheck(this, Loader);\n\n    document.body.innerHTML += "<div id=\\"loader\\"><div class=\\"loading-text\\">" + (loadingText || "LOADING") + "</div></div>";\n    this.domElement = document.getElementById("loader");\n    setTimeout(function () {\n      _this.domElement.classList.add("loading");\n    }, 10);\n  }\n\n  /**\r\n   * This method has to be called to fade out the loading screen\r\n   * It will then be removed from the DOM\r\n   */\n\n\n  _createClass(Loader, [{\n    key: "loaded",\n    value: function loaded() {\n      var _this2 = this;\n\n      this.domElement.classList.remove(\'loading\');\n      this.domElement.classList.add(\'loaded\');\n      setTimeout(function () {\n        _this2.domElement.remove();\n      }, 1000);\n    }\n  }]);\n\n  return Loader;\n}();\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvbG9hZGVyL2xvYWRlci5qcz9kN2ZmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGEgc2ltcGxlIGxvYWRlciBzY3JlZW5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBMb2FkZXJcclxue1xyXG4gIC8qKlxyXG4gICAqIEFwcGVuZCBhIHZlcnkgc2ltcGxlIGxvYWRlciBzY3JlZW4gdG8gdGhlIERPTVxyXG4gICAqIG1ldGhvZCBsb2FkZWQoKSBoYXMgdG8gYmUgY2FsbGVkIHRvIG1ha2UgdGhlIHNjcmVlbiBkaXNhcHBlYXJcclxuICAgKiBAcGFyYW0ge3N0cmluZz19IGxvYWRpbmdUZXh0IHRoZSB0ZXh0IHRvIGJlIGRpc3BsYXllZCBvbiB0aGUgbG9hZGluZyBzY3JlZW5cclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggbG9hZGluZ1RleHQgKVxyXG4gIHtcclxuICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MKz0gYDxkaXYgaWQ9XCJsb2FkZXJcIj48ZGl2IGNsYXNzPVwibG9hZGluZy10ZXh0XCI+JHtsb2FkaW5nVGV4dCB8fCBcIkxPQURJTkdcIn08L2Rpdj48L2Rpdj5gO1xyXG4gICAgdGhpcy5kb21FbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2FkZXJcIik7XHJcbiAgICBzZXRUaW1lb3V0KCgpPT57XHJcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibG9hZGluZ1wiKTtcclxuICAgIH0sIDEwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgbWV0aG9kIGhhcyB0byBiZSBjYWxsZWQgdG8gZmFkZSBvdXQgdGhlIGxvYWRpbmcgc2NyZWVuXHJcbiAgICogSXQgd2lsbCB0aGVuIGJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NXHJcbiAgICovXHJcbiAgbG9hZGVkKClcclxuICB7XHJcbiAgICB0aGlzLmRvbUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGluZycpO1xyXG4gICAgdGhpcy5kb21FbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2xvYWRlZCcpO1xyXG4gICAgc2V0VGltZW91dCgoKT0+e1xyXG4gICAgICB0aGlzLmRvbUVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB9LCAxMDAwKTtcclxuICB9XHJcbn07XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9sb2FkZXIvbG9hZGVyLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7OztBQUdBO0FBRUE7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///2\n')},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.AudioSource = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\n/**\r\n * Loads audio from a source\r\n * The source can only be, for now, a file or a microphone\r\n * Relies on the web audio API\r\n * [https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API]\r\n */\nvar AudioSource = exports.AudioSource = function () {\n  /** */\n  function AudioSource() {\n    _classCallCheck(this, AudioSource);\n\n    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n    this.source = false;\n    this.sourceType = "";\n  }\n\n  /**\r\n   * Loads audio from a file stored in the library\r\n   * @param {string} filepath Path to the file to be loaded \r\n   * @returns {Promise} A promise that resolves if the file is loaded, rejected if the file \r\n   * cannot be loaded or if the file isn\'t a valid audio file\r\n   */\n\n\n  _createClass(AudioSource, [{\n    key: "loadAudioFromLibrary",\n    value: function loadAudioFromLibrary(filepath) {\n      var _this = this;\n\n      if (_app2.default.showloginfos) console.log("Loading file " + filepath);\n\n      return new Promise(function (resolve, reject) {\n        _this.loadFile(filepath).then(function (audioData) {\n          _this.audioContext.decodeAudioData(audioData).then(function (buffer) {\n            _this.source = _this.audioContext.createBufferSource();\n            _this.source.buffer = buffer;\n            _this.sourceType = "audiofile";\n            if (_app2.default.showloginfos) console.log("Audio from file " + filepath + " loaded\\n------------");\n            resolve();\n          }).catch(function (error) {\n            if (_app2.default.showerrors) console.error("File " + filepath + " loaded, but can\'t decode audio data.\\n" + error);\n            reject(error);\n          });\n        }).catch(function (error) {\n          if (_app2.default.showerrors) console.error("File " + filepath + " cannot be loaded.\\n" + error);\n          reject(error);\n        });\n      });\n    }\n\n    /**\r\n     * Loads audio stream from a file provided by the user\r\n     * @param {File} file The inpit file loaded into the browser\r\n     * @returns {Promise} a promise that resolves once the audio is loaded\r\n     */\n\n  }, {\n    key: "loadAudioFromFile",\n    value: function loadAudioFromFile(file) {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n\n        var reader = new FileReader();\n        reader.addEventListener(\'load\', function (e) {\n          var data = e.target.result;\n          _this2.audioContext.decodeAudioData(data).then(function (buffer) {\n            _this2.source = _this2.audioContext.createBufferSource();\n            _this2.source.buffer = buffer;\n            _this2.sourceType = "audiofile";\n            if (_app2.default.showloginfos) console.log("Audio from file loaded\\n------------");\n            resolve();\n          });\n        });\n        reader.readAsArrayBuffer(file);\n      });\n    }\n\n    /**\r\n     * Grab stream from user media\r\n     * if user media is not available, throws an error\r\n     * @param {boolean=} audioFeedback If the microphone stream is sent to the destination\r\n     * @returns {Promise} A promise that resolves if the stream from the microphone can be loaded,\r\n     * rejected if getUserMedia is not supported or if access to microphone is denied by the user\r\n     */\n\n  }, {\n    key: "getStreamFromMicrophone",\n    value: function getStreamFromMicrophone(audioFeedback) {\n      var _this3 = this;\n\n      if (_app2.default.showloginfos) console.log(\'Setting up microphone\');\n\n      if (typeof audioFeedback == "undefined") this.audioFeedback = false;else this.audioFeedback = audioFeedback;\n\n      return new Promise(function (resolve, reject) {\n        if (navigator.mediaDevices) {\n          navigator.mediaDevices.getUserMedia({ audio: true }).then(function (stream) {\n            _this3.source = _this3.audioContext.createMediaStreamSource(stream);\n            _this3.sourceType = "microphone";\n            if (_app2.default.showloginfos) console.log("Audio stream is coming from microphone");\n            resolve();\n          }).catch(function (error) {\n            if (_app2.default.showerrors) console.error("The following gUM error occured: " + error);\n            reject("The following gUM error occured: " + error);\n          });\n        } else {\n          if (_app2.default.showerrors) console.log(\'getUserMedia is not supported on this browser\');\n          reject("getUserMedia is not supported on this browser");\n        }\n      });\n    }\n\n    /**\r\n     * Private method\r\n     * Loads a file using XMLHttpRequest\r\n     * @param {string} filepath Path to the file to load\r\n     */\n\n  }, {\n    key: "loadFile",\n    value: function loadFile(filepath) {\n      return new Promise(function (resolve, reject) {\n        var xhr = new XMLHttpRequest();\n        xhr.responseType = \'arraybuffer\';\n        xhr.open("GET", filepath, true);\n        xhr.onloadend = function () {\n          if (xhr.status == 404) reject(xhr.statusText);else resolve(xhr.response);\n        };\n        xhr.send();\n      });\n    }\n\n    /**\r\n     * Starts the audio \r\n     * Can only be used if audio was loaded from a fil\r\n     * @param {number=} when When the the audio will start to play, in s (optional)\r\n     * @param {number=} offset Offset on the sound to play, in s (optional)\r\n     */\n\n  }, {\n    key: "play",\n    value: function play(when, offset) {\n      if (typeof when == "undefined") when = 0;\n      if (typeof offset == "undefined") offset = 0;\n\n      if (this.sourceType == "audiofile") this.source.start(when, offset);else {\n        if (_app2.default.showerrors) console.error("Couldn\'t start the audio source. Source is a microphone.");\n      }\n    }\n\n    /**\r\n     * @returns {boolean} true if there is feedback\r\n     */\n\n  }, {\n    key: "isThereFeedback",\n    value: function isThereFeedback() {\n      if (this.sourceType == "microphone") return this.audioFeedback;else return true;\n    }\n\n    /**\r\n     * @return The audio context\r\n     */\n\n  }, {\n    key: "getAudioContext",\n    value: function getAudioContext() {\n      return this.audioContext;\n    }\n\n    /**\r\n     * @returns Node containing the source stream if set up, false instead\r\n     */\n\n  }, {\n    key: "getSourceNode",\n    value: function getSourceNode() {\n      if (_app2.default.showerrors && !this.source) console.error("Audio source has not bet set up");\n      return this.source;\n    }\n  }]);\n\n  return AudioSource;\n}();\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvYXVkaW9zdHJlYW0vYXVkaW8tc291cmNlLmpzP2EzYjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNvbmZpZyBmcm9tICcuLi9jb25maWcvYXBwLmNvbmZpZyc7XHJcblxyXG4vKipcclxuICogTG9hZHMgYXVkaW8gZnJvbSBhIHNvdXJjZVxyXG4gKiBUaGUgc291cmNlIGNhbiBvbmx5IGJlLCBmb3Igbm93LCBhIGZpbGUgb3IgYSBtaWNyb3Bob25lXHJcbiAqIFJlbGllcyBvbiB0aGUgd2ViIGF1ZGlvIEFQSVxyXG4gKiBbaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1dlYl9BdWRpb19BUEldXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQXVkaW9Tb3VyY2Vcclxue1xyXG4gIC8qKiAqL1xyXG4gIGNvbnN0cnVjdG9yKClcclxuICB7XHJcbiAgICB0aGlzLmF1ZGlvQ29udGV4dCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSgpO1xyXG4gICAgdGhpcy5zb3VyY2UgPSBmYWxzZTtcclxuICAgIHRoaXMuc291cmNlVHlwZSA9IFwiXCI7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogTG9hZHMgYXVkaW8gZnJvbSBhIGZpbGUgc3RvcmVkIGluIHRoZSBsaWJyYXJ5XHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZpbGVwYXRoIFBhdGggdG8gdGhlIGZpbGUgdG8gYmUgbG9hZGVkIFxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBBIHByb21pc2UgdGhhdCByZXNvbHZlcyBpZiB0aGUgZmlsZSBpcyBsb2FkZWQsIHJlamVjdGVkIGlmIHRoZSBmaWxlIFxyXG4gICAqIGNhbm5vdCBiZSBsb2FkZWQgb3IgaWYgdGhlIGZpbGUgaXNuJ3QgYSB2YWxpZCBhdWRpbyBmaWxlXHJcbiAgICovXHJcbiAgbG9hZEF1ZGlvRnJvbUxpYnJhcnkoIGZpbGVwYXRoIClcclxuICB7XHJcbiAgICBpZiggY29uZmlnLnNob3dsb2dpbmZvcyApIGNvbnNvbGUubG9nKCBgTG9hZGluZyBmaWxlICR7ZmlsZXBhdGh9YCApO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSggKHJlc29sdmUsIHJlamVjdCkgPT4geyAgXHJcbiAgICAgIHRoaXMubG9hZEZpbGUoIGZpbGVwYXRoICkudGhlbiggKGF1ZGlvRGF0YSkgPT4ge1xyXG4gICAgICAgIHRoaXMuYXVkaW9Db250ZXh0LmRlY29kZUF1ZGlvRGF0YSggYXVkaW9EYXRhICkudGhlbiggKGJ1ZmZlcikgPT4ge1xyXG4gICAgICAgICAgdGhpcy5zb3VyY2UgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcclxuICAgICAgICAgIHRoaXMuc291cmNlLmJ1ZmZlciA9IGJ1ZmZlcjtcclxuICAgICAgICAgIHRoaXMuc291cmNlVHlwZSA9IFwiYXVkaW9maWxlXCI7XHJcbiAgICAgICAgICBpZiggY29uZmlnLnNob3dsb2dpbmZvcyApIGNvbnNvbGUubG9nKCBgQXVkaW8gZnJvbSBmaWxlICR7ZmlsZXBhdGh9IGxvYWRlZFxcbi0tLS0tLS0tLS0tLWAgKTtcclxuICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9KS5jYXRjaCggKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICBpZiggY29uZmlnLnNob3dlcnJvcnMgKSBjb25zb2xlLmVycm9yKCBgRmlsZSAke2ZpbGVwYXRofSBsb2FkZWQsIGJ1dCBjYW4ndCBkZWNvZGUgYXVkaW8gZGF0YS5cXG4ke2Vycm9yfWApO1xyXG4gICAgICAgICAgcmVqZWN0KCBlcnJvciApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KS5jYXRjaCggKGVycm9yKSA9PiB7XHJcbiAgICAgICAgaWYoIGNvbmZpZy5zaG93ZXJyb3JzICkgY29uc29sZS5lcnJvciggYEZpbGUgJHtmaWxlcGF0aH0gY2Fubm90IGJlIGxvYWRlZC5cXG4ke2Vycm9yfWApXHJcbiAgICAgICAgcmVqZWN0KCBlcnJvciApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIExvYWRzIGF1ZGlvIHN0cmVhbSBmcm9tIGEgZmlsZSBwcm92aWRlZCBieSB0aGUgdXNlclxyXG4gICAqIEBwYXJhbSB7RmlsZX0gZmlsZSBUaGUgaW5waXQgZmlsZSBsb2FkZWQgaW50byB0aGUgYnJvd3NlclxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBhIHByb21pc2UgdGhhdCByZXNvbHZlcyBvbmNlIHRoZSBhdWRpbyBpcyBsb2FkZWRcclxuICAgKi9cclxuICBsb2FkQXVkaW9Gcm9tRmlsZSggZmlsZSApXHJcbiAge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKCAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblxyXG4gICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgICAgcmVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoICdsb2FkJywgKGUpID0+IHtcclxuICAgICAgICBsZXQgZGF0YSA9IGUudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICB0aGlzLmF1ZGlvQ29udGV4dC5kZWNvZGVBdWRpb0RhdGEoZGF0YSkudGhlbiggKGJ1ZmZlcikgPT4ge1xyXG4gICAgICAgICAgdGhpcy5zb3VyY2UgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcclxuICAgICAgICAgIHRoaXMuc291cmNlLmJ1ZmZlciA9IGJ1ZmZlcjtcclxuICAgICAgICAgIHRoaXMuc291cmNlVHlwZSA9IFwiYXVkaW9maWxlXCI7XHJcbiAgICAgICAgICBpZiggY29uZmlnLnNob3dsb2dpbmZvcyApIGNvbnNvbGUubG9nKCBgQXVkaW8gZnJvbSBmaWxlIGxvYWRlZFxcbi0tLS0tLS0tLS0tLWAgKTtcclxuICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlciggZmlsZSApO1xyXG5cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEdyYWIgc3RyZWFtIGZyb20gdXNlciBtZWRpYVxyXG4gICAqIGlmIHVzZXIgbWVkaWEgaXMgbm90IGF2YWlsYWJsZSwgdGhyb3dzIGFuIGVycm9yXHJcbiAgICogQHBhcmFtIHtib29sZWFuPX0gYXVkaW9GZWVkYmFjayBJZiB0aGUgbWljcm9waG9uZSBzdHJlYW0gaXMgc2VudCB0byB0aGUgZGVzdGluYXRpb25cclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgaWYgdGhlIHN0cmVhbSBmcm9tIHRoZSBtaWNyb3Bob25lIGNhbiBiZSBsb2FkZWQsXHJcbiAgICogcmVqZWN0ZWQgaWYgZ2V0VXNlck1lZGlhIGlzIG5vdCBzdXBwb3J0ZWQgb3IgaWYgYWNjZXNzIHRvIG1pY3JvcGhvbmUgaXMgZGVuaWVkIGJ5IHRoZSB1c2VyXHJcbiAgICovXHJcbiAgZ2V0U3RyZWFtRnJvbU1pY3JvcGhvbmUoIGF1ZGlvRmVlZGJhY2sgKVxyXG4gIHtcclxuICAgIGlmKCBjb25maWcuc2hvd2xvZ2luZm9zICkgY29uc29sZS5sb2coICdTZXR0aW5nIHVwIG1pY3JvcGhvbmUnICk7XHJcblxyXG4gICAgaWYoIHR5cGVvZihhdWRpb0ZlZWRiYWNrKSA9PSBcInVuZGVmaW5lZFwiICkgXHJcbiAgICAgIHRoaXMuYXVkaW9GZWVkYmFjayA9IGZhbHNlO1xyXG4gICAgZWxzZSBcclxuICAgICAgdGhpcy5hdWRpb0ZlZWRiYWNrID0gYXVkaW9GZWVkYmFjaztcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoIChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgaWYoIG5hdmlnYXRvci5tZWRpYURldmljZXMgKVxyXG4gICAgICB7XHJcbiAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoIHsgYXVkaW86IHRydWUgfSApLnRoZW4oIChzdHJlYW0pID0+IHtcclxuICAgICAgICAgIHRoaXMuc291cmNlID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2UoIHN0cmVhbSApO1xyXG4gICAgICAgICAgdGhpcy5zb3VyY2VUeXBlID0gXCJtaWNyb3Bob25lXCI7XHJcbiAgICAgICAgICBpZiggY29uZmlnLnNob3dsb2dpbmZvcyApIGNvbnNvbGUubG9nKCBcIkF1ZGlvIHN0cmVhbSBpcyBjb21pbmcgZnJvbSBtaWNyb3Bob25lXCIgKTtcclxuICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9KS5jYXRjaCggKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICBpZiggY29uZmlnLnNob3dlcnJvcnMgKSBjb25zb2xlLmVycm9yKCBgVGhlIGZvbGxvd2luZyBnVU0gZXJyb3Igb2NjdXJlZDogJHtlcnJvcn1gICk7XHJcbiAgICAgICAgICByZWplY3QoIGBUaGUgZm9sbG93aW5nIGdVTSBlcnJvciBvY2N1cmVkOiAke2Vycm9yfWAgKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlXHJcbiAgICAgIHtcclxuICAgICAgICBpZiggY29uZmlnLnNob3dlcnJvcnMgKSBjb25zb2xlLmxvZyggJ2dldFVzZXJNZWRpYSBpcyBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgYnJvd3NlcicpO1xyXG4gICAgICAgIHJlamVjdCggXCJnZXRVc2VyTWVkaWEgaXMgbm90IHN1cHBvcnRlZCBvbiB0aGlzIGJyb3dzZXJcIiApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBQcml2YXRlIG1ldGhvZFxyXG4gICAqIExvYWRzIGEgZmlsZSB1c2luZyBYTUxIdHRwUmVxdWVzdFxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlcGF0aCBQYXRoIHRvIHRoZSBmaWxlIHRvIGxvYWRcclxuICAgKi9cclxuICBsb2FkRmlsZSggZmlsZXBhdGggKVxyXG4gIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSggKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBjb25zdCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdhcnJheWJ1ZmZlcic7XHJcbiAgICAgIHhoci5vcGVuKCBcIkdFVFwiLCBmaWxlcGF0aCwgdHJ1ZSApO1xyXG4gICAgICB4aHIub25sb2FkZW5kID0gKCkgPT4ge1xyXG4gICAgICAgIGlmKCB4aHIuc3RhdHVzID09IDQwNCApIFxyXG4gICAgICAgICAgcmVqZWN0KCB4aHIuc3RhdHVzVGV4dCApO1xyXG4gICAgICAgIGVsc2UgXHJcbiAgICAgICAgICByZXNvbHZlKCB4aHIucmVzcG9uc2UgKTtcclxuICAgICAgfVxyXG4gICAgICB4aHIuc2VuZCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnRzIHRoZSBhdWRpbyBcclxuICAgKiBDYW4gb25seSBiZSB1c2VkIGlmIGF1ZGlvIHdhcyBsb2FkZWQgZnJvbSBhIGZpbFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyPX0gd2hlbiBXaGVuIHRoZSB0aGUgYXVkaW8gd2lsbCBzdGFydCB0byBwbGF5LCBpbiBzIChvcHRpb25hbClcclxuICAgKiBAcGFyYW0ge251bWJlcj19IG9mZnNldCBPZmZzZXQgb24gdGhlIHNvdW5kIHRvIHBsYXksIGluIHMgKG9wdGlvbmFsKVxyXG4gICAqL1xyXG4gIHBsYXkoIHdoZW4sIG9mZnNldCApXHJcbiAge1xyXG4gICAgaWYoIHR5cGVvZih3aGVuKSA9PSBcInVuZGVmaW5lZFwiIClcclxuICAgICAgd2hlbiA9IDA7XHJcbiAgICBpZiggdHlwZW9mKG9mZnNldCkgPT0gXCJ1bmRlZmluZWRcIiApXHJcbiAgICAgIG9mZnNldCA9IDA7XHJcblxyXG4gICAgaWYoIHRoaXMuc291cmNlVHlwZSA9PSBcImF1ZGlvZmlsZVwiIClcclxuICAgICAgdGhpcy5zb3VyY2Uuc3RhcnQod2hlbiwgb2Zmc2V0KTtcclxuICAgIGVsc2UgXHJcbiAgICB7XHJcbiAgICAgIGlmKCBjb25maWcuc2hvd2Vycm9ycyApIGNvbnNvbGUuZXJyb3IoIGBDb3VsZG4ndCBzdGFydCB0aGUgYXVkaW8gc291cmNlLiBTb3VyY2UgaXMgYSBtaWNyb3Bob25lLmAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiB0aGVyZSBpcyBmZWVkYmFja1xyXG4gICAqL1xyXG4gIGlzVGhlcmVGZWVkYmFjaygpXHJcbiAge1xyXG4gICAgaWYoIHRoaXMuc291cmNlVHlwZSA9PSBcIm1pY3JvcGhvbmVcIiApXHJcbiAgICAgIHJldHVybiB0aGlzLmF1ZGlvRmVlZGJhY2s7XHJcbiAgICBlbHNlIFxyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBAcmV0dXJuIFRoZSBhdWRpbyBjb250ZXh0XHJcbiAgICovXHJcbiAgZ2V0QXVkaW9Db250ZXh0KClcclxuICB7XHJcbiAgICByZXR1cm4gdGhpcy5hdWRpb0NvbnRleHQ7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQHJldHVybnMgTm9kZSBjb250YWluaW5nIHRoZSBzb3VyY2Ugc3RyZWFtIGlmIHNldCB1cCwgZmFsc2UgaW5zdGVhZFxyXG4gICAqL1xyXG4gIGdldFNvdXJjZU5vZGUoKVxyXG4gIHtcclxuICAgIGlmKCBjb25maWcuc2hvd2Vycm9ycyAmJiAhdGhpcy5zb3VyY2UgKSBjb25zb2xlLmVycm9yKCBgQXVkaW8gc291cmNlIGhhcyBub3QgYmV0IHNldCB1cGAgKTtcclxuICAgIHJldHVybiB0aGlzLnNvdXJjZTtcclxuICB9XHJcbn07XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9hdWRpb3N0cmVhbS9hdWRpby1zb3VyY2UuanMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7Ozs7Ozs7QUFDQTs7Ozs7O0FBTUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFJQTtBQUNBO0FBSUE7QUFDQTtBQUVBOzs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///3\n')},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\n/**\r\n * @struct\r\n */\nvar AudioData =\n/**\r\n * @param {Uint8Array} timedomainData \r\n * @param {Uint8Array} frequencyData\r\n * @param {number} bufferSize\r\n */\nexports.AudioData = function AudioData(timedomainData, frequencyData, bufferSize) {\n  _classCallCheck(this, AudioData);\n\n  this.bufferSize = bufferSize;\n  this.timedomainData = timedomainData;\n  this.frequencyData = frequencyData;\n};\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvYXVkaW9zdHJlYW0vYXVkaW8tZGF0YS5qcz8yYjEyIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAc3RydWN0XHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQXVkaW9EYXRhXHJcbntcclxuICAvKipcclxuICAgKiBAcGFyYW0ge1VpbnQ4QXJyYXl9IHRpbWVkb21haW5EYXRhIFxyXG4gICAqIEBwYXJhbSB7VWludDhBcnJheX0gZnJlcXVlbmN5RGF0YVxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBidWZmZXJTaXplXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIHRpbWVkb21haW5EYXRhLCBmcmVxdWVuY3lEYXRhLCBidWZmZXJTaXplIClcclxuICB7XHJcbiAgICB0aGlzLmJ1ZmZlclNpemUgPSBidWZmZXJTaXplO1xyXG4gICAgdGhpcy50aW1lZG9tYWluRGF0YSA9IHRpbWVkb21haW5EYXRhO1xyXG4gICAgdGhpcy5mcmVxdWVuY3lEYXRhID0gZnJlcXVlbmN5RGF0YTtcclxuICB9XHJcbn07XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9hdWRpb3N0cmVhbS9hdWRpby1kYXRhLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOzs7QUFHQTtBQUVBOzs7OztBQUZBO0FBUUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///4\n')},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nvar EASINGS = exports.EASINGS = {\n  linear: function linear(t) {\n    return t;\n  },\n  cubicIn: function cubicIn(t) {\n    return t * t * t;\n  },\n  cubicOut: function cubicOut(t) {\n    return --t * t * t + 1;\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvdXRpbGl0eS9lYXNpbmdzLmpzPzYzODUiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IEVBU0lOR1MgPSBcclxue1xyXG4gIGxpbmVhcjogKHQpID0+IHQsXHJcbiAgY3ViaWNJbjogKHQpID0+IHQqdCp0LFxyXG4gIGN1YmljT3V0OiAodCkgPT4gKC0tdCkqdCp0KzFcclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL3V0aWxpdHkvZWFzaW5ncy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUhBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///5\n')},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Peak = exports.AudioAnalysedDataForVisualization = exports.AudioAnalysedData = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _analyser = __webpack_require__(1);\n\nvar _analyser2 = _interopRequireDefault(_analyser);\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * Stores the analysed data into a structured object\r\n * Handles the history of required datas\r\n */\nvar AudioAnalysedData = exports.AudioAnalysedData = function () {\n  /**\r\n   * frequenciesData\r\n   * timedomainData\r\n   * \r\n   * energy\r\n   * energyHistory\r\n   * energyHistoryDeltaTime\r\n   * energyAverage\r\n   * \r\n   * globalPeak\r\n   * globalPeakValuesHistory\r\n   * \r\n   * multibandEnergy\r\n   * multibandEnergyHistory\r\n   * multibandEnergyHistoryDeltaTime\r\n   * multibandEnergyAverage\r\n   * \r\n   * multibandPeakHistory\r\n   * multibandPeakValuesHistory\r\n   * \r\n   */\n\n  /**\r\n   * @param {number} bufferSize Size of the data buffer\r\n   */\n  function AudioAnalysedData(bufferSize) {\n    _classCallCheck(this, AudioAnalysedData);\n\n    this.bufferSize = bufferSize;\n\n    this.frequenciesData = new Uint8Array(bufferSize);\n    this.timedomainData = new Uint8Array(bufferSize);\n\n    this.energy = 0;\n    this.energyHistory = [];\n    this.energyHistoryDeltaTime = [];\n    this.energyAverage = 0;\n\n    this.peak = new Peak(0.0, null, 0);\n    this.peakHistory = new Array();\n\n    this.multibandEnergy = new Array(_analyser2.default.options.multibandPeakDetection.options.bands);\n    this.multibandEnergyHistory = [];\n    this.multibandEnergyHistoryDeltaTime = [];\n    this.multibandEnergyAverage = new Array(_analyser2.default.options.multibandPeakDetection.options.bands);\n\n    this.multibandPeak = new Array(_analyser2.default.options.multibandPeakDetection.options.bands);\n    this.multibandPeakHistory = new Array(_analyser2.default.options.multibandPeakDetection.options.bands);\n    for (var i = 0; i < _analyser2.default.options.multibandPeakDetection.options.bands; i++) {\n      this.multibandPeak[i] = new Peak(0.0, null, 0);\n      this.multibandPeakHistory[i] = new Array();\n    }\n  }\n\n  /**\r\n   * Set the timedomain data to the new values\r\n   * @param {Uint8Array} newTimedomainData New timedomain informations\r\n   */\n\n\n  _createClass(AudioAnalysedData, [{\n    key: 'setTimedomainData',\n    value: function setTimedomainData(newTimedomainData) {\n      this.timedomainData = newTimedomainData;\n    }\n\n    /**\r\n     * Get the timedomain data values\r\n     * @return {Uint8Array} Timedomain data values\r\n     */\n\n  }, {\n    key: 'getTimedomainData',\n    value: function getTimedomainData() {\n      return this.timedomainData;\n    }\n\n    /**\r\n     * Set the frequenciesData to the new values\r\n     * @param {Uint8Array} newFrequenciesData New frequencies informations\r\n     */\n\n  }, {\n    key: 'setFrequenciesData',\n    value: function setFrequenciesData(newFrequenciesData) {\n      this.frequenciesData = newFrequenciesData;\n    }\n\n    /**\r\n     * Get the frequencies data values\r\n     * @return {Uint8Array} Frequencies data values\r\n     */\n\n  }, {\n    key: 'getFrequenciesData',\n    value: function getFrequenciesData() {\n      return this.frequenciesData;\n    }\n\n    /**\r\n     * set energy\r\n     * @param {number} newEnergy New energy\r\n     */\n\n  }, {\n    key: 'setEnergy',\n    value: function setEnergy(newEnergy) {\n      this.energy = newEnergy;\n    }\n\n    /**\r\n     * Get the energy of the signal\r\n     * The harder the signal is, the more energy it will have\r\n     * @return {number} Current energy of the signal\r\n     */\n\n  }, {\n    key: 'getEnergy',\n    value: function getEnergy() {\n      return this.energy;\n    }\n\n    /**\r\n     * @param {number} newEnergyAverage New energy Average\r\n     */\n\n  }, {\n    key: 'setEnergyAverage',\n    value: function setEnergyAverage(newEnergyAverage) {\n      this.energyAverage = newEnergyAverage;\n    }\n\n    /**\r\n     * @return {number} Current local energy average of the signal\r\n     */\n\n  }, {\n    key: 'getEnergyAverage',\n    value: function getEnergyAverage() {\n      return this.energyAverage;\n    }\n\n    /**\r\n     * @param {Array} newEnergies The energies to set\r\n     */\n\n  }, {\n    key: 'setMultibandEnergy',\n    value: function setMultibandEnergy(newEnergies) {\n      this.multibandEnergy = newEnergies;\n    }\n\n    /**\r\n     * @returns an array of all the bands energy\r\n     */\n\n  }, {\n    key: 'getMultibandEnergy',\n    value: function getMultibandEnergy() {\n      return this.multibandEnergy;\n    }\n\n    /**\r\n     * @param {Array} newEnergiesAverage the new energies average to set\r\n     */\n\n  }, {\n    key: 'setMultibandEnergyAverage',\n    value: function setMultibandEnergyAverage(newEnergiesAverage) {\n      this.multibandEnergyAverage = newEnergiesAverage;\n    }\n\n    /**\r\n     * @returns an array of all the bands average energy\r\n     */\n\n  }, {\n    key: 'getMultibandEnergyAverage',\n    value: function getMultibandEnergyAverage() {\n      return this.multibandEnergyAverage;\n    }\n\n    /**\r\n     * Push the new energy to the history\r\n     * and saves it\r\n     * @param {number} energy New energy to push\r\n     * @param deltaTime Time since the last registered energy\r\n     */\n\n  }, {\n    key: 'pushNewEnergy',\n    value: function pushNewEnergy(energy, deltaTime) {\n      this.setEnergy(energy);\n      this.energyHistory.push(energy);\n      this.energyHistoryDeltaTime.push(deltaTime);\n\n      var deltaTimeSum = 0;\n      for (var i = this.energyHistoryDeltaTime.length - 1; i >= 0; i--) {\n        deltaTimeSum += this.energyHistoryDeltaTime[i];\n        if (deltaTimeSum >= _analyser2.default.options.peakDetection.options.energyPersistence) {\n          this.energyHistoryDeltaTime.splice(0, i - 1);\n          this.energyHistory.splice(0, i - 1);\n          break;\n        }\n      }\n    }\n\n    /**\r\n     * @return {Array} The history of the energies\r\n     */\n\n  }, {\n    key: 'getEnergyHistory',\n    value: function getEnergyHistory() {\n      return this.energyHistory;\n    }\n\n    /**\r\n     * @return {Array} the history of each band energies\r\n     */\n\n  }, {\n    key: 'getMultibandEnergyHistory',\n    value: function getMultibandEnergyHistory() {\n      return this.multibandEnergyHistory;\n    }\n\n    /**\r\n     * Push a new Array of energies to the history\r\n     * @param {Array} multibandEnergy An array of each band energy\r\n     * @param {*} deltaTime Time since the last mesure\r\n     */\n\n  }, {\n    key: 'pushNewMultibandEnergy',\n    value: function pushNewMultibandEnergy(multibandEnergy, deltaTime) {\n      this.setMultibandEnergy(multibandEnergy);\n      this.multibandEnergyHistory.push(multibandEnergy);\n      this.multibandEnergyHistoryDeltaTime.push(deltaTime);\n\n      var deltaTimeSum = 0;\n      for (var i = this.multibandEnergyHistory.length - 1; i >= 0; i--) {\n        deltaTimeSum += this.multibandEnergyHistoryDeltaTime[i];\n        if (deltaTimeSum >= _analyser2.default.options.multibandPeakDetection.options.energyPersistence) {\n          this.multibandEnergyHistory.splice(0, i - 1);\n          this.multibandEnergyHistoryDeltaTime.splice(0, i - 1);\n          break;\n        }\n      }\n    }\n  }]);\n\n  return AudioAnalysedData;\n}();\n\n;\n\n/**\r\n * This class is used to select only the desired options\r\n * for the visualization\r\n */\n\nvar AudioAnalysedDataForVisualization =\n/**\r\n * \r\n * @param {AudioAnalysedData} analysedData \r\n */\nexports.AudioAnalysedDataForVisualization = function AudioAnalysedDataForVisualization(analysedData) {\n  _classCallCheck(this, AudioAnalysedDataForVisualization);\n\n  this.bufferSize = analysedData.bufferSize;\n\n  if (_analyser2.default.options.returns.frequenciesData) this.frequenciesData = analysedData.frequenciesData;\n  if (_analyser2.default.options.returns.timedomainData) this.timedomainData = analysedData.timedomainData;\n  if (_analyser2.default.options.returns.energy) this.energy = analysedData.energy;\n  if (_analyser2.default.options.returns.energyHistory) {\n    this.energyHistory = analysedData.energyHistory;\n    this.energyHistoryDeltaTime = analysedData.energyHistoryDeltaTime;\n  }\n  if (_analyser2.default.options.returns.energyAverage) this.energyAverage = analysedData.energyAverage;\n  if (_analyser2.default.options.returns.peak) this.peak = analysedData.peak;\n  if (_analyser2.default.options.returns.peakHistory) this.peakHistory = analysedData.peakHistory;\n\n  if (_analyser2.default.options.returns.multibandEnergy) this.multibandEnergy = analysedData.multibandEnergy;\n  if (_analyser2.default.options.returns.multibandEnergyHistory) {\n    this.multibandEnergyHistory = analysedData.multibandEnergyHistory;\n    this.multibandEnergyHistoryDeltaTime = analysedData.multibandEnergyHistoryDeltaTime;\n  }\n  if (_analyser2.default.options.returns.multibandEnergyAverage) this.multibandEnergyAverage = analysedData.multibandEnergyAverage;\n  if (_analyser2.default.options.returns.multibandPeak) this.multibandPeak = analysedData.multibandPeak;\n  if (_analyser2.default.options.returns.multibandPeakHistory) this.multibandPeakHistory = analysedData.multibandPeakHistory;\n};\n\n;\n\n/**\r\n * Peak data informations\r\n */\n\nvar Peak = exports.Peak = function () {\n  /**\r\n   * \r\n   * @param {number} value [0.0; 1.0] Current value of the peak - decrease over time depending on the \r\n   * interpolation function specified\r\n   * @param {*} timer Absolute timer on which the peak has been detected. \r\n   * @param {number} energy Strength of the peak\r\n   */\n  function Peak(value, timer, energy) {\n    _classCallCheck(this, Peak);\n\n    this.value = value;\n    this.timer = timer;\n    this.energy = energy;\n  }\n\n  _createClass(Peak, [{\n    key: 'copy',\n    value: function copy(peak) {\n      this.value = peak.value;\n      this.timer = peak.timer;\n      this.energy = peak.energy;\n    }\n  }]);\n\n  return Peak;\n}();\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvYXVkaW9hbmFseXNpcy9hdWRpby1hbmFseXNlZC1kYXRhLmpzPzM3YjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFuYWx5c2VyQ29uZmlnIGZyb20gJy4uL2NvbmZpZy9hbmFseXNlci5jb25maWcnO1xyXG5pbXBvcnQgQXBwQ29uZmlnIGZyb20gJy4uL2NvbmZpZy9hcHAuY29uZmlnJztcclxuXHJcblxyXG4vKipcclxuICogU3RvcmVzIHRoZSBhbmFseXNlZCBkYXRhIGludG8gYSBzdHJ1Y3R1cmVkIG9iamVjdFxyXG4gKiBIYW5kbGVzIHRoZSBoaXN0b3J5IG9mIHJlcXVpcmVkIGRhdGFzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQXVkaW9BbmFseXNlZERhdGFcclxue1xyXG4gIC8qKlxyXG4gICAqIGZyZXF1ZW5jaWVzRGF0YVxyXG4gICAqIHRpbWVkb21haW5EYXRhXHJcbiAgICogXHJcbiAgICogZW5lcmd5XHJcbiAgICogZW5lcmd5SGlzdG9yeVxyXG4gICAqIGVuZXJneUhpc3RvcnlEZWx0YVRpbWVcclxuICAgKiBlbmVyZ3lBdmVyYWdlXHJcbiAgICogXHJcbiAgICogZ2xvYmFsUGVha1xyXG4gICAqIGdsb2JhbFBlYWtWYWx1ZXNIaXN0b3J5XHJcbiAgICogXHJcbiAgICogbXVsdGliYW5kRW5lcmd5XHJcbiAgICogbXVsdGliYW5kRW5lcmd5SGlzdG9yeVxyXG4gICAqIG11bHRpYmFuZEVuZXJneUhpc3RvcnlEZWx0YVRpbWVcclxuICAgKiBtdWx0aWJhbmRFbmVyZ3lBdmVyYWdlXHJcbiAgICogXHJcbiAgICogbXVsdGliYW5kUGVha0hpc3RvcnlcclxuICAgKiBtdWx0aWJhbmRQZWFrVmFsdWVzSGlzdG9yeVxyXG4gICAqIFxyXG4gICAqL1xyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0ge251bWJlcn0gYnVmZmVyU2l6ZSBTaXplIG9mIHRoZSBkYXRhIGJ1ZmZlclxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBidWZmZXJTaXplIClcclxuICB7XHJcbiAgICB0aGlzLmJ1ZmZlclNpemUgPSBidWZmZXJTaXplO1xyXG5cclxuICAgIHRoaXMuZnJlcXVlbmNpZXNEYXRhID0gbmV3IFVpbnQ4QXJyYXkoIGJ1ZmZlclNpemUgKTsgIFxyXG4gICAgdGhpcy50aW1lZG9tYWluRGF0YSA9IG5ldyBVaW50OEFycmF5KCBidWZmZXJTaXplICk7XHJcblxyXG4gICAgdGhpcy5lbmVyZ3kgPSAwO1xyXG4gICAgdGhpcy5lbmVyZ3lIaXN0b3J5ID0gW107XHJcbiAgICB0aGlzLmVuZXJneUhpc3RvcnlEZWx0YVRpbWUgPSBbXTtcclxuICAgIHRoaXMuZW5lcmd5QXZlcmFnZSA9IDA7XHJcblxyXG4gICAgdGhpcy5wZWFrID0gbmV3IFBlYWsoIDAuMCwgbnVsbCwgMCApO1xyXG4gICAgdGhpcy5wZWFrSGlzdG9yeSA9IG5ldyBBcnJheSgpO1xyXG5cclxuICAgIHRoaXMubXVsdGliYW5kRW5lcmd5ID0gbmV3IEFycmF5KCBBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5iYW5kcyApO1xyXG4gICAgdGhpcy5tdWx0aWJhbmRFbmVyZ3lIaXN0b3J5ID0gW107XHJcbiAgICB0aGlzLm11bHRpYmFuZEVuZXJneUhpc3RvcnlEZWx0YVRpbWUgPSBbXTtcclxuICAgIHRoaXMubXVsdGliYW5kRW5lcmd5QXZlcmFnZSA9IG5ldyBBcnJheSggQW5hbHlzZXJDb25maWcub3B0aW9ucy5tdWx0aWJhbmRQZWFrRGV0ZWN0aW9uLm9wdGlvbnMuYmFuZHMgKTtcclxuXHJcbiAgICB0aGlzLm11bHRpYmFuZFBlYWsgPSBuZXcgQXJyYXkoIEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMubXVsdGliYW5kUGVha0RldGVjdGlvbi5vcHRpb25zLmJhbmRzICk7XHJcbiAgICB0aGlzLm11bHRpYmFuZFBlYWtIaXN0b3J5ID0gbmV3IEFycmF5KCBBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5iYW5kcyApO1xyXG4gICAgZm9yKCBsZXQgaSA9IDA7IGkgPCBBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5iYW5kczsgaSsrIClcclxuICAgIHtcclxuICAgICAgdGhpcy5tdWx0aWJhbmRQZWFrW2ldID0gbmV3IFBlYWsoIDAuMCwgbnVsbCwgMCApO1xyXG4gICAgICB0aGlzLm11bHRpYmFuZFBlYWtIaXN0b3J5W2ldID0gbmV3IEFycmF5KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHRoZSB0aW1lZG9tYWluIGRhdGEgdG8gdGhlIG5ldyB2YWx1ZXNcclxuICAgKiBAcGFyYW0ge1VpbnQ4QXJyYXl9IG5ld1RpbWVkb21haW5EYXRhIE5ldyB0aW1lZG9tYWluIGluZm9ybWF0aW9uc1xyXG4gICAqL1xyXG4gIHNldFRpbWVkb21haW5EYXRhKCBuZXdUaW1lZG9tYWluRGF0YSApXHJcbiAge1xyXG4gICAgdGhpcy50aW1lZG9tYWluRGF0YSA9IG5ld1RpbWVkb21haW5EYXRhO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgdGltZWRvbWFpbiBkYXRhIHZhbHVlc1xyXG4gICAqIEByZXR1cm4ge1VpbnQ4QXJyYXl9IFRpbWVkb21haW4gZGF0YSB2YWx1ZXNcclxuICAgKi9cclxuICBnZXRUaW1lZG9tYWluRGF0YSgpXHJcbiAge1xyXG4gICAgcmV0dXJuIHRoaXMudGltZWRvbWFpbkRhdGE7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHRoZSBmcmVxdWVuY2llc0RhdGEgdG8gdGhlIG5ldyB2YWx1ZXNcclxuICAgKiBAcGFyYW0ge1VpbnQ4QXJyYXl9IG5ld0ZyZXF1ZW5jaWVzRGF0YSBOZXcgZnJlcXVlbmNpZXMgaW5mb3JtYXRpb25zXHJcbiAgICovXHJcbiAgc2V0RnJlcXVlbmNpZXNEYXRhKCBuZXdGcmVxdWVuY2llc0RhdGEgKVxyXG4gIHtcclxuICAgIHRoaXMuZnJlcXVlbmNpZXNEYXRhID0gbmV3RnJlcXVlbmNpZXNEYXRhO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgZnJlcXVlbmNpZXMgZGF0YSB2YWx1ZXNcclxuICAgKiBAcmV0dXJuIHtVaW50OEFycmF5fSBGcmVxdWVuY2llcyBkYXRhIHZhbHVlc1xyXG4gICAqL1xyXG4gIGdldEZyZXF1ZW5jaWVzRGF0YSgpXHJcbiAge1xyXG4gICAgcmV0dXJuIHRoaXMuZnJlcXVlbmNpZXNEYXRhO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIHNldCBlbmVyZ3lcclxuICAgKiBAcGFyYW0ge251bWJlcn0gbmV3RW5lcmd5IE5ldyBlbmVyZ3lcclxuICAgKi9cclxuICBzZXRFbmVyZ3koIG5ld0VuZXJneSApXHJcbiAge1xyXG4gICAgdGhpcy5lbmVyZ3kgPSBuZXdFbmVyZ3k7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBlbmVyZ3kgb2YgdGhlIHNpZ25hbFxyXG4gICAqIFRoZSBoYXJkZXIgdGhlIHNpZ25hbCBpcywgdGhlIG1vcmUgZW5lcmd5IGl0IHdpbGwgaGF2ZVxyXG4gICAqIEByZXR1cm4ge251bWJlcn0gQ3VycmVudCBlbmVyZ3kgb2YgdGhlIHNpZ25hbFxyXG4gICAqL1xyXG4gIGdldEVuZXJneSgpXHJcbiAge1xyXG4gICAgcmV0dXJuIHRoaXMuZW5lcmd5O1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBuZXdFbmVyZ3lBdmVyYWdlIE5ldyBlbmVyZ3kgQXZlcmFnZVxyXG4gICAqL1xyXG4gIHNldEVuZXJneUF2ZXJhZ2UoIG5ld0VuZXJneUF2ZXJhZ2UgKVxyXG4gIHtcclxuICAgIHRoaXMuZW5lcmd5QXZlcmFnZSA9IG5ld0VuZXJneUF2ZXJhZ2U7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQHJldHVybiB7bnVtYmVyfSBDdXJyZW50IGxvY2FsIGVuZXJneSBhdmVyYWdlIG9mIHRoZSBzaWduYWxcclxuICAgKi9cclxuICBnZXRFbmVyZ3lBdmVyYWdlKClcclxuICB7XHJcbiAgICByZXR1cm4gdGhpcy5lbmVyZ3lBdmVyYWdlO1xyXG4gIH1cclxuXHJcbiAgXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtBcnJheX0gbmV3RW5lcmdpZXMgVGhlIGVuZXJnaWVzIHRvIHNldFxyXG4gICAqL1xyXG4gIHNldE11bHRpYmFuZEVuZXJneSggbmV3RW5lcmdpZXMgKVxyXG4gIHtcclxuICAgIHRoaXMubXVsdGliYW5kRW5lcmd5ID0gbmV3RW5lcmdpZXM7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQHJldHVybnMgYW4gYXJyYXkgb2YgYWxsIHRoZSBiYW5kcyBlbmVyZ3lcclxuICAgKi9cclxuICBnZXRNdWx0aWJhbmRFbmVyZ3koKVxyXG4gIHtcclxuICAgIHJldHVybiB0aGlzLm11bHRpYmFuZEVuZXJneTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7QXJyYXl9IG5ld0VuZXJnaWVzQXZlcmFnZSB0aGUgbmV3IGVuZXJnaWVzIGF2ZXJhZ2UgdG8gc2V0XHJcbiAgICovXHJcbiAgc2V0TXVsdGliYW5kRW5lcmd5QXZlcmFnZSggbmV3RW5lcmdpZXNBdmVyYWdlIClcclxuICB7XHJcbiAgICB0aGlzLm11bHRpYmFuZEVuZXJneUF2ZXJhZ2UgPSBuZXdFbmVyZ2llc0F2ZXJhZ2U7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQHJldHVybnMgYW4gYXJyYXkgb2YgYWxsIHRoZSBiYW5kcyBhdmVyYWdlIGVuZXJneVxyXG4gICAqL1xyXG4gIGdldE11bHRpYmFuZEVuZXJneUF2ZXJhZ2UoKVxyXG4gIHtcclxuICAgIHJldHVybiB0aGlzLm11bHRpYmFuZEVuZXJneUF2ZXJhZ2U7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogUHVzaCB0aGUgbmV3IGVuZXJneSB0byB0aGUgaGlzdG9yeVxyXG4gICAqIGFuZCBzYXZlcyBpdFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBlbmVyZ3kgTmV3IGVuZXJneSB0byBwdXNoXHJcbiAgICogQHBhcmFtIGRlbHRhVGltZSBUaW1lIHNpbmNlIHRoZSBsYXN0IHJlZ2lzdGVyZWQgZW5lcmd5XHJcbiAgICovXHJcbiAgcHVzaE5ld0VuZXJneSggZW5lcmd5LCBkZWx0YVRpbWUgKVxyXG4gIHsgICAgXHJcbiAgICB0aGlzLnNldEVuZXJneSggZW5lcmd5ICk7XHJcbiAgICB0aGlzLmVuZXJneUhpc3RvcnkucHVzaCggZW5lcmd5ICk7XHJcbiAgICB0aGlzLmVuZXJneUhpc3RvcnlEZWx0YVRpbWUucHVzaCggZGVsdGFUaW1lICk7XHJcblxyXG4gICAgbGV0IGRlbHRhVGltZVN1bSA9IDA7XHJcbiAgICBmb3IoIGxldCBpID0gdGhpcy5lbmVyZ3lIaXN0b3J5RGVsdGFUaW1lLmxlbmd0aC0xOyBpID49IDA7IGktLSApXHJcbiAgICB7XHJcbiAgICAgIGRlbHRhVGltZVN1bSs9IHRoaXMuZW5lcmd5SGlzdG9yeURlbHRhVGltZVtpXTtcclxuICAgICAgaWYoIGRlbHRhVGltZVN1bSA+PSBBbmFseXNlckNvbmZpZy5vcHRpb25zLnBlYWtEZXRlY3Rpb24ub3B0aW9ucy5lbmVyZ3lQZXJzaXN0ZW5jZSApXHJcbiAgICAgIHtcclxuICAgICAgICB0aGlzLmVuZXJneUhpc3RvcnlEZWx0YVRpbWUuc3BsaWNlKCAwLCBpLTEgKTtcclxuICAgICAgICB0aGlzLmVuZXJneUhpc3Rvcnkuc3BsaWNlKCAwLCBpLTEgKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm4ge0FycmF5fSBUaGUgaGlzdG9yeSBvZiB0aGUgZW5lcmdpZXNcclxuICAgKi9cclxuICBnZXRFbmVyZ3lIaXN0b3J5KClcclxuICB7XHJcbiAgICByZXR1cm4gdGhpcy5lbmVyZ3lIaXN0b3J5O1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm4ge0FycmF5fSB0aGUgaGlzdG9yeSBvZiBlYWNoIGJhbmQgZW5lcmdpZXNcclxuICAgKi9cclxuICBnZXRNdWx0aWJhbmRFbmVyZ3lIaXN0b3J5KClcclxuICB7XHJcbiAgICByZXR1cm4gdGhpcy5tdWx0aWJhbmRFbmVyZ3lIaXN0b3J5O1xyXG4gIH1cclxuXHJcbiAgXHJcbiAgLyoqXHJcbiAgICogUHVzaCBhIG5ldyBBcnJheSBvZiBlbmVyZ2llcyB0byB0aGUgaGlzdG9yeVxyXG4gICAqIEBwYXJhbSB7QXJyYXl9IG11bHRpYmFuZEVuZXJneSBBbiBhcnJheSBvZiBlYWNoIGJhbmQgZW5lcmd5XHJcbiAgICogQHBhcmFtIHsqfSBkZWx0YVRpbWUgVGltZSBzaW5jZSB0aGUgbGFzdCBtZXN1cmVcclxuICAgKi9cclxuICBwdXNoTmV3TXVsdGliYW5kRW5lcmd5KCBtdWx0aWJhbmRFbmVyZ3ksIGRlbHRhVGltZSApXHJcbiAge1xyXG4gICAgdGhpcy5zZXRNdWx0aWJhbmRFbmVyZ3koIG11bHRpYmFuZEVuZXJneSApO1xyXG4gICAgdGhpcy5tdWx0aWJhbmRFbmVyZ3lIaXN0b3J5LnB1c2goIG11bHRpYmFuZEVuZXJneSApO1xyXG4gICAgdGhpcy5tdWx0aWJhbmRFbmVyZ3lIaXN0b3J5RGVsdGFUaW1lLnB1c2goIGRlbHRhVGltZSApO1xyXG5cclxuICAgIGxldCBkZWx0YVRpbWVTdW0gPSAwO1xyXG4gICAgZm9yKCBsZXQgaSA9IHRoaXMubXVsdGliYW5kRW5lcmd5SGlzdG9yeS5sZW5ndGgtMTsgaSA+PSAwOyBpLS0gKVxyXG4gICAge1xyXG4gICAgICBkZWx0YVRpbWVTdW0rPSB0aGlzLm11bHRpYmFuZEVuZXJneUhpc3RvcnlEZWx0YVRpbWVbaV07XHJcbiAgICAgIGlmKCBkZWx0YVRpbWVTdW0gPj0gQW5hbHlzZXJDb25maWcub3B0aW9ucy5tdWx0aWJhbmRQZWFrRGV0ZWN0aW9uLm9wdGlvbnMuZW5lcmd5UGVyc2lzdGVuY2UgKVxyXG4gICAgICB7XHJcbiAgICAgICAgdGhpcy5tdWx0aWJhbmRFbmVyZ3lIaXN0b3J5LnNwbGljZSggMCwgaS0xICk7XHJcbiAgICAgICAgdGhpcy5tdWx0aWJhbmRFbmVyZ3lIaXN0b3J5RGVsdGFUaW1lLnNwbGljZSggMCwgaS0xICk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG5cclxuXHJcbi8qKlxyXG4gKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gc2VsZWN0IG9ubHkgdGhlIGRlc2lyZWQgb3B0aW9uc1xyXG4gKiBmb3IgdGhlIHZpc3VhbGl6YXRpb25cclxuICovXHJcbmV4cG9ydCBjbGFzcyBBdWRpb0FuYWx5c2VkRGF0YUZvclZpc3VhbGl6YXRpb25cclxue1xyXG4gIC8qKlxyXG4gICAqIFxyXG4gICAqIEBwYXJhbSB7QXVkaW9BbmFseXNlZERhdGF9IGFuYWx5c2VkRGF0YSBcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggYW5hbHlzZWREYXRhIClcclxuICB7XHJcbiAgICB0aGlzLmJ1ZmZlclNpemUgPSBhbmFseXNlZERhdGEuYnVmZmVyU2l6ZTtcclxuXHJcbiAgICBpZiggQW5hbHlzZXJDb25maWcub3B0aW9ucy5yZXR1cm5zLmZyZXF1ZW5jaWVzRGF0YSApXHJcbiAgICAgIHRoaXMuZnJlcXVlbmNpZXNEYXRhID0gYW5hbHlzZWREYXRhLmZyZXF1ZW5jaWVzRGF0YTtcclxuICAgIGlmKCBBbmFseXNlckNvbmZpZy5vcHRpb25zLnJldHVybnMudGltZWRvbWFpbkRhdGEgKVxyXG4gICAgICB0aGlzLnRpbWVkb21haW5EYXRhID0gYW5hbHlzZWREYXRhLnRpbWVkb21haW5EYXRhO1xyXG4gICAgaWYoIEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMucmV0dXJucy5lbmVyZ3kgKVxyXG4gICAgICB0aGlzLmVuZXJneSA9IGFuYWx5c2VkRGF0YS5lbmVyZ3k7XHJcbiAgICBpZiggQW5hbHlzZXJDb25maWcub3B0aW9ucy5yZXR1cm5zLmVuZXJneUhpc3RvcnkgKVxyXG4gICAge1xyXG4gICAgICB0aGlzLmVuZXJneUhpc3RvcnkgPSBhbmFseXNlZERhdGEuZW5lcmd5SGlzdG9yeTtcclxuICAgICAgdGhpcy5lbmVyZ3lIaXN0b3J5RGVsdGFUaW1lID0gYW5hbHlzZWREYXRhLmVuZXJneUhpc3RvcnlEZWx0YVRpbWU7XHJcbiAgICB9XHJcbiAgICBpZiggQW5hbHlzZXJDb25maWcub3B0aW9ucy5yZXR1cm5zLmVuZXJneUF2ZXJhZ2UgKVxyXG4gICAgICB0aGlzLmVuZXJneUF2ZXJhZ2UgPSBhbmFseXNlZERhdGEuZW5lcmd5QXZlcmFnZTtcclxuICAgIGlmKCBBbmFseXNlckNvbmZpZy5vcHRpb25zLnJldHVybnMucGVhayApXHJcbiAgICAgIHRoaXMucGVhayA9IGFuYWx5c2VkRGF0YS5wZWFrO1xyXG4gICAgaWYoIEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMucmV0dXJucy5wZWFrSGlzdG9yeSApXHJcbiAgICAgIHRoaXMucGVha0hpc3RvcnkgPSBhbmFseXNlZERhdGEucGVha0hpc3Rvcnk7XHJcblxyXG4gICAgaWYoIEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMucmV0dXJucy5tdWx0aWJhbmRFbmVyZ3kgKVxyXG4gICAgICB0aGlzLm11bHRpYmFuZEVuZXJneSA9IGFuYWx5c2VkRGF0YS5tdWx0aWJhbmRFbmVyZ3k7XHJcbiAgICBpZiggQW5hbHlzZXJDb25maWcub3B0aW9ucy5yZXR1cm5zLm11bHRpYmFuZEVuZXJneUhpc3RvcnkgKVxyXG4gICAge1xyXG4gICAgICB0aGlzLm11bHRpYmFuZEVuZXJneUhpc3RvcnkgPSBhbmFseXNlZERhdGEubXVsdGliYW5kRW5lcmd5SGlzdG9yeTtcclxuICAgICAgdGhpcy5tdWx0aWJhbmRFbmVyZ3lIaXN0b3J5RGVsdGFUaW1lID0gYW5hbHlzZWREYXRhLm11bHRpYmFuZEVuZXJneUhpc3RvcnlEZWx0YVRpbWU7XHJcbiAgICB9XHJcbiAgICBpZiggQW5hbHlzZXJDb25maWcub3B0aW9ucy5yZXR1cm5zLm11bHRpYmFuZEVuZXJneUF2ZXJhZ2UgKVxyXG4gICAgICB0aGlzLm11bHRpYmFuZEVuZXJneUF2ZXJhZ2UgPSBhbmFseXNlZERhdGEubXVsdGliYW5kRW5lcmd5QXZlcmFnZTtcclxuICAgIGlmKCBBbmFseXNlckNvbmZpZy5vcHRpb25zLnJldHVybnMubXVsdGliYW5kUGVhayApXHJcbiAgICAgIHRoaXMubXVsdGliYW5kUGVhayA9IGFuYWx5c2VkRGF0YS5tdWx0aWJhbmRQZWFrO1xyXG4gICAgaWYoIEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMucmV0dXJucy5tdWx0aWJhbmRQZWFrSGlzdG9yeSApXHJcbiAgICAgIHRoaXMubXVsdGliYW5kUGVha0hpc3RvcnkgPSBhbmFseXNlZERhdGEubXVsdGliYW5kUGVha0hpc3Rvcnk7XHJcbiAgfVxyXG59O1xyXG5cclxuXHJcbi8qKlxyXG4gKiBQZWFrIGRhdGEgaW5mb3JtYXRpb25zXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUGVhayBcclxue1xyXG4gIC8qKlxyXG4gICAqIFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSBbMC4wOyAxLjBdIEN1cnJlbnQgdmFsdWUgb2YgdGhlIHBlYWsgLSBkZWNyZWFzZSBvdmVyIHRpbWUgZGVwZW5kaW5nIG9uIHRoZSBcclxuICAgKiBpbnRlcnBvbGF0aW9uIGZ1bmN0aW9uIHNwZWNpZmllZFxyXG4gICAqIEBwYXJhbSB7Kn0gdGltZXIgQWJzb2x1dGUgdGltZXIgb24gd2hpY2ggdGhlIHBlYWsgaGFzIGJlZW4gZGV0ZWN0ZWQuIFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBlbmVyZ3kgU3RyZW5ndGggb2YgdGhlIHBlYWtcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggdmFsdWUsIHRpbWVyLCBlbmVyZ3kgKVxyXG4gIHtcclxuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgIHRoaXMudGltZXIgPSB0aW1lcjtcclxuICAgIHRoaXMuZW5lcmd5ID0gZW5lcmd5O1xyXG4gIH1cclxuXHJcblxyXG4gIGNvcHkoIHBlYWsgKVxyXG4gIHtcclxuICAgIHRoaXMudmFsdWUgPSBwZWFrLnZhbHVlO1xyXG4gICAgdGhpcy50aW1lciA9IHBlYWsudGltZXI7XHJcbiAgICB0aGlzLmVuZXJneSA9IHBlYWsuZW5lcmd5O1xyXG4gIH1cclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2F1ZGlvYW5hbHlzaXMvYXVkaW8tYW5hbHlzZWQtZGF0YS5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQUVBOzs7O0FBSUE7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXNCQTs7O0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUlBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUdBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUdBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUdBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFDQTtBQUNBO0FBR0E7Ozs7O0FBSUE7QUFFQTs7OztBQUZBO0FBT0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7Ozs7QUFHQTtBQUVBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///6\n")},function(module,exports,__webpack_require__){"use strict";eval("\n\nvar _userSelection = __webpack_require__(8);\n\nvar _audioSource = __webpack_require__(3);\n\nvar _audioStream = __webpack_require__(9);\n\nvar _audioAnalyser = __webpack_require__(10);\n\nvar _analysedDataVisualizer = __webpack_require__(11);\n\nvar _loader = __webpack_require__(2);\n\nvar _hudController = __webpack_require__(12);\n\nvar _stats = __webpack_require__(13);\n\nvar _gui = __webpack_require__(16);\n\nvar _userControls = __webpack_require__(18);\n\nvar _userControls2 = _interopRequireDefault(_userControls);\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nvar _soundcloudAudio = __webpack_require__(19);\n\nvar _soundcloudAudio2 = _interopRequireDefault(_soundcloudAudio);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n * How does it works \r\n * 1- Load audio from a source \r\n * 2- Init the audiostream component by providing an audio source \r\n *    The audiostream class provides methods to get data from the loaded source\r\n * 3- Init the AudioAnalyser \r\n *    This is different from the Audio API analyser node\r\n *    This component can process audio data provided by the audiostream to get\r\n *    informations on the audio, such as amplitude, peak, multi-band analysis\r\n * 4- (optional) Preview the audio data using DataVisualizer\r\n *    This draws informations provided by the AudioAnalyser under the <body> tag\r\n * 5- In the main loop, follow the example to see how data cycle is processed\r\n */\n\nvar scplayer = new _soundcloudAudio2.default('ifLq1FIbS6X3sUVhY2k706ZjmmpaOaYW');\nscplayer.resolve(\"https://soundcloud.com/bookboy-860860771/sets/techno-indus\", function (playlist) {\n\n  scplayer.play();\n\n  console.log(scplayer);\n});\n\n// Size of the fft transform performed on audio stream\nvar FFT_SIZE = 512;\n\n// first we want to stop the application until the user has selected an input\nvar userSelection = new _userSelection.UserSelection(function (selectionType, info) {\n\n  // we start to load everything\n  var loader = new _loader.Loader();\n\n  // 1- we create the audio components required for analysis\n  var audiosource = new _audioSource.AudioSource();\n  var audiostream = new _audioStream.AudioStream(audiosource, FFT_SIZE, _app2.default.volume);\n  var audioAnalyser = new _audioAnalyser.AudioAnalyser(audiostream.getBufferSize());\n\n  // We set up the volume control\n  _userControls2.default[0][1].callback = function (value) {\n    audiostream.setVolume(value);\n  };\n\n  // Visual informations on the analysed data\n  var visuHelper = new _analysedDataVisualizer.AnalysedDataVisualizer();\n  visuHelper.init();\n\n  var startTimer = null,\n      lastFrameTimer = null,\n      deltaTime = null;\n\n  var hud = new _hudController.HUD();\n  var stats = new _stats.Stats(_stats.Stats.POSITIONS.BOTTOM_RIGHT);\n  var gui = new _gui.GUI(_userControls2.default);\n  hud.add(stats);\n  hud.add(gui);\n\n  switch (selectionType) {\n    case _userSelection.UserSelection.LOAD_TYPE.LIBRARY_FILE:\n      audiosource.loadAudioFromLibrary(info).then(init);\n      break;\n\n    case _userSelection.UserSelection.LOAD_TYPE.INPUT_MICROPHONE:\n      audiosource.getStreamFromMicrophone().then(init);\n      break;\n\n    case _userSelection.UserSelection.LOAD_TYPE.INPUT_FILE:\n      audiosource.loadAudioFromFile(info).then(init);\n      break;\n  }\n\n  function init() {\n    audiostream.init();\n    if (selectionType != _userSelection.UserSelection.LOAD_TYPE.INPUT_MICROPHONE) audiosource.play();\n    startTimer = new Date();\n    lastFrameTimer = startTimer;\n    loader.loaded();\n    analysis();\n  }\n\n  function analysis() {\n    window.requestAnimationFrame(analysis);\n\n    stats.begin();\n    var currentTimer = new Date(),\n        deltaTime = currentTimer - lastFrameTimer;\n\n    // we send the audio data to the analyser for analysis\n    audioAnalyser.analyse(audiostream.getAudioData(), deltaTime, currentTimer);\n    var analysedData = audioAnalyser.getAnalysedData(); // we ge the analysed data\n\n    // we ask the helper to draw the analysed data\n    // this is where we can send the data to a proper visualizer\n    visuHelper.draw(analysedData, startTimer);\n\n    lastFrameTimer = currentTimer;\n    stats.end();\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvbWFpbi5qcz8xYzkwIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBIb3cgZG9lcyBpdCB3b3JrcyBcclxuICogMS0gTG9hZCBhdWRpbyBmcm9tIGEgc291cmNlIFxyXG4gKiAyLSBJbml0IHRoZSBhdWRpb3N0cmVhbSBjb21wb25lbnQgYnkgcHJvdmlkaW5nIGFuIGF1ZGlvIHNvdXJjZSBcclxuICogICAgVGhlIGF1ZGlvc3RyZWFtIGNsYXNzIHByb3ZpZGVzIG1ldGhvZHMgdG8gZ2V0IGRhdGEgZnJvbSB0aGUgbG9hZGVkIHNvdXJjZVxyXG4gKiAzLSBJbml0IHRoZSBBdWRpb0FuYWx5c2VyIFxyXG4gKiAgICBUaGlzIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBBdWRpbyBBUEkgYW5hbHlzZXIgbm9kZVxyXG4gKiAgICBUaGlzIGNvbXBvbmVudCBjYW4gcHJvY2VzcyBhdWRpbyBkYXRhIHByb3ZpZGVkIGJ5IHRoZSBhdWRpb3N0cmVhbSB0byBnZXRcclxuICogICAgaW5mb3JtYXRpb25zIG9uIHRoZSBhdWRpbywgc3VjaCBhcyBhbXBsaXR1ZGUsIHBlYWssIG11bHRpLWJhbmQgYW5hbHlzaXNcclxuICogNC0gKG9wdGlvbmFsKSBQcmV2aWV3IHRoZSBhdWRpbyBkYXRhIHVzaW5nIERhdGFWaXN1YWxpemVyXHJcbiAqICAgIFRoaXMgZHJhd3MgaW5mb3JtYXRpb25zIHByb3ZpZGVkIGJ5IHRoZSBBdWRpb0FuYWx5c2VyIHVuZGVyIHRoZSA8Ym9keT4gdGFnXHJcbiAqIDUtIEluIHRoZSBtYWluIGxvb3AsIGZvbGxvdyB0aGUgZXhhbXBsZSB0byBzZWUgaG93IGRhdGEgY3ljbGUgaXMgcHJvY2Vzc2VkXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgVXNlclNlbGVjdGlvbiB9IGZyb20gJy4vdXNlci1zZWxlY3Rpb24vdXNlci1zZWxlY3Rpb24nO1xyXG5pbXBvcnQgeyBBdWRpb1NvdXJjZSB9IGZyb20gJy4vYXVkaW9zdHJlYW0vYXVkaW8tc291cmNlJztcclxuaW1wb3J0IHsgQXVkaW9TdHJlYW0gfSBmcm9tICcuL2F1ZGlvc3RyZWFtL2F1ZGlvLXN0cmVhbSc7XHJcbmltcG9ydCB7IEF1ZGlvQW5hbHlzZXIgfSBmcm9tICcuL2F1ZGlvYW5hbHlzaXMvYXVkaW8tYW5hbHlzZXInO1xyXG5pbXBvcnQgeyBBbmFseXNlZERhdGFWaXN1YWxpemVyIH0gZnJvbSAnLi9hdWRpb2FuYWx5c2lzL3V0aWxpdHkvYW5hbHlzZWQtZGF0YS12aXN1YWxpemVyJztcclxuaW1wb3J0IHsgTG9hZGVyIH0gZnJvbSAnLi9sb2FkZXIvbG9hZGVyJztcclxuaW1wb3J0IHsgSFVEIH0gZnJvbSAnLi9odWQvaHVkLWNvbnRyb2xsZXInO1xyXG5pbXBvcnQgeyBTdGF0cyB9IGZyb20gJy4vdG9vbHMvc3RhdHMnO1xyXG5pbXBvcnQgeyBHVUkgfSBmcm9tICcuL3Rvb2xzL2d1aSc7XHJcbmltcG9ydCBVc2VyQ29udHJvbHMgZnJvbSAnLi91c2VyLWNvbnRyb2xzJztcclxuaW1wb3J0IEFwcENvbmZpZyBmcm9tICcuL2NvbmZpZy9hcHAuY29uZmlnJztcclxuXHJcbmltcG9ydCBTb3VuZENsb3VkIGZyb20gJ3NvdW5kY2xvdWQtYXVkaW8nO1xyXG5cclxuXHJcbmNvbnN0IHNjcGxheWVyID0gbmV3IFNvdW5kQ2xvdWQoJ2lmTHExRkliUzZYM3NVVmhZMms3MDZaam1tcGFPYVlXJyk7XHJcbnNjcGxheWVyLnJlc29sdmUoIFwiaHR0cHM6Ly9zb3VuZGNsb3VkLmNvbS9ib29rYm95LTg2MDg2MDc3MS9zZXRzL3RlY2huby1pbmR1c1wiLCAocGxheWxpc3QpID0+IHtcclxuXHJcbiAgc2NwbGF5ZXIucGxheSgpO1xyXG5cclxuICBjb25zb2xlLmxvZyggc2NwbGF5ZXIgKTtcclxuXHJcbn0pXHJcblxyXG5cclxuLy8gU2l6ZSBvZiB0aGUgZmZ0IHRyYW5zZm9ybSBwZXJmb3JtZWQgb24gYXVkaW8gc3RyZWFtXHJcbmNvbnN0IEZGVF9TSVpFID0gNTEyO1xyXG5cclxuLy8gZmlyc3Qgd2Ugd2FudCB0byBzdG9wIHRoZSBhcHBsaWNhdGlvbiB1bnRpbCB0aGUgdXNlciBoYXMgc2VsZWN0ZWQgYW4gaW5wdXRcclxubGV0IHVzZXJTZWxlY3Rpb24gPSBuZXcgVXNlclNlbGVjdGlvbiggKHNlbGVjdGlvblR5cGUsIGluZm8pID0+IHtcclxuXHJcbiAgLy8gd2Ugc3RhcnQgdG8gbG9hZCBldmVyeXRoaW5nXHJcbiAgbGV0IGxvYWRlciA9IG5ldyBMb2FkZXIoKTtcclxuXHJcbiAgLy8gMS0gd2UgY3JlYXRlIHRoZSBhdWRpbyBjb21wb25lbnRzIHJlcXVpcmVkIGZvciBhbmFseXNpc1xyXG4gIGxldCBhdWRpb3NvdXJjZSA9IG5ldyBBdWRpb1NvdXJjZSgpO1xyXG4gIGxldCBhdWRpb3N0cmVhbSA9IG5ldyBBdWRpb1N0cmVhbSggYXVkaW9zb3VyY2UsIEZGVF9TSVpFLCBBcHBDb25maWcudm9sdW1lICk7XHJcbiAgbGV0IGF1ZGlvQW5hbHlzZXIgPSBuZXcgQXVkaW9BbmFseXNlciggYXVkaW9zdHJlYW0uZ2V0QnVmZmVyU2l6ZSgpICk7XHJcblxyXG4gIC8vIFdlIHNldCB1cCB0aGUgdm9sdW1lIGNvbnRyb2xcclxuICBVc2VyQ29udHJvbHNbMF1bMV0uY2FsbGJhY2sgPSAodmFsdWUpID0+IHsgYXVkaW9zdHJlYW0uc2V0Vm9sdW1lKHZhbHVlKTsgfTtcclxuXHJcbiAgLy8gVmlzdWFsIGluZm9ybWF0aW9ucyBvbiB0aGUgYW5hbHlzZWQgZGF0YVxyXG4gIGxldCB2aXN1SGVscGVyID0gbmV3IEFuYWx5c2VkRGF0YVZpc3VhbGl6ZXIoKTtcclxuICB2aXN1SGVscGVyLmluaXQoKTtcclxuXHJcbiAgbGV0IHN0YXJ0VGltZXIgPSBudWxsLFxyXG4gICAgICBsYXN0RnJhbWVUaW1lciA9IG51bGwsXHJcbiAgICAgIGRlbHRhVGltZSA9IG51bGw7XHJcbiAgXHJcbiAgbGV0IGh1ZCA9IG5ldyBIVUQoKTtcclxuICBsZXQgc3RhdHMgPSBuZXcgU3RhdHMoIFN0YXRzLlBPU0lUSU9OUy5CT1RUT01fUklHSFQgKTtcclxuICBsZXQgZ3VpID0gbmV3IEdVSSggVXNlckNvbnRyb2xzICk7XHJcbiAgaHVkLmFkZChzdGF0cyk7XHJcbiAgaHVkLmFkZChndWkpO1xyXG5cclxuICBzd2l0Y2goIHNlbGVjdGlvblR5cGUgKVxyXG4gIHtcclxuICAgIGNhc2UgVXNlclNlbGVjdGlvbi5MT0FEX1RZUEUuTElCUkFSWV9GSUxFOlxyXG4gICAgICBhdWRpb3NvdXJjZS5sb2FkQXVkaW9Gcm9tTGlicmFyeSggaW5mbyApLnRoZW4oaW5pdCk7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIGNhc2UgVXNlclNlbGVjdGlvbi5MT0FEX1RZUEUuSU5QVVRfTUlDUk9QSE9ORTpcclxuICAgICAgYXVkaW9zb3VyY2UuZ2V0U3RyZWFtRnJvbU1pY3JvcGhvbmUoKS50aGVuKGluaXQpO1xyXG4gICAgICBicmVhaztcclxuICAgIFxyXG4gICAgY2FzZSBVc2VyU2VsZWN0aW9uLkxPQURfVFlQRS5JTlBVVF9GSUxFOlxyXG4gICAgICBhdWRpb3NvdXJjZS5sb2FkQXVkaW9Gcm9tRmlsZSggaW5mbyApLnRoZW4oaW5pdCk7XHJcbiAgICAgIGJyZWFrO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaW5pdCgpXHJcbiAge1xyXG4gICAgYXVkaW9zdHJlYW0uaW5pdCgpO1xyXG4gICAgaWYoIHNlbGVjdGlvblR5cGUgIT0gVXNlclNlbGVjdGlvbi5MT0FEX1RZUEUuSU5QVVRfTUlDUk9QSE9ORSApXHJcbiAgICAgIGF1ZGlvc291cmNlLnBsYXkoKTtcclxuICAgIHN0YXJ0VGltZXIgPSBuZXcgRGF0ZSgpO1xyXG4gICAgbGFzdEZyYW1lVGltZXIgPSBzdGFydFRpbWVyO1xyXG4gICAgbG9hZGVyLmxvYWRlZCgpO1xyXG4gICAgYW5hbHlzaXMoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFuYWx5c2lzKClcclxuICB7XHJcbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCBhbmFseXNpcyApO1xyXG5cclxuICAgIHN0YXRzLmJlZ2luKCk7XHJcbiAgICBsZXQgY3VycmVudFRpbWVyID0gbmV3IERhdGUoKSxcclxuICAgICAgICBkZWx0YVRpbWUgICAgPSBjdXJyZW50VGltZXIgLSBsYXN0RnJhbWVUaW1lcjtcclxuXHJcbiAgICAvLyB3ZSBzZW5kIHRoZSBhdWRpbyBkYXRhIHRvIHRoZSBhbmFseXNlciBmb3IgYW5hbHlzaXNcclxuICAgIGF1ZGlvQW5hbHlzZXIuYW5hbHlzZSggYXVkaW9zdHJlYW0uZ2V0QXVkaW9EYXRhKCksIGRlbHRhVGltZSwgY3VycmVudFRpbWVyIClcclxuICAgIGxldCBhbmFseXNlZERhdGEgPSBhdWRpb0FuYWx5c2VyLmdldEFuYWx5c2VkRGF0YSgpOyAvLyB3ZSBnZSB0aGUgYW5hbHlzZWQgZGF0YVxyXG4gICAgXHJcbiAgICAvLyB3ZSBhc2sgdGhlIGhlbHBlciB0byBkcmF3IHRoZSBhbmFseXNlZCBkYXRhXHJcbiAgICAvLyB0aGlzIGlzIHdoZXJlIHdlIGNhbiBzZW5kIHRoZSBkYXRhIHRvIGEgcHJvcGVyIHZpc3VhbGl6ZXJcclxuICAgIHZpc3VIZWxwZXIuZHJhdyggYW5hbHlzZWREYXRhLCBzdGFydFRpbWVyICk7XHJcblxyXG4gICAgbGFzdEZyYW1lVGltZXIgPSBjdXJyZW50VGltZXI7XHJcbiAgICBzdGF0cy5lbmQoKTtcclxuICB9XHJcblxyXG59KTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL21haW4uanMiXSwibWFwcGluZ3MiOiI7O0FBY0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7QUEzQkE7Ozs7Ozs7Ozs7Ozs7O0FBNkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUNBO0FBY0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///7\n")},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserSelection = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nvar _loader = __webpack_require__(2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * Creates a pre-selection screen, handles its dom elements\r\n * and display an user interface for the audio stream selection\r\n */\nvar UserSelection = exports.UserSelection = function () {\n  /**\r\n   * Callback param 1: type of \r\n   * @param {*} callback The method to be called once the user has selected an option\r\n   */\n  function UserSelection(callback) {\n    var _this = this;\n\n    _classCallCheck(this, UserSelection);\n\n    this.loader = new _loader.Loader(\"LOADING LIBRARY\");\n\n    this.callback = callback;\n    this.files = [];\n\n    this.microphoneImg = new Image();\n    this.microphoneImg.src = './dist/img/microphone.svg';\n\n    this.loadLibraryFile().then(function (library) {\n\n      library.forEach(function (soundfile) {\n        _this.files.push(new SoundFile(soundfile));\n      });\n      _this.loadCovers().then(function () {\n        _this.setupSelection();\n      });\n    });\n  }\n\n  /**\r\n   * Creates the dom elements and associate the events\r\n   * to them\r\n   */\n\n\n  _createClass(UserSelection, [{\n    key: 'setupSelection',\n    value: function setupSelection() {\n      var _this2 = this;\n\n      this.loader.loaded();\n\n      this.domElement = document.createElement(\"div\");\n      this.domElement.setAttribute('id', \"user-selection\");\n      this.domElement.innerHTML = '\\n    <div class=\"track-selection\">\\n      <div class=\"top-info\">Select the track you\\'d wish to visualize<br>or drop an audio file into the window</div>\\n      <div class=\"tracks\"></div>\\n    </div>';\n\n      if (_app2.default.hudToggleKey != false) this.domElement.innerHTML += '<div class=\"bottom-infos\">During the visualization, you can toggle the HUD by pressing ' + _app2.default.hudToggleKey.toUpperCase() + '</div>';\n\n      this.domElement.ondragenter = function (e) {\n        e.preventDefault();\n      };\n      this.domElement.ondragover = function (e) {\n        e.preventDefault();\n      };\n      this.domElement.ondrop = function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n        _this2.dropHandler(e);\n      };\n\n      this.files.forEach(function (file) {\n        var tracks = _this2.domElement.getElementsByClassName(\"tracks\")[0];\n        var track = document.createElement(\"div\");\n        track.setAttribute('class', 'track');\n        track.innerHTML = '\\n        <div class=\"image\" style=\"background-image: url(' + file.image + ');\"></div>\\n        <div class=\"track-infos\">\\n          <span class=\"artist\">' + file.artist + '</span> - <span class=\"track-name\">' + file.name + '</span>\\n        </div>';\n        tracks.appendChild(track);\n        track.addEventListener(\"click\", function () {\n          _this2.loadFile(file);\n        });\n      });\n\n      var micElem = document.createElement(\"div\");\n      micElem.setAttribute(\"class\", \"track microphone\");\n      micElem.innerHTML = '<div class=\"icon image\" style=\"background-image: url(./dist/img/microphone.svg);\"></div><div class=\"info-text\">Use microphone as input</div>';\n      micElem.addEventListener(\"click\", function () {\n        _this2.loadMicrophone();\n      });\n      this.domElement.getElementsByClassName(\"tracks\")[0].appendChild(micElem);\n\n      document.body.appendChild(this.domElement);\n    }\n\n    /** \r\n     * Hides the user selection and removes then elements from the DOM\r\n     * @returns {Promise} resolves when the elements are hidden\r\n     */\n\n  }, {\n    key: 'clearSelection',\n    value: function clearSelection() {\n      var _this3 = this;\n\n      this.domElement.className += \" hide\";\n\n      return new Promise(function (resolve) {\n        setTimeout(function () {\n          _this3.domElement.remove();\n          resolve();\n        }, 800);\n      });\n    }\n\n    /**\r\n     * Called when user selected a file from the library\r\n     * Calls the callback method with the audio file to read\r\n     */\n\n  }, {\n    key: 'loadFile',\n    value: function loadFile(file) {\n      var _this4 = this;\n\n      this.clearSelection().then(function () {\n        _this4.callback(UserSelection.LOAD_TYPE.LIBRARY_FILE, './dist/audio/' + file.directory + '/' + file.filename);\n      });\n    }\n\n    /**\r\n     * Called when user selected microphone\r\n     * Calls the callback method\r\n     */\n\n  }, {\n    key: 'loadMicrophone',\n    value: function loadMicrophone() {\n      var _this5 = this;\n\n      this.clearSelection().then(function () {\n        _this5.callback(UserSelection.LOAD_TYPE.INPUT_MICROPHONE);\n      });\n    }\n\n    /**\r\n     * Called when user dropped an audio file \r\n     * Calls the callback method sending the file data to be read\r\n     * @param {File} file The file buffer to be read\r\n     */\n\n  }, {\n    key: 'loadBuffer',\n    value: function loadBuffer(file) {\n      var _this6 = this;\n\n      this.clearSelection().then(function () {\n        _this6.callback(UserSelection.LOAD_TYPE.INPUT_FILE, file);\n      });\n    }\n\n    /**\r\n     * Handles the drop event trigger\r\n     * @param {DragEvent} event \r\n     */\n\n  }, {\n    key: 'dropHandler',\n    value: function dropHandler(event) {\n      var fLoaded = false,\n          file = null;\n\n      if (event.dataTransfer.items) {\n        var item = event.dataTransfer.items[0];\n        if (item.kind === 'file') {\n          file = item.getAsFile();\n          fLoaded = true;\n        }\n      } else {\n        file = event.dataTransfer.files[0];\n        fLoaded = true;\n      }\n\n      if (fLoaded && file.type.indexOf(\"audio\") != -1) {\n        this.loadBuffer(file);\n      } else if (_app2.default.showerrors) {\n        console.error('The file is not an audio type.');\n      }\n    }\n\n    /**\r\n     * Loads the library file \r\n     */\n\n  }, {\n    key: 'loadLibraryFile',\n    value: function loadLibraryFile() {\n      return new Promise(function (resolve, reject) {\n        var xhr = new XMLHttpRequest();\n        xhr.responseType = 'text';\n        xhr.open(\"GET\", \"./dist/audio/sound-library.json\", true);\n        xhr.onloadend = function () {\n          if (_app2.default.showloginfos) console.log('Library file loaded\\n------------');\n          resolve(JSON.parse(xhr.response));\n        };\n        xhr.onerror = function () {\n          if (_app2.default.showerrors) console.error('Couldn\\'t load the library file ./dist/audio/sound-library.json');\n          reject();\n        };\n        xhr.send();\n      });\n    }\n\n    /**\r\n     * Loads the images from the library\r\n     * @returns {Promise} a promise which resolves once all the images are loaded\r\n     */\n\n  }, {\n    key: 'loadCovers',\n    value: function loadCovers() {\n      var _this7 = this;\n\n      var loaded = 0;\n      return new Promise(function (resolve, reject) {\n        _this7.files.forEach(function (file) {\n          var image = new Image();\n          image.onload = function () {\n            loaded++;\n            file.image = './dist/audio/' + file.directory + '/' + file.cover;\n            if (loaded == _this7.files.length) resolve();\n          };\n          image.onerror = function () {\n            loaded++;\n            file.image = '';\n            if (_app2.default.showerrors) console.error('Couldn\\'t load the cover /' + file.directory + '/' + file.cover);\n            if (loaded == _this7.files.length) resolve();\n          };\n          image.src = './dist/audio/' + file.directory + '/' + file.cover;\n        });\n      });\n    }\n  }], [{\n    key: 'LOAD_TYPE',\n    get: function get() {\n      return {\n        LIBRARY_FILE: 0, INPUT_FILE: 1, INPUT_MICROPHONE: 2\n      };\n    }\n  }]);\n\n  return UserSelection;\n}();\n\n;\n\n/**\r\n * Very simple SoundFile structure, used to handle the\r\n * files from the library\r\n */\n\nvar SoundFile = function SoundFile(options) {\n  _classCallCheck(this, SoundFile);\n\n  this.name = \"\";\n  this.directory = \"\";\n  this.filename = \"\";\n  this.cover = \"cover.jpg\";\n  this.image = null;\n\n  Object.assign(this, options);\n};\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvdXNlci1zZWxlY3Rpb24vdXNlci1zZWxlY3Rpb24uanM/ODhhZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBwQ29uZmlnIGZyb20gJy4uL2NvbmZpZy9hcHAuY29uZmlnJztcclxuaW1wb3J0IHsgTG9hZGVyIH0gZnJvbSAnLi4vbG9hZGVyL2xvYWRlcic7XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhIHByZS1zZWxlY3Rpb24gc2NyZWVuLCBoYW5kbGVzIGl0cyBkb20gZWxlbWVudHNcclxuICogYW5kIGRpc3BsYXkgYW4gdXNlciBpbnRlcmZhY2UgZm9yIHRoZSBhdWRpbyBzdHJlYW0gc2VsZWN0aW9uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVXNlclNlbGVjdGlvblxyXG57XHJcbiAgLyoqXHJcbiAgICogQ2FsbGJhY2sgcGFyYW0gMTogdHlwZSBvZiBcclxuICAgKiBAcGFyYW0geyp9IGNhbGxiYWNrIFRoZSBtZXRob2QgdG8gYmUgY2FsbGVkIG9uY2UgdGhlIHVzZXIgaGFzIHNlbGVjdGVkIGFuIG9wdGlvblxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBjYWxsYmFjayApXHJcbiAge1xyXG4gICAgdGhpcy5sb2FkZXIgPSBuZXcgTG9hZGVyKFwiTE9BRElORyBMSUJSQVJZXCIpO1xyXG5cclxuICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgIHRoaXMuZmlsZXMgPSBbXTtcclxuXHJcbiAgICB0aGlzLm1pY3JvcGhvbmVJbWcgPSBuZXcgSW1hZ2UoKTtcclxuICAgIHRoaXMubWljcm9waG9uZUltZy5zcmMgPSAnLi9kaXN0L2ltZy9taWNyb3Bob25lLnN2Zyc7XHJcblxyXG4gICAgdGhpcy5sb2FkTGlicmFyeUZpbGUoKS50aGVuKCAobGlicmFyeSkgPT4ge1xyXG4gICAgICBcclxuICAgICAgbGlicmFyeS5mb3JFYWNoKCAoc291bmRmaWxlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5maWxlcy5wdXNoKCBuZXcgU291bmRGaWxlKHNvdW5kZmlsZSkgKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHRoaXMubG9hZENvdmVycygpLnRoZW4oKCk9PnsgdGhpcy5zZXR1cFNlbGVjdGlvbigpOyB9KTtcclxuXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgdGhlIGRvbSBlbGVtZW50cyBhbmQgYXNzb2NpYXRlIHRoZSBldmVudHNcclxuICAgKiB0byB0aGVtXHJcbiAgICovXHJcbiAgc2V0dXBTZWxlY3Rpb24oKVxyXG4gIHtcclxuICAgIHRoaXMubG9hZGVyLmxvYWRlZCgpO1xyXG5cclxuICAgIHRoaXMuZG9tRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICB0aGlzLmRvbUVsZW1lbnQuc2V0QXR0cmlidXRlKCdpZCcsIFwidXNlci1zZWxlY3Rpb25cIik7XHJcbiAgICB0aGlzLmRvbUVsZW1lbnQuaW5uZXJIVE1MID0gYFxyXG4gICAgPGRpdiBjbGFzcz1cInRyYWNrLXNlbGVjdGlvblwiPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwidG9wLWluZm9cIj5TZWxlY3QgdGhlIHRyYWNrIHlvdSdkIHdpc2ggdG8gdmlzdWFsaXplPGJyPm9yIGRyb3AgYW4gYXVkaW8gZmlsZSBpbnRvIHRoZSB3aW5kb3c8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzcz1cInRyYWNrc1wiPjwvZGl2PlxyXG4gICAgPC9kaXY+YDtcclxuXHJcbiAgICBpZiggQXBwQ29uZmlnLmh1ZFRvZ2dsZUtleSAhPSBmYWxzZSApXHJcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5pbm5lckhUTUwrPSBgPGRpdiBjbGFzcz1cImJvdHRvbS1pbmZvc1wiPkR1cmluZyB0aGUgdmlzdWFsaXphdGlvbiwgeW91IGNhbiB0b2dnbGUgdGhlIEhVRCBieSBwcmVzc2luZyAke0FwcENvbmZpZy5odWRUb2dnbGVLZXkudG9VcHBlckNhc2UoKX08L2Rpdj5gO1xyXG5cclxuICAgIHRoaXMuZG9tRWxlbWVudC5vbmRyYWdlbnRlciA9IChlKSA9PiB7IGUucHJldmVudERlZmF1bHQoKTsgfTtcclxuICAgIHRoaXMuZG9tRWxlbWVudC5vbmRyYWdvdmVyID0gKGUpID0+IHsgZS5wcmV2ZW50RGVmYXVsdCgpOyB9O1xyXG4gICAgdGhpcy5kb21FbGVtZW50Lm9uZHJvcCA9IChlKSA9PiB7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5kcm9wSGFuZGxlcihlKTsgXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB0aGlzLmZpbGVzLmZvckVhY2goIChmaWxlKSA9PiB7XHJcbiAgICAgIGxldCB0cmFja3MgPSB0aGlzLmRvbUVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInRyYWNrc1wiKVswXTtcclxuICAgICAgbGV0IHRyYWNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgdHJhY2suc2V0QXR0cmlidXRlKCdjbGFzcycsICd0cmFjaycpO1xyXG4gICAgICB0cmFjay5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImltYWdlXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJHtmaWxlLmltYWdlfSk7XCI+PC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cInRyYWNrLWluZm9zXCI+XHJcbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImFydGlzdFwiPiR7ZmlsZS5hcnRpc3R9PC9zcGFuPiAtIDxzcGFuIGNsYXNzPVwidHJhY2stbmFtZVwiPiR7ZmlsZS5uYW1lfTwvc3Bhbj5cclxuICAgICAgICA8L2Rpdj5gO1xyXG4gICAgICB0cmFja3MuYXBwZW5kQ2hpbGQodHJhY2spO1xyXG4gICAgICB0cmFjay5hZGRFdmVudExpc3RlbmVyKCBcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLmxvYWRGaWxlKCBmaWxlICk7XHJcbiAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgbWljRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICBtaWNFbGVtLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwidHJhY2sgbWljcm9waG9uZVwiKTtcclxuICAgIG1pY0VsZW0uaW5uZXJIVE1MID0gYDxkaXYgY2xhc3M9XCJpY29uIGltYWdlXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWltYWdlOiB1cmwoLi9kaXN0L2ltZy9taWNyb3Bob25lLnN2Zyk7XCI+PC9kaXY+PGRpdiBjbGFzcz1cImluZm8tdGV4dFwiPlVzZSBtaWNyb3Bob25lIGFzIGlucHV0PC9kaXY+YDtcclxuICAgIG1pY0VsZW0uYWRkRXZlbnRMaXN0ZW5lciggXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMubG9hZE1pY3JvcGhvbmUoKTtcclxuICAgIH0pXHJcbiAgICB0aGlzLmRvbUVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInRyYWNrc1wiKVswXS5hcHBlbmRDaGlsZChtaWNFbGVtKTtcclxuXHJcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCB0aGlzLmRvbUVsZW1lbnQgKTtcclxuICB9XHJcblxyXG5cclxuICAvKiogXHJcbiAgICogSGlkZXMgdGhlIHVzZXIgc2VsZWN0aW9uIGFuZCByZW1vdmVzIHRoZW4gZWxlbWVudHMgZnJvbSB0aGUgRE9NXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9IHJlc29sdmVzIHdoZW4gdGhlIGVsZW1lbnRzIGFyZSBoaWRkZW5cclxuICAgKi9cclxuICBjbGVhclNlbGVjdGlvbigpXHJcbiAge1xyXG4gICAgdGhpcy5kb21FbGVtZW50LmNsYXNzTmFtZSs9IFwiIGhpZGVcIjtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoIChyZXNvbHZlKSA9PiB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCk9PntcclxuICAgICAgICB0aGlzLmRvbUVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICB9LCA4MDApO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBDYWxsZWQgd2hlbiB1c2VyIHNlbGVjdGVkIGEgZmlsZSBmcm9tIHRoZSBsaWJyYXJ5XHJcbiAgICogQ2FsbHMgdGhlIGNhbGxiYWNrIG1ldGhvZCB3aXRoIHRoZSBhdWRpbyBmaWxlIHRvIHJlYWRcclxuICAgKi9cclxuICBsb2FkRmlsZSggZmlsZSApXHJcbiAge1xyXG4gICAgdGhpcy5jbGVhclNlbGVjdGlvbigpLnRoZW4oICgpID0+IHtcclxuICAgICAgdGhpcy5jYWxsYmFjayggVXNlclNlbGVjdGlvbi5MT0FEX1RZUEUuTElCUkFSWV9GSUxFLCBgLi9kaXN0L2F1ZGlvLyR7ZmlsZS5kaXJlY3Rvcnl9LyR7ZmlsZS5maWxlbmFtZX1gICk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBDYWxsZWQgd2hlbiB1c2VyIHNlbGVjdGVkIG1pY3JvcGhvbmVcclxuICAgKiBDYWxscyB0aGUgY2FsbGJhY2sgbWV0aG9kXHJcbiAgICovXHJcbiAgbG9hZE1pY3JvcGhvbmUoKVxyXG4gIHtcclxuICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKS50aGVuKCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2FsbGJhY2soIFVzZXJTZWxlY3Rpb24uTE9BRF9UWVBFLklOUFVUX01JQ1JPUEhPTkUgKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGxlZCB3aGVuIHVzZXIgZHJvcHBlZCBhbiBhdWRpbyBmaWxlIFxyXG4gICAqIENhbGxzIHRoZSBjYWxsYmFjayBtZXRob2Qgc2VuZGluZyB0aGUgZmlsZSBkYXRhIHRvIGJlIHJlYWRcclxuICAgKiBAcGFyYW0ge0ZpbGV9IGZpbGUgVGhlIGZpbGUgYnVmZmVyIHRvIGJlIHJlYWRcclxuICAgKi9cclxuICBsb2FkQnVmZmVyKCBmaWxlIClcclxuICB7XHJcbiAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCkudGhlbiggKCkgPT4ge1xyXG4gICAgICB0aGlzLmNhbGxiYWNrKCBVc2VyU2VsZWN0aW9uLkxPQURfVFlQRS5JTlBVVF9GSUxFLCBmaWxlICk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGVzIHRoZSBkcm9wIGV2ZW50IHRyaWdnZXJcclxuICAgKiBAcGFyYW0ge0RyYWdFdmVudH0gZXZlbnQgXHJcbiAgICovXHJcbiAgZHJvcEhhbmRsZXIoIGV2ZW50IClcclxuICB7XHJcbiAgICBsZXQgZkxvYWRlZCA9IGZhbHNlLCBmaWxlID0gbnVsbDtcclxuXHJcbiAgICBpZiggZXZlbnQuZGF0YVRyYW5zZmVyLml0ZW1zIClcclxuICAgIHtcclxuICAgICAgbGV0IGl0ZW0gPSBldmVudC5kYXRhVHJhbnNmZXIuaXRlbXNbMF07XHJcbiAgICAgIGlmKCBpdGVtLmtpbmQgPT09ICdmaWxlJyApXHJcbiAgICAgIHtcclxuICAgICAgICBmaWxlID0gaXRlbS5nZXRBc0ZpbGUoKTtcclxuICAgICAgICBmTG9hZGVkID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBcclxuICAgIHtcclxuICAgICAgZmlsZSA9IGV2ZW50LmRhdGFUcmFuc2Zlci5maWxlc1swXTtcclxuICAgICAgZkxvYWRlZCA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgaWYoIGZMb2FkZWQgJiYgZmlsZS50eXBlLmluZGV4T2YoXCJhdWRpb1wiKSAhPSAtMSApXHJcbiAgICB7XHJcbiAgICAgIHRoaXMubG9hZEJ1ZmZlcihmaWxlKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYoIEFwcENvbmZpZy5zaG93ZXJyb3JzIClcclxuICAgIHtcclxuICAgICAgY29uc29sZS5lcnJvciggYFRoZSBmaWxlIGlzIG5vdCBhbiBhdWRpbyB0eXBlLmAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBMb2FkcyB0aGUgbGlicmFyeSBmaWxlIFxyXG4gICAqL1xyXG4gIGxvYWRMaWJyYXJ5RmlsZSgpXHJcbiAge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKCAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICd0ZXh0JztcclxuICAgICAgeGhyLm9wZW4oIFwiR0VUXCIsIFwiLi9kaXN0L2F1ZGlvL3NvdW5kLWxpYnJhcnkuanNvblwiLCB0cnVlICk7XHJcbiAgICAgIHhoci5vbmxvYWRlbmQgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYoIEFwcENvbmZpZy5zaG93bG9naW5mb3MgKSBjb25zb2xlLmxvZyggYExpYnJhcnkgZmlsZSBsb2FkZWRcXG4tLS0tLS0tLS0tLS1gICk7XHJcbiAgICAgICAgcmVzb2x2ZSggSlNPTi5wYXJzZSh4aHIucmVzcG9uc2UpICk7XHJcbiAgICAgIH1cclxuICAgICAgeGhyLm9uZXJyb3IgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYoIEFwcENvbmZpZy5zaG93ZXJyb3JzICkgY29uc29sZS5lcnJvciggYENvdWxkbid0IGxvYWQgdGhlIGxpYnJhcnkgZmlsZSAuL2Rpc3QvYXVkaW8vc291bmQtbGlicmFyeS5qc29uYCApO1xyXG4gICAgICAgIHJlamVjdCgpO1xyXG4gICAgICB9XHJcbiAgICAgIHhoci5zZW5kKCk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIExvYWRzIHRoZSBpbWFnZXMgZnJvbSB0aGUgbGlicmFyeVxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBhIHByb21pc2Ugd2hpY2ggcmVzb2x2ZXMgb25jZSBhbGwgdGhlIGltYWdlcyBhcmUgbG9hZGVkXHJcbiAgICovXHJcbiAgbG9hZENvdmVycygpXHJcbiAge1xyXG4gICAgbGV0IGxvYWRlZCA9IDA7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoIChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgdGhpcy5maWxlcy5mb3JFYWNoKCAoZmlsZSkgPT4ge1xyXG4gICAgICAgIGxldCBpbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgIGltYWdlLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICAgIGxvYWRlZCsrO1xyXG4gICAgICAgICAgZmlsZS5pbWFnZSA9IGAuL2Rpc3QvYXVkaW8vJHtmaWxlLmRpcmVjdG9yeX0vJHtmaWxlLmNvdmVyfWA7XHJcbiAgICAgICAgICBpZiggbG9hZGVkID09IHRoaXMuZmlsZXMubGVuZ3RoIClcclxuICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpbWFnZS5vbmVycm9yID0gKCkgPT4geyBcclxuICAgICAgICAgIGxvYWRlZCsrO1xyXG4gICAgICAgICAgZmlsZS5pbWFnZSA9ICcnO1xyXG4gICAgICAgICAgaWYoIEFwcENvbmZpZy5zaG93ZXJyb3JzICkgY29uc29sZS5lcnJvciggYENvdWxkbid0IGxvYWQgdGhlIGNvdmVyIC8ke2ZpbGUuZGlyZWN0b3J5fS8ke2ZpbGUuY292ZXJ9YCApO1xyXG4gICAgICAgICAgaWYoIGxvYWRlZCA9PSB0aGlzLmZpbGVzLmxlbmd0aCApXHJcbiAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGltYWdlLnNyYyA9IGAuL2Rpc3QvYXVkaW8vJHtmaWxlLmRpcmVjdG9yeX0vJHtmaWxlLmNvdmVyfWA7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0IExPQURfVFlQRSgpXHJcbiAge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgTElCUkFSWV9GSUxFOiAwLCBJTlBVVF9GSUxFOiAxLCBJTlBVVF9NSUNST1BIT05FOiAyXHJcbiAgICB9XHJcbiAgfVxyXG5cclxufTtcclxuXHJcblxyXG4vKipcclxuICogVmVyeSBzaW1wbGUgU291bmRGaWxlIHN0cnVjdHVyZSwgdXNlZCB0byBoYW5kbGUgdGhlXHJcbiAqIGZpbGVzIGZyb20gdGhlIGxpYnJhcnlcclxuICovXHJcbmNsYXNzIFNvdW5kRmlsZVxyXG57XHJcbiAgY29uc3RydWN0b3IoIG9wdGlvbnMgKVxyXG4gIHtcclxuICAgIHRoaXMubmFtZSA9IFwiXCI7XHJcbiAgICB0aGlzLmRpcmVjdG9yeSA9IFwiXCI7XHJcbiAgICB0aGlzLmZpbGVuYW1lID0gXCJcIjtcclxuICAgIHRoaXMuY292ZXIgPSBcImNvdmVyLmpwZ1wiO1xyXG4gICAgdGhpcy5pbWFnZSA9IG51bGw7XHJcblxyXG4gICAgT2JqZWN0LmFzc2lnbiggdGhpcywgb3B0aW9ucyApO1xyXG4gIH1cclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL3VzZXItc2VsZWN0aW9uL3VzZXItc2VsZWN0aW9uLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBOzs7O0FBSUE7QUFFQTs7OztBQUlBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBS0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUtBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7Ozs7O0FBRUE7QUFDQTtBQUVBOzs7OztBQUlBO0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///8\n")},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AudioStream = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nvar _audioSource = __webpack_require__(3);\n\nvar _audioData = __webpack_require__(4);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * Reads data from an audio source\r\n * The audio source provided to this class must be an \r\n * instance of AudioSource\r\n */\nvar AudioStream = exports.AudioStream = function () {\n  /**\r\n   * @param {AudioSource} audiosource Audio source from which the data is gathered\r\n   * @param {number} fftSize Size of the fourier transform. Must be pow of 2\r\n   * @param {number} volume [0.0; 1.0] Volume used by default \r\n   */\n  function AudioStream(audiosource, fftsize, volume) {\n    _classCallCheck(this, AudioStream);\n\n    this.audioSource = audiosource;\n    this.audioContext = audiosource.getAudioContext();\n    this.volume = volume;\n    this.fftsize = fftsize;\n    this.sourceNode = null;\n\n    this.gainNode = this.audioContext.createGain();\n    this.gainNode.gain.setValueAtTime(volume, this.audioContext.currentTime);\n\n    /*this.filterNode = this.audioContext.createBiquadFilter();\r\n    this.filterNode.type = \"lowpass\";\r\n    this.filterNode.frequency.setValueAtTime( 500, this.audioContext.currentTime );*/\n\n    this.analyserNode = this.audioContext.createAnalyser();\n    this.analyserNode.fftSize = fftsize;\n    //this.analyserNode.smoothingConstant = 0.9;\n    this.bufferLength = this.analyserNode.frequencyBinCount;\n    this.dataArray = new Uint8Array(this.bufferLength);\n  }\n\n  /**\r\n   * Function called once the audio source is set up\r\n   */\n\n\n  _createClass(AudioStream, [{\n    key: 'init',\n    value: function init() {\n      this.sourceNode = this.audioSource.getSourceNode();\n      if (!this.sourceNode) {\n        if (_app2.default.showerrors) console.error('Couldn\\'t init the audio stream class. The audio source is empty.');\n      } else {\n        this.sourceNode.connect(this.gainNode);\n        this.gainNode.connect(this.analyserNode);\n        //this.filterNode.connect( this.analyserNode );\n        if (this.audioSource.isThereFeedback()) this.analyserNode.connect(this.audioContext.destination);\n        if (_app2.default.showloginfos) console.log('AudioStream class initialized\\n------------');\n      }\n    }\n\n    /**\r\n     * @returns {AudioData} Audio data containing time domain data and frequency data\r\n     */\n\n  }, {\n    key: 'getAudioData',\n    value: function getAudioData() {\n      var tdData = new Uint8Array(this.bufferLength),\n          fData = new Uint8Array(this.bufferLength);\n      this.analyserNode.getByteTimeDomainData(tdData);\n      this.analyserNode.getByteFrequencyData(fData);\n\n      return new _audioData.AudioData(tdData, fData, this.bufferLength);\n    }\n\n    /**\r\n     * Changes the volume\r\n     * @param {number} volume [0.0; 1.0] New Volume\r\n     */\n\n  }, {\n    key: 'setVolume',\n    value: function setVolume(volume) {\n      this.volume = volume;\n      this.gainNode.gain.setValueAtTime(volume, this.audioContext.currentTime);\n    }\n\n    /**\r\n     * @returns The current volume\r\n     */\n\n  }, {\n    key: 'getVolume',\n    value: function getVolume() {\n      return this.volume;\n    }\n\n    /**\r\n     * @return Size of the data buffer\r\n     */\n\n  }, {\n    key: 'getBufferSize',\n    value: function getBufferSize() {\n      return this.bufferLength;\n    }\n  }]);\n\n  return AudioStream;\n}();\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvYXVkaW9zdHJlYW0vYXVkaW8tc3RyZWFtLmpzPzAzMjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNvbmZpZyBmcm9tICcuLi9jb25maWcvYXBwLmNvbmZpZyc7XHJcblxyXG5pbXBvcnQgeyBBdWRpb1NvdXJjZSB9IGZyb20gJy4vYXVkaW8tc291cmNlJztcclxuaW1wb3J0IHsgQXVkaW9EYXRhIH0gZnJvbSAnLi9hdWRpby1kYXRhJztcclxuXHJcblxyXG4vKipcclxuICogUmVhZHMgZGF0YSBmcm9tIGFuIGF1ZGlvIHNvdXJjZVxyXG4gKiBUaGUgYXVkaW8gc291cmNlIHByb3ZpZGVkIHRvIHRoaXMgY2xhc3MgbXVzdCBiZSBhbiBcclxuICogaW5zdGFuY2Ugb2YgQXVkaW9Tb3VyY2VcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBdWRpb1N0cmVhbVxyXG57XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtBdWRpb1NvdXJjZX0gYXVkaW9zb3VyY2UgQXVkaW8gc291cmNlIGZyb20gd2hpY2ggdGhlIGRhdGEgaXMgZ2F0aGVyZWRcclxuICAgKiBAcGFyYW0ge251bWJlcn0gZmZ0U2l6ZSBTaXplIG9mIHRoZSBmb3VyaWVyIHRyYW5zZm9ybS4gTXVzdCBiZSBwb3cgb2YgMlxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB2b2x1bWUgWzAuMDsgMS4wXSBWb2x1bWUgdXNlZCBieSBkZWZhdWx0IFxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKCBhdWRpb3NvdXJjZSwgZmZ0c2l6ZSwgdm9sdW1lIClcclxuICB7XHJcbiAgICB0aGlzLmF1ZGlvU291cmNlID0gYXVkaW9zb3VyY2U7XHJcbiAgICB0aGlzLmF1ZGlvQ29udGV4dCA9IGF1ZGlvc291cmNlLmdldEF1ZGlvQ29udGV4dCgpO1xyXG4gICAgdGhpcy52b2x1bWUgPSB2b2x1bWU7XHJcbiAgICB0aGlzLmZmdHNpemUgPSBmZnRzaXplO1xyXG4gICAgdGhpcy5zb3VyY2VOb2RlID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLmdhaW5Ob2RlID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlR2FpbigpO1xyXG4gICAgdGhpcy5nYWluTm9kZS5nYWluLnNldFZhbHVlQXRUaW1lKCB2b2x1bWUsIHRoaXMuYXVkaW9Db250ZXh0LmN1cnJlbnRUaW1lICk7XHJcblxyXG4gICAgLyp0aGlzLmZpbHRlck5vZGUgPSB0aGlzLmF1ZGlvQ29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTtcclxuICAgIHRoaXMuZmlsdGVyTm9kZS50eXBlID0gXCJsb3dwYXNzXCI7XHJcbiAgICB0aGlzLmZpbHRlck5vZGUuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKCA1MDAsIHRoaXMuYXVkaW9Db250ZXh0LmN1cnJlbnRUaW1lICk7Ki9cclxuXHJcbiAgICB0aGlzLmFuYWx5c2VyTm9kZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZUFuYWx5c2VyKCk7XHJcbiAgICB0aGlzLmFuYWx5c2VyTm9kZS5mZnRTaXplID0gZmZ0c2l6ZTtcclxuICAgIC8vdGhpcy5hbmFseXNlck5vZGUuc21vb3RoaW5nQ29uc3RhbnQgPSAwLjk7XHJcbiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IHRoaXMuYW5hbHlzZXJOb2RlLmZyZXF1ZW5jeUJpbkNvdW50O1xyXG4gICAgdGhpcy5kYXRhQXJyYXkgPSBuZXcgVWludDhBcnJheSggdGhpcy5idWZmZXJMZW5ndGggKTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBGdW5jdGlvbiBjYWxsZWQgb25jZSB0aGUgYXVkaW8gc291cmNlIGlzIHNldCB1cFxyXG4gICAqL1xyXG4gIGluaXQoKVxyXG4gIHtcclxuICAgIHRoaXMuc291cmNlTm9kZSA9IHRoaXMuYXVkaW9Tb3VyY2UuZ2V0U291cmNlTm9kZSgpO1xyXG4gICAgaWYoICF0aGlzLnNvdXJjZU5vZGUgKVxyXG4gICAge1xyXG4gICAgICBpZiggY29uZmlnLnNob3dlcnJvcnMgKSBjb25zb2xlLmVycm9yKCBgQ291bGRuJ3QgaW5pdCB0aGUgYXVkaW8gc3RyZWFtIGNsYXNzLiBUaGUgYXVkaW8gc291cmNlIGlzIGVtcHR5LmAgKTtcclxuICAgIH1cclxuICAgIGVsc2UgXHJcbiAgICB7XHJcbiAgICAgIHRoaXMuc291cmNlTm9kZS5jb25uZWN0KCB0aGlzLmdhaW5Ob2RlICk7XHJcbiAgICAgIHRoaXMuZ2Fpbk5vZGUuY29ubmVjdCggdGhpcy5hbmFseXNlck5vZGUgKTtcclxuICAgICAgLy90aGlzLmZpbHRlck5vZGUuY29ubmVjdCggdGhpcy5hbmFseXNlck5vZGUgKTtcclxuICAgICAgaWYoIHRoaXMuYXVkaW9Tb3VyY2UuaXNUaGVyZUZlZWRiYWNrKCkgKVxyXG4gICAgICAgIHRoaXMuYW5hbHlzZXJOb2RlLmNvbm5lY3QoIHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uICk7XHJcbiAgICAgIGlmKCBjb25maWcuc2hvd2xvZ2luZm9zICkgY29uc29sZS5sb2coIGBBdWRpb1N0cmVhbSBjbGFzcyBpbml0aWFsaXplZFxcbi0tLS0tLS0tLS0tLWAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBAcmV0dXJucyB7QXVkaW9EYXRhfSBBdWRpbyBkYXRhIGNvbnRhaW5pbmcgdGltZSBkb21haW4gZGF0YSBhbmQgZnJlcXVlbmN5IGRhdGFcclxuICAgKi9cclxuICBnZXRBdWRpb0RhdGEoKVxyXG4gIHtcclxuICAgIGxldCB0ZERhdGEgPSBuZXcgVWludDhBcnJheSggdGhpcy5idWZmZXJMZW5ndGggKSxcclxuICAgICAgICBmRGF0YSA9IG5ldyBVaW50OEFycmF5KCB0aGlzLmJ1ZmZlckxlbmd0aCApO1xyXG4gICAgdGhpcy5hbmFseXNlck5vZGUuZ2V0Qnl0ZVRpbWVEb21haW5EYXRhKCB0ZERhdGEgKTtcclxuICAgIHRoaXMuYW5hbHlzZXJOb2RlLmdldEJ5dGVGcmVxdWVuY3lEYXRhKCBmRGF0YSApO1xyXG4gICAgXHJcbiAgICByZXR1cm4gbmV3IEF1ZGlvRGF0YSggdGREYXRhLCBmRGF0YSwgdGhpcy5idWZmZXJMZW5ndGggKTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBDaGFuZ2VzIHRoZSB2b2x1bWVcclxuICAgKiBAcGFyYW0ge251bWJlcn0gdm9sdW1lIFswLjA7IDEuMF0gTmV3IFZvbHVtZVxyXG4gICAqL1xyXG4gIHNldFZvbHVtZSggdm9sdW1lIClcclxuICB7XHJcbiAgICB0aGlzLnZvbHVtZSA9IHZvbHVtZTtcclxuICAgIHRoaXMuZ2Fpbk5vZGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSggdm9sdW1lLCB0aGlzLmF1ZGlvQ29udGV4dC5jdXJyZW50VGltZSApO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm5zIFRoZSBjdXJyZW50IHZvbHVtZVxyXG4gICAqL1xyXG4gIGdldFZvbHVtZSgpXHJcbiAge1xyXG4gICAgcmV0dXJuIHRoaXMudm9sdW1lO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm4gU2l6ZSBvZiB0aGUgZGF0YSBidWZmZXJcclxuICAgKi9cclxuICBnZXRCdWZmZXJTaXplKClcclxuICB7XHJcbiAgICByZXR1cm4gdGhpcy5idWZmZXJMZW5ndGg7XHJcbiAgfVxyXG59O1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvYXVkaW9zdHJlYW0vYXVkaW8tc3RyZWFtLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBO0FBQUE7QUFDQTs7Ozs7QUFFQTs7Ozs7QUFLQTtBQUVBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUlBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFJQTtBQUNBO0FBQ0E7Ozs7OztBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///9\n")},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AudioAnalyser = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nvar _analyser = __webpack_require__(1);\n\nvar _analyser2 = _interopRequireDefault(_analyser);\n\nvar _audioData = __webpack_require__(4);\n\nvar _audioAnalysedData = __webpack_require__(6);\n\nvar _easings = __webpack_require__(5);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * Provides a flexible analysis to an audio stream\r\n * Some papers I used for the peak detection algorithms\r\n * [http://archive.gamedev.net/archive/reference/programming/features/beatdetection/]\r\n * [http://joesul.li/van/beat-detection-using-web-audio/]\r\n * This implementation differs from those shown in those papers, but they are\r\n * a good start to understand how peaks can be detected\r\n */\nvar AudioAnalyser = exports.AudioAnalyser = function () {\n  /**\r\n   * @param {number} bufferSize Size of the data buffer\r\n   */\n  function AudioAnalyser(bufferSize) {\n    _classCallCheck(this, AudioAnalyser);\n\n    this.bufferSize = bufferSize;\n    this.data = new _audioAnalysedData.AudioAnalysedData(bufferSize);\n    this.iterations = 0;\n\n    if (_app2.default.checkConfig) this.checkOptions(_analyser2.default);\n    if (_app2.default.showloginfos) console.log('Analyser initialized\\n------------');\n  }\n\n  /**\r\n   * Analyse the data provided by the AudioStream\r\n   * @param {AudioData} audioData Data provided by the AudioStream.getAudioData()\r\n   * @param deltaTime Elapsed time since last analysis\r\n   * @param currentTimer The timer of the current loop\r\n   */\n\n\n  _createClass(AudioAnalyser, [{\n    key: 'analyse',\n    value: function analyse(audioData, deltaTime, currentTimer) {\n      this.iterations++;\n\n      /**\r\n       * This method looks horrible but the logical tests are useful to save CPU usage\r\n       * if all the analysis are not required by the visualizer\r\n       */\n\n      this.data.setTimedomainData(audioData.timedomainData);\n      this.data.setFrequenciesData(audioData.frequencyData);\n\n      // Peak detection\n      var returns = _analyser2.default.options.returns;\n\n      if (returns.energy || returns.energyAverage || returns.energyHistory || returns.peak || returns.peakHistory) {\n        // we first compute the energy and push it to the energy history\n        this.data.pushNewEnergy(this.computeEnergy(this.data.getTimedomainData()), deltaTime);\n\n        if (returns.energyAverage || returns.peak || returns.peakHistory) {\n          this.data.setEnergyAverage(this.computeLocalEnergyAverage(this.data.getEnergyHistory()));\n\n          if (returns.peak || returns.peakHistory) {\n            this.computePeakDetection(this.data.getEnergy(), this.data.getEnergyAverage(), this.data.peak, this.data.peakHistory, currentTimer, _analyser2.default.options.peakDetection.options.threshold, _analyser2.default.options.peakDetection.options.peakPersistency, _analyser2.default.options.peakDetection.options.ignoreTime, _easings.EASINGS.linear);\n          }\n        }\n      }\n\n      if (returns.multibandEnergy || returns.multibandEnergyAverage || returns.multibandEnergyHistory || returns.multibandPeak || returns.multibandPeakHistory) {\n        this.data.pushNewMultibandEnergy(this.computeMultibandEnergy(audioData.frequencyData, _analyser2.default.options.multibandPeakDetection.options.bands), deltaTime);\n\n        if (returns.multibandEnergyAverage || returns.multibandPeak || returns.multibandPeakHistory) {\n          this.data.setMultibandEnergyAverage(this.computeMultibandLocalEnergyAverage(this.data.getMultibandEnergyHistory()));\n\n          if (returns.multibandPeakHistory || returns.multibandPeak) {\n            this.computeMultibandPeakDetection(this.data.getMultibandEnergy(), this.data.getMultibandEnergyAverage(), this.data.multibandPeak, this.data.multibandPeakHistory, currentTimer, _analyser2.default.options.multibandPeakDetection.options.threshold, _analyser2.default.options.multibandPeakDetection.options.peakPersistency, _analyser2.default.options.multibandPeakDetection.options.ignoreTime, _easings.EASINGS.linear);\n          }\n        }\n      }\n    }\n\n    /**\r\n     * This function check if the config is set correctly. It only shows an error if needed.\r\n     * @param {AnalyserConfig} config Config to check\r\n     */\n\n  }, {\n    key: 'checkOptions',\n    value: function checkOptions(config) {\n      if (_app2.default.showloginfos) console.log('Checking if the analyser configuration is correct');\n\n      // we first check if some values are correct \n      if (config.options.multibandPeakDetection.enabled) {\n        if (!(config.options.multibandPeakDetection.options.bands && (config.options.multibandPeakDetection.options.bands & config.options.multibandPeakDetection.options.bands - 1) === 0)) if (_app2.default.showerrors) console.error('The number of bands for the multiband detection algorithm must be a pow of 2.');\n      }\n\n      if (config.options.returns.peakHistory != config.options.returns.multibandPeakHistory) {\n        if (_app2.default.showerrors) console.error('Due to the conception of the analyser, the ');\n      }\n\n      // we check if the return values can be returned\n      if (!config.options.multibandPeakDetection.enabled) {\n        if (config.options.returns.multibandPeak) if (_app2.default.showerrors) console.error('The multiband peak can\\'t be computed if the multiband peak detection algorithm is disabled.');\n        if (config.options.returns.multibandPeakHistory) if (_app2.default.showerrors) console.error('The multiband peak history can\\'t be computed if the multiband peak detection algorithm is disabled.');\n      }\n      if (!config.options.peakDetection.enabled) {\n        if (config.options.returns.peak) if (_app2.default.showerrors) console.error('The peak can\\'t be computed if the peak detection algorithm is disabled.');\n        if (config.options.returns.peakHistory) if (_app2.default.showerrors) console.error('The peak history can\\'t be computed if the peak detection algorithm is disabled.');\n      }\n\n      if (_app2.default.showloginfos) console.log('Config checked.\\n------------');\n    }\n\n    /**\r\n     * @return {AudioAnalysedData} Full analysed data\r\n     */\n\n  }, {\n    key: 'getAnalysedData',\n    value: function getAnalysedData() {\n      return this.data;\n    }\n\n    /**\r\n     * @return {AudioAnalysedDataForVisualization} Only the data specified in the analyser config\r\n     */\n\n  }, {\n    key: 'getAnalysedDataForVisualization',\n    value: function getAnalysedDataForVisualization() {\n      return new _audioAnalysedData.AudioAnalysedDataForVisualization(this.data);\n    }\n\n    /**\r\n     * Computes the energy of a signal\r\n     * @param {Uint8Array} timedomainData The timedomain data of the signal\r\n     * @return {number} The energy of the timedomain data\r\n     */\n\n  }, {\n    key: 'computeEnergy',\n    value: function computeEnergy(timedomainData) {\n      var energy = 0;\n      for (var i = 0; i < timedomainData.length; i++) {\n        energy += Math.abs(timedomainData[i] - 128);\n      }return energy / timedomainData.length;\n    }\n\n    /**\r\n     * Computes the local average of the energy history\r\n     * @param {Array} energyHistory \r\n     * @returns {number} the average energy of the history\r\n     */\n\n  }, {\n    key: 'computeLocalEnergyAverage',\n    value: function computeLocalEnergyAverage(energyHistory) {\n      return energyHistory.reduce(function (a, b) {\n        return a + b;\n      }, 0) / energyHistory.length;\n    }\n\n    /**\r\n     * Uses the [at]param peak to check if a peak has been detected recently and updates \r\n     * its values, if not it checks if a peak is detected\r\n     * @param {number} energy energy of the moment\r\n     * @param {number} energyAverage average of the last energies\r\n     * @param {Peak} peak Informations on the peak\r\n     * @param {Array} peakHistory History of the recorded peaks\r\n     * @param {*} currentTimer the absolute timer on the current loop \r\n     * @param {number} threshold the higher this value is, the harder the peak has to hit to be detected\r\n     * @param {number} peakPersistency the time it takes for the peak valeu to go from 1 to 0\r\n     * @param {number} ignoreTime time when a peak can't be detected after a detection\r\n     * @param {*} interpolationFunction [0;1] => [0;1]\r\n     */\n\n  }, {\n    key: 'computePeakDetection',\n    value: function computePeakDetection(energy, energyAverage, peak, peakHistory, currentTimer, threshold, peakPersistency, ignoreTime, interpolationFunction) {\n      // if a peak has already been detected\n      if (peak.timer != null) {\n        // if a peak has been detected recently, we can't detect a new peak during ignoreTime\n        // we only decrease the value of the peak\n        if (currentTimer - peak.timer <= ignoreTime) {\n          // we decrease the value of the peak if it's not 0\n          if (peak.value > 0.0) {\n            peak.value = this.peakInterpolation(currentTimer, peak.timer, peakPersistency, interpolationFunction);\n          }\n        } else {\n          // we try a peak detection\n          if (energy / energyAverage > threshold) // we have a peak\n            {\n              var detectedPeak = new _audioAnalysedData.Peak(1.0, currentTimer, energy);\n              if (_analyser2.default.options.returns.peakHistory) peakHistory.push(detectedPeak);\n              peak.copy(detectedPeak);\n            } else if (peak.value > 0.0) // if the detected peak is still not to 0 we decrease its value\n            {\n              peak.value = this.peakInterpolation(currentTimer, peak.timer, peakPersistency, interpolationFunction);\n            }\n        }\n      } else // we try a peak detection\n        {\n          if (energy / energyAverage > threshold) // we have a peak\n            {\n              var _detectedPeak = new _audioAnalysedData.Peak(1.0, currentTimer, energy);\n              if (_analyser2.default.options.returns.peakHistory) peakHistory.push(_detectedPeak);\n              peak.copy(_detectedPeak);\n            }\n        }\n    }\n\n    /**\r\n     * @param {Uint8Array} frequencyData the frequencies data\r\n     * @param {number} nbBands Number of bands\r\n     * @returns {Array} the array energy of each band\r\n     */\n\n  }, {\n    key: 'computeMultibandEnergy',\n    value: function computeMultibandEnergy(frequencyData, nbBands) {\n      var fSize = frequencyData.length,\n          bandsEnergy = new Array(nbBands);\n\n      // we parse each band\n      for (var band = 0; band < nbBands; band++) {\n        var firstIndex = this.bandInterpolation(band / nbBands) * fSize,\n            lastIndex = this.bandInterpolation((band + 1) / nbBands) * fSize,\n            bandEnergy = 0;\n\n        // for each band we parse the frequencies\n        for (var f = firstIndex; f < lastIndex; f++) {\n          bandEnergy += frequencyData[f];\n        }bandsEnergy[band] = bandEnergy / (lastIndex - firstIndex);\n      }\n\n      return bandsEnergy;\n    }\n\n    /**\r\n     * @param {Array} energiesHistory The history of each band energy\r\n     * @returns {Array} the array of each band energy average\r\n     */\n\n  }, {\n    key: 'computeMultibandLocalEnergyAverage',\n    value: function computeMultibandLocalEnergyAverage(energiesHistory) {\n      var energiesAverage = new Array(_analyser2.default.options.multibandPeakDetection.options.bands);\n\n      // we init the values\n      for (var i = 0; i < _analyser2.default.options.multibandPeakDetection.options.bands; i++) {\n        energiesAverage[i] = 0;\n      } // first we go through the history \n      for (var _i = 0; _i < energiesHistory.length; _i++) {\n        // then we go though each band\n        for (var b = 0; b < energiesHistory[_i].length; b++) {\n          energiesAverage[b] += energiesHistory[_i][b];\n        }\n      }\n\n      for (var _i2 = 0; _i2 < _analyser2.default.options.multibandPeakDetection.options.bands; _i2++) {\n        energiesAverage[_i2] /= energiesHistory.length;\n      }return energiesAverage;\n    }\n\n    /**\r\n     * Parse each band to see if there is a local peak on each one \r\n     * of them. Uses the computePeakDetection method in that purpose.\r\n     * @param {Array} multibandEnergy array of the computed energy of each band\r\n     * @param {Array} multibandEnergyAverage array of the computed average local energy of each band\r\n     * @param {Array} multibandPeak array of each band peak\r\n     * @param {Array} multibandPeakHistory array of each band peaks history\r\n     * @param {*} currentTimer absolute timer on the current frame\r\n     * @param {number} threshold the higher it is, the harder a peak has to hit to be detected\r\n     * @param {number} peakPersistency time it takes for a peak to go from 1 to 0\r\n     * @param {number} ignoreTime time during a peak can't be detected after a detection\r\n     * @param {*} interpolationFunction [0; 1] => [0; 1] decrease function of the peak\r\n     */\n\n  }, {\n    key: 'computeMultibandPeakDetection',\n    value: function computeMultibandPeakDetection(multibandEnergy, multibandEnergyAverage, multibandPeak, multibandPeakHistory, currentTimer, threshold, peakPersistency, ignoreTime, interpolationFunction) {\n      var bandsNb = multibandPeak.length;\n      for (var band = 0; band < bandsNb; band++) {\n        this.computePeakDetection(multibandEnergy[band], multibandEnergyAverage[band], multibandPeak[band], multibandPeakHistory[band], currentTimer, threshold, peakPersistency, ignoreTime, interpolationFunction);\n      }\n    }\n\n    /**\r\n     * This function must be growing and continue on [0; 1]\r\n     * in this case f(x) = x²\r\n     * @param {number} bandposition [0; 1] the band / total of bands\r\n     * @returns {number} [0; 1] the new position of the band\r\n     */\n\n  }, {\n    key: 'bandInterpolation',\n    value: function bandInterpolation(bandposition) {\n      return bandposition * bandposition;\n    }\n\n    /**\r\n     * @param {*} currentTimer The current timer on the frame\r\n     * @param {*} peakTimer The absolute timer of the peak\r\n     * @param {*} peakPersistency The time a peak takes to go down to 0\r\n     * @param {*} easingFunction Function interpolation\r\n     * @returns {number} the value of the peak\r\n     */\n\n  }, {\n    key: 'peakInterpolation',\n    value: function peakInterpolation(currentTimer, peakTimer, peakPersistency, easingFunction) {\n      return Math.max(0.0, easingFunction(1.0 - (currentTimer - peakTimer) / peakPersistency));\n    }\n  }]);\n\n  return AudioAnalyser;\n}();\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2F1ZGlvYW5hbHlzaXMvYXVkaW8tYW5hbHlzZXIuanM/ZDZkOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBwQ29uZmlnIGZyb20gJy4uL2NvbmZpZy9hcHAuY29uZmlnJztcclxuaW1wb3J0IEFuYWx5c2VyQ29uZmlnIGZyb20gJy4uL2NvbmZpZy9hbmFseXNlci5jb25maWcnO1xyXG5cclxuaW1wb3J0IHsgQXVkaW9EYXRhIH0gZnJvbSAnLi4vYXVkaW9zdHJlYW0vYXVkaW8tZGF0YSc7XHJcbmltcG9ydCB7IEF1ZGlvQW5hbHlzZWREYXRhLCBBdWRpb0FuYWx5c2VkRGF0YUZvclZpc3VhbGl6YXRpb24sIFBlYWsgfSBmcm9tICcuL2F1ZGlvLWFuYWx5c2VkLWRhdGEnO1xyXG5pbXBvcnQgeyBFQVNJTkdTIH0gZnJvbSAnLi4vdXRpbGl0eS9lYXNpbmdzJztcclxuXHJcblxyXG4vKipcclxuICogUHJvdmlkZXMgYSBmbGV4aWJsZSBhbmFseXNpcyB0byBhbiBhdWRpbyBzdHJlYW1cclxuICogU29tZSBwYXBlcnMgSSB1c2VkIGZvciB0aGUgcGVhayBkZXRlY3Rpb24gYWxnb3JpdGhtc1xyXG4gKiBbaHR0cDovL2FyY2hpdmUuZ2FtZWRldi5uZXQvYXJjaGl2ZS9yZWZlcmVuY2UvcHJvZ3JhbW1pbmcvZmVhdHVyZXMvYmVhdGRldGVjdGlvbi9dXHJcbiAqIFtodHRwOi8vam9lc3VsLmxpL3Zhbi9iZWF0LWRldGVjdGlvbi11c2luZy13ZWItYXVkaW8vXVxyXG4gKiBUaGlzIGltcGxlbWVudGF0aW9uIGRpZmZlcnMgZnJvbSB0aG9zZSBzaG93biBpbiB0aG9zZSBwYXBlcnMsIGJ1dCB0aGV5IGFyZVxyXG4gKiBhIGdvb2Qgc3RhcnQgdG8gdW5kZXJzdGFuZCBob3cgcGVha3MgY2FuIGJlIGRldGVjdGVkXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQXVkaW9BbmFseXNlclxyXG57XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGJ1ZmZlclNpemUgU2l6ZSBvZiB0aGUgZGF0YSBidWZmZXJcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggYnVmZmVyU2l6ZSApXHJcbiAge1xyXG4gICAgdGhpcy5idWZmZXJTaXplID0gYnVmZmVyU2l6ZTtcclxuICAgIHRoaXMuZGF0YSA9IG5ldyBBdWRpb0FuYWx5c2VkRGF0YSggYnVmZmVyU2l6ZSApO1xyXG4gICAgdGhpcy5pdGVyYXRpb25zID0gMDtcclxuXHJcbiAgICBpZiggQXBwQ29uZmlnLmNoZWNrQ29uZmlnICkgdGhpcy5jaGVja09wdGlvbnMoIEFuYWx5c2VyQ29uZmlnICk7XHJcbiAgICBpZiggQXBwQ29uZmlnLnNob3dsb2dpbmZvcyApIGNvbnNvbGUubG9nKCBgQW5hbHlzZXIgaW5pdGlhbGl6ZWRcXG4tLS0tLS0tLS0tLS1gICk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQW5hbHlzZSB0aGUgZGF0YSBwcm92aWRlZCBieSB0aGUgQXVkaW9TdHJlYW1cclxuICAgKiBAcGFyYW0ge0F1ZGlvRGF0YX0gYXVkaW9EYXRhIERhdGEgcHJvdmlkZWQgYnkgdGhlIEF1ZGlvU3RyZWFtLmdldEF1ZGlvRGF0YSgpXHJcbiAgICogQHBhcmFtIGRlbHRhVGltZSBFbGFwc2VkIHRpbWUgc2luY2UgbGFzdCBhbmFseXNpc1xyXG4gICAqIEBwYXJhbSBjdXJyZW50VGltZXIgVGhlIHRpbWVyIG9mIHRoZSBjdXJyZW50IGxvb3BcclxuICAgKi9cclxuICBhbmFseXNlKCBhdWRpb0RhdGEsIGRlbHRhVGltZSwgY3VycmVudFRpbWVyIClcclxuICB7XHJcbiAgICB0aGlzLml0ZXJhdGlvbnMrKztcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgbWV0aG9kIGxvb2tzIGhvcnJpYmxlIGJ1dCB0aGUgbG9naWNhbCB0ZXN0cyBhcmUgdXNlZnVsIHRvIHNhdmUgQ1BVIHVzYWdlXHJcbiAgICAgKiBpZiBhbGwgdGhlIGFuYWx5c2lzIGFyZSBub3QgcmVxdWlyZWQgYnkgdGhlIHZpc3VhbGl6ZXJcclxuICAgICAqL1xyXG5cclxuICAgIHRoaXMuZGF0YS5zZXRUaW1lZG9tYWluRGF0YSggYXVkaW9EYXRhLnRpbWVkb21haW5EYXRhICk7XHJcbiAgICB0aGlzLmRhdGEuc2V0RnJlcXVlbmNpZXNEYXRhKCBhdWRpb0RhdGEuZnJlcXVlbmN5RGF0YSApO1xyXG5cclxuICAgIC8vIFBlYWsgZGV0ZWN0aW9uXHJcbiAgICBsZXQgcmV0dXJucyA9IEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMucmV0dXJucztcclxuXHJcbiAgICBpZiggcmV0dXJucy5lbmVyZ3kgfHwgcmV0dXJucy5lbmVyZ3lBdmVyYWdlIHx8IHJldHVybnMuZW5lcmd5SGlzdG9yeSB8fCByZXR1cm5zLnBlYWsgfHwgcmV0dXJucy5wZWFrSGlzdG9yeSApXHJcbiAgICB7XHJcbiAgICAgIC8vIHdlIGZpcnN0IGNvbXB1dGUgdGhlIGVuZXJneSBhbmQgcHVzaCBpdCB0byB0aGUgZW5lcmd5IGhpc3RvcnlcclxuICAgICAgdGhpcy5kYXRhLnB1c2hOZXdFbmVyZ3koIHRoaXMuY29tcHV0ZUVuZXJneSh0aGlzLmRhdGEuZ2V0VGltZWRvbWFpbkRhdGEoKSksIGRlbHRhVGltZSApO1xyXG5cclxuICAgICAgaWYoIHJldHVybnMuZW5lcmd5QXZlcmFnZSB8fCByZXR1cm5zLnBlYWsgfHwgcmV0dXJucy5wZWFrSGlzdG9yeSApXHJcbiAgICAgIHtcclxuICAgICAgICB0aGlzLmRhdGEuc2V0RW5lcmd5QXZlcmFnZSggdGhpcy5jb21wdXRlTG9jYWxFbmVyZ3lBdmVyYWdlKHRoaXMuZGF0YS5nZXRFbmVyZ3lIaXN0b3J5KCkpICk7XHJcblxyXG4gICAgICAgIGlmKCByZXR1cm5zLnBlYWsgfHwgcmV0dXJucy5wZWFrSGlzdG9yeSApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgdGhpcy5jb21wdXRlUGVha0RldGVjdGlvbiggdGhpcy5kYXRhLmdldEVuZXJneSgpLCB0aGlzLmRhdGEuZ2V0RW5lcmd5QXZlcmFnZSgpLCB0aGlzLmRhdGEucGVhaywgdGhpcy5kYXRhLnBlYWtIaXN0b3J5LCBjdXJyZW50VGltZXIsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQW5hbHlzZXJDb25maWcub3B0aW9ucy5wZWFrRGV0ZWN0aW9uLm9wdGlvbnMudGhyZXNob2xkLCBBbmFseXNlckNvbmZpZy5vcHRpb25zLnBlYWtEZXRlY3Rpb24ub3B0aW9ucy5wZWFrUGVyc2lzdGVuY3ksIEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMucGVha0RldGVjdGlvbi5vcHRpb25zLmlnbm9yZVRpbWUsIEVBU0lOR1MubGluZWFyICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmKCByZXR1cm5zLm11bHRpYmFuZEVuZXJneSB8fCByZXR1cm5zLm11bHRpYmFuZEVuZXJneUF2ZXJhZ2UgfHwgcmV0dXJucy5tdWx0aWJhbmRFbmVyZ3lIaXN0b3J5IHx8IHJldHVybnMubXVsdGliYW5kUGVhayB8fCByZXR1cm5zLm11bHRpYmFuZFBlYWtIaXN0b3J5IClcclxuICAgIHtcclxuICAgICAgdGhpcy5kYXRhLnB1c2hOZXdNdWx0aWJhbmRFbmVyZ3koIHRoaXMuY29tcHV0ZU11bHRpYmFuZEVuZXJneSggYXVkaW9EYXRhLmZyZXF1ZW5jeURhdGEsIEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMubXVsdGliYW5kUGVha0RldGVjdGlvbi5vcHRpb25zLmJhbmRzICksIGRlbHRhVGltZSApO1xyXG4gICAgICBcclxuICAgICAgaWYoIHJldHVybnMubXVsdGliYW5kRW5lcmd5QXZlcmFnZSB8fCByZXR1cm5zLm11bHRpYmFuZFBlYWsgfHwgcmV0dXJucy5tdWx0aWJhbmRQZWFrSGlzdG9yeSApXHJcbiAgICAgIHtcclxuICAgICAgICB0aGlzLmRhdGEuc2V0TXVsdGliYW5kRW5lcmd5QXZlcmFnZSggdGhpcy5jb21wdXRlTXVsdGliYW5kTG9jYWxFbmVyZ3lBdmVyYWdlKHRoaXMuZGF0YS5nZXRNdWx0aWJhbmRFbmVyZ3lIaXN0b3J5KCkpICk7XHJcblxyXG4gICAgICAgIGlmKCByZXR1cm5zLm11bHRpYmFuZFBlYWtIaXN0b3J5IHx8IHJldHVybnMubXVsdGliYW5kUGVhayApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgdGhpcy5jb21wdXRlTXVsdGliYW5kUGVha0RldGVjdGlvbiggdGhpcy5kYXRhLmdldE11bHRpYmFuZEVuZXJneSgpLCB0aGlzLmRhdGEuZ2V0TXVsdGliYW5kRW5lcmd5QXZlcmFnZSgpLCB0aGlzLmRhdGEubXVsdGliYW5kUGVhaywgdGhpcy5kYXRhLm11bHRpYmFuZFBlYWtIaXN0b3J5LCBjdXJyZW50VGltZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy50aHJlc2hvbGQsIEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMubXVsdGliYW5kUGVha0RldGVjdGlvbi5vcHRpb25zLnBlYWtQZXJzaXN0ZW5jeSwgQW5hbHlzZXJDb25maWcub3B0aW9ucy5tdWx0aWJhbmRQZWFrRGV0ZWN0aW9uLm9wdGlvbnMuaWdub3JlVGltZSwgRUFTSU5HUy5saW5lYXIgKTsgIFxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gY2hlY2sgaWYgdGhlIGNvbmZpZyBpcyBzZXQgY29ycmVjdGx5LiBJdCBvbmx5IHNob3dzIGFuIGVycm9yIGlmIG5lZWRlZC5cclxuICAgKiBAcGFyYW0ge0FuYWx5c2VyQ29uZmlnfSBjb25maWcgQ29uZmlnIHRvIGNoZWNrXHJcbiAgICovXHJcbiAgY2hlY2tPcHRpb25zKCBjb25maWcgKVxyXG4gIHtcclxuICAgIGlmKCBBcHBDb25maWcuc2hvd2xvZ2luZm9zICkgY29uc29sZS5sb2coIGBDaGVja2luZyBpZiB0aGUgYW5hbHlzZXIgY29uZmlndXJhdGlvbiBpcyBjb3JyZWN0YCApO1xyXG5cclxuICAgIC8vIHdlIGZpcnN0IGNoZWNrIGlmIHNvbWUgdmFsdWVzIGFyZSBjb3JyZWN0IFxyXG4gICAgaWYoIGNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24uZW5hYmxlZCApXHJcbiAgICB7XHJcbiAgICAgIGlmKCAhKGNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5iYW5kcyAmJiAoY29uZmlnLm9wdGlvbnMubXVsdGliYW5kUGVha0RldGVjdGlvbi5vcHRpb25zLmJhbmRzICYgKGNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5iYW5kcyAtIDEpKSA9PT0gMCkgKVxyXG4gICAgICAgIGlmKCBBcHBDb25maWcuc2hvd2Vycm9ycyApIGNvbnNvbGUuZXJyb3IoIGBUaGUgbnVtYmVyIG9mIGJhbmRzIGZvciB0aGUgbXVsdGliYW5kIGRldGVjdGlvbiBhbGdvcml0aG0gbXVzdCBiZSBhIHBvdyBvZiAyLmAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiggY29uZmlnLm9wdGlvbnMucmV0dXJucy5wZWFrSGlzdG9yeSAhPSBjb25maWcub3B0aW9ucy5yZXR1cm5zLm11bHRpYmFuZFBlYWtIaXN0b3J5IClcclxuICAgIHtcclxuICAgICAgaWYoIEFwcENvbmZpZy5zaG93ZXJyb3JzICkgY29uc29sZS5lcnJvciggYER1ZSB0byB0aGUgY29uY2VwdGlvbiBvZiB0aGUgYW5hbHlzZXIsIHRoZSBgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gd2UgY2hlY2sgaWYgdGhlIHJldHVybiB2YWx1ZXMgY2FuIGJlIHJldHVybmVkXHJcbiAgICBpZiggIWNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24uZW5hYmxlZCApXHJcbiAgICB7XHJcbiAgICAgIGlmKCBjb25maWcub3B0aW9ucy5yZXR1cm5zLm11bHRpYmFuZFBlYWsgKVxyXG4gICAgICAgIGlmKCBBcHBDb25maWcuc2hvd2Vycm9ycyApIGNvbnNvbGUuZXJyb3IoIGBUaGUgbXVsdGliYW5kIHBlYWsgY2FuJ3QgYmUgY29tcHV0ZWQgaWYgdGhlIG11bHRpYmFuZCBwZWFrIGRldGVjdGlvbiBhbGdvcml0aG0gaXMgZGlzYWJsZWQuYCApO1xyXG4gICAgICBpZiggY29uZmlnLm9wdGlvbnMucmV0dXJucy5tdWx0aWJhbmRQZWFrSGlzdG9yeSApXHJcbiAgICAgICAgaWYoIEFwcENvbmZpZy5zaG93ZXJyb3JzICkgY29uc29sZS5lcnJvciggYFRoZSBtdWx0aWJhbmQgcGVhayBoaXN0b3J5IGNhbid0IGJlIGNvbXB1dGVkIGlmIHRoZSBtdWx0aWJhbmQgcGVhayBkZXRlY3Rpb24gYWxnb3JpdGhtIGlzIGRpc2FibGVkLmAgKTtcclxuICAgIH1cclxuICAgIGlmKCAhY29uZmlnLm9wdGlvbnMucGVha0RldGVjdGlvbi5lbmFibGVkIClcclxuICAgIHtcclxuICAgICAgaWYoIGNvbmZpZy5vcHRpb25zLnJldHVybnMucGVhayApXHJcbiAgICAgICAgaWYoIEFwcENvbmZpZy5zaG93ZXJyb3JzICkgY29uc29sZS5lcnJvciggYFRoZSBwZWFrIGNhbid0IGJlIGNvbXB1dGVkIGlmIHRoZSBwZWFrIGRldGVjdGlvbiBhbGdvcml0aG0gaXMgZGlzYWJsZWQuYCApO1xyXG4gICAgICBpZiggY29uZmlnLm9wdGlvbnMucmV0dXJucy5wZWFrSGlzdG9yeSApXHJcbiAgICAgICAgaWYoIEFwcENvbmZpZy5zaG93ZXJyb3JzICkgY29uc29sZS5lcnJvciggYFRoZSBwZWFrIGhpc3RvcnkgY2FuJ3QgYmUgY29tcHV0ZWQgaWYgdGhlIHBlYWsgZGV0ZWN0aW9uIGFsZ29yaXRobSBpcyBkaXNhYmxlZC5gICk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYoIEFwcENvbmZpZy5zaG93bG9naW5mb3MgKSBjb25zb2xlLmxvZyggYENvbmZpZyBjaGVja2VkLlxcbi0tLS0tLS0tLS0tLWAgKTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBAcmV0dXJuIHtBdWRpb0FuYWx5c2VkRGF0YX0gRnVsbCBhbmFseXNlZCBkYXRhXHJcbiAgICovXHJcbiAgZ2V0QW5hbHlzZWREYXRhKClcclxuICB7XHJcbiAgICByZXR1cm4gdGhpcy5kYXRhO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm4ge0F1ZGlvQW5hbHlzZWREYXRhRm9yVmlzdWFsaXphdGlvbn0gT25seSB0aGUgZGF0YSBzcGVjaWZpZWQgaW4gdGhlIGFuYWx5c2VyIGNvbmZpZ1xyXG4gICAqL1xyXG4gIGdldEFuYWx5c2VkRGF0YUZvclZpc3VhbGl6YXRpb24oKVxyXG4gIHtcclxuICAgIHJldHVybiBuZXcgQXVkaW9BbmFseXNlZERhdGFGb3JWaXN1YWxpemF0aW9uKCB0aGlzLmRhdGEgKTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBDb21wdXRlcyB0aGUgZW5lcmd5IG9mIGEgc2lnbmFsXHJcbiAgICogQHBhcmFtIHtVaW50OEFycmF5fSB0aW1lZG9tYWluRGF0YSBUaGUgdGltZWRvbWFpbiBkYXRhIG9mIHRoZSBzaWduYWxcclxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBlbmVyZ3kgb2YgdGhlIHRpbWVkb21haW4gZGF0YVxyXG4gICAqL1xyXG4gIGNvbXB1dGVFbmVyZ3koIHRpbWVkb21haW5EYXRhIClcclxuICB7XHJcbiAgICBsZXQgZW5lcmd5ID0gMDtcclxuICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGltZWRvbWFpbkRhdGEubGVuZ3RoOyBpKysgKVxyXG4gICAgICBlbmVyZ3krPSBNYXRoLmFicyggdGltZWRvbWFpbkRhdGFbaV0gLSAxMjggKTtcclxuICAgIHJldHVybiBlbmVyZ3kvdGltZWRvbWFpbkRhdGEubGVuZ3RoO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIENvbXB1dGVzIHRoZSBsb2NhbCBhdmVyYWdlIG9mIHRoZSBlbmVyZ3kgaGlzdG9yeVxyXG4gICAqIEBwYXJhbSB7QXJyYXl9IGVuZXJneUhpc3RvcnkgXHJcbiAgICogQHJldHVybnMge251bWJlcn0gdGhlIGF2ZXJhZ2UgZW5lcmd5IG9mIHRoZSBoaXN0b3J5XHJcbiAgICovXHJcbiAgY29tcHV0ZUxvY2FsRW5lcmd5QXZlcmFnZSggZW5lcmd5SGlzdG9yeSApXHJcbiAge1xyXG4gICAgcmV0dXJuIGVuZXJneUhpc3RvcnkucmVkdWNlKCAoYSxiKSA9PiBhK2IsIDAgKSAvIGVuZXJneUhpc3RvcnkubGVuZ3RoO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFVzZXMgdGhlIFthdF1wYXJhbSBwZWFrIHRvIGNoZWNrIGlmIGEgcGVhayBoYXMgYmVlbiBkZXRlY3RlZCByZWNlbnRseSBhbmQgdXBkYXRlcyBcclxuICAgKiBpdHMgdmFsdWVzLCBpZiBub3QgaXQgY2hlY2tzIGlmIGEgcGVhayBpcyBkZXRlY3RlZFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBlbmVyZ3kgZW5lcmd5IG9mIHRoZSBtb21lbnRcclxuICAgKiBAcGFyYW0ge251bWJlcn0gZW5lcmd5QXZlcmFnZSBhdmVyYWdlIG9mIHRoZSBsYXN0IGVuZXJnaWVzXHJcbiAgICogQHBhcmFtIHtQZWFrfSBwZWFrIEluZm9ybWF0aW9ucyBvbiB0aGUgcGVha1xyXG4gICAqIEBwYXJhbSB7QXJyYXl9IHBlYWtIaXN0b3J5IEhpc3Rvcnkgb2YgdGhlIHJlY29yZGVkIHBlYWtzXHJcbiAgICogQHBhcmFtIHsqfSBjdXJyZW50VGltZXIgdGhlIGFic29sdXRlIHRpbWVyIG9uIHRoZSBjdXJyZW50IGxvb3AgXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHRocmVzaG9sZCB0aGUgaGlnaGVyIHRoaXMgdmFsdWUgaXMsIHRoZSBoYXJkZXIgdGhlIHBlYWsgaGFzIHRvIGhpdCB0byBiZSBkZXRlY3RlZFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBwZWFrUGVyc2lzdGVuY3kgdGhlIHRpbWUgaXQgdGFrZXMgZm9yIHRoZSBwZWFrIHZhbGV1IHRvIGdvIGZyb20gMSB0byAwXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGlnbm9yZVRpbWUgdGltZSB3aGVuIGEgcGVhayBjYW4ndCBiZSBkZXRlY3RlZCBhZnRlciBhIGRldGVjdGlvblxyXG4gICAqIEBwYXJhbSB7Kn0gaW50ZXJwb2xhdGlvbkZ1bmN0aW9uIFswOzFdID0+IFswOzFdXHJcbiAgICovXHJcbiAgY29tcHV0ZVBlYWtEZXRlY3Rpb24oIGVuZXJneSwgZW5lcmd5QXZlcmFnZSwgcGVhaywgcGVha0hpc3RvcnksIGN1cnJlbnRUaW1lciwgdGhyZXNob2xkLCBwZWFrUGVyc2lzdGVuY3ksIGlnbm9yZVRpbWUsIGludGVycG9sYXRpb25GdW5jdGlvbiApXHJcbiAge1xyXG4gICAgLy8gaWYgYSBwZWFrIGhhcyBhbHJlYWR5IGJlZW4gZGV0ZWN0ZWRcclxuICAgIGlmKCBwZWFrLnRpbWVyICE9IG51bGwgKVxyXG4gICAge1xyXG4gICAgICAvLyBpZiBhIHBlYWsgaGFzIGJlZW4gZGV0ZWN0ZWQgcmVjZW50bHksIHdlIGNhbid0IGRldGVjdCBhIG5ldyBwZWFrIGR1cmluZyBpZ25vcmVUaW1lXHJcbiAgICAgIC8vIHdlIG9ubHkgZGVjcmVhc2UgdGhlIHZhbHVlIG9mIHRoZSBwZWFrXHJcbiAgICAgIGlmKCBjdXJyZW50VGltZXIgLSBwZWFrLnRpbWVyIDw9IGlnbm9yZVRpbWUgKVxyXG4gICAgICB7XHJcbiAgICAgICAgLy8gd2UgZGVjcmVhc2UgdGhlIHZhbHVlIG9mIHRoZSBwZWFrIGlmIGl0J3Mgbm90IDBcclxuICAgICAgICBpZiggcGVhay52YWx1ZSA+IDAuMCApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcGVhay52YWx1ZSA9IHRoaXMucGVha0ludGVycG9sYXRpb24oIGN1cnJlbnRUaW1lciwgcGVhay50aW1lciwgcGVha1BlcnNpc3RlbmN5LCBpbnRlcnBvbGF0aW9uRnVuY3Rpb24gKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZVxyXG4gICAgICB7XHJcbiAgICAgICAgLy8gd2UgdHJ5IGEgcGVhayBkZXRlY3Rpb25cclxuICAgICAgICBpZiggZW5lcmd5IC8gZW5lcmd5QXZlcmFnZSA+IHRocmVzaG9sZCApIC8vIHdlIGhhdmUgYSBwZWFrXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgbGV0IGRldGVjdGVkUGVhayA9IG5ldyBQZWFrKCAxLjAsIGN1cnJlbnRUaW1lciwgZW5lcmd5ICk7XHJcbiAgICAgICAgICBpZiggQW5hbHlzZXJDb25maWcub3B0aW9ucy5yZXR1cm5zLnBlYWtIaXN0b3J5IClcclxuICAgICAgICAgICAgcGVha0hpc3RvcnkucHVzaCggZGV0ZWN0ZWRQZWFrICk7XHJcbiAgICAgICAgICBwZWFrLmNvcHkoIGRldGVjdGVkUGVhayApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKCBwZWFrLnZhbHVlID4gMC4wICkgLy8gaWYgdGhlIGRldGVjdGVkIHBlYWsgaXMgc3RpbGwgbm90IHRvIDAgd2UgZGVjcmVhc2UgaXRzIHZhbHVlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcGVhay52YWx1ZSA9IHRoaXMucGVha0ludGVycG9sYXRpb24oIGN1cnJlbnRUaW1lciwgcGVhay50aW1lciwgcGVha1BlcnNpc3RlbmN5LCBpbnRlcnBvbGF0aW9uRnVuY3Rpb24gKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgLy8gd2UgdHJ5IGEgcGVhayBkZXRlY3Rpb25cclxuICAgIHtcclxuICAgICAgaWYoIGVuZXJneSAvIGVuZXJneUF2ZXJhZ2UgPiB0aHJlc2hvbGQgKSAvLyB3ZSBoYXZlIGEgcGVha1xyXG4gICAgICB7XHJcbiAgICAgICAgbGV0IGRldGVjdGVkUGVhayA9IG5ldyBQZWFrKCAxLjAsIGN1cnJlbnRUaW1lciwgZW5lcmd5ICk7XHJcbiAgICAgICAgaWYoIEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMucmV0dXJucy5wZWFrSGlzdG9yeSApXHJcbiAgICAgICAgICBwZWFrSGlzdG9yeS5wdXNoKCBkZXRlY3RlZFBlYWsgKTtcclxuICAgICAgICBwZWFrLmNvcHkoIGRldGVjdGVkUGVhayApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtVaW50OEFycmF5fSBmcmVxdWVuY3lEYXRhIHRoZSBmcmVxdWVuY2llcyBkYXRhXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IG5iQmFuZHMgTnVtYmVyIG9mIGJhbmRzXHJcbiAgICogQHJldHVybnMge0FycmF5fSB0aGUgYXJyYXkgZW5lcmd5IG9mIGVhY2ggYmFuZFxyXG4gICAqL1xyXG4gIGNvbXB1dGVNdWx0aWJhbmRFbmVyZ3koIGZyZXF1ZW5jeURhdGEsIG5iQmFuZHMgKVxyXG4gIHtcclxuICAgIGxldCBmU2l6ZSA9IGZyZXF1ZW5jeURhdGEubGVuZ3RoLFxyXG4gICAgICAgIGJhbmRzRW5lcmd5ID0gbmV3IEFycmF5KCBuYkJhbmRzICk7XHJcblxyXG4gICAgLy8gd2UgcGFyc2UgZWFjaCBiYW5kXHJcbiAgICBmb3IoIGxldCBiYW5kID0gMDsgYmFuZCA8IG5iQmFuZHM7IGJhbmQrKyApXHJcbiAgICB7XHJcbiAgICAgIGxldCBmaXJzdEluZGV4ID0gdGhpcy5iYW5kSW50ZXJwb2xhdGlvbiggYmFuZCAvIG5iQmFuZHMgKSAqIGZTaXplLFxyXG4gICAgICAgICAgbGFzdEluZGV4ID0gdGhpcy5iYW5kSW50ZXJwb2xhdGlvbiggKGJhbmQrMSkgLyBuYkJhbmRzICkgKiBmU2l6ZSxcclxuICAgICAgICAgIGJhbmRFbmVyZ3kgPSAwO1xyXG5cclxuICAgICAgLy8gZm9yIGVhY2ggYmFuZCB3ZSBwYXJzZSB0aGUgZnJlcXVlbmNpZXNcclxuICAgICAgZm9yKCBsZXQgZiA9IGZpcnN0SW5kZXg7IGYgPCBsYXN0SW5kZXg7IGYrKyApXHJcbiAgICAgICAgYmFuZEVuZXJneSs9IGZyZXF1ZW5jeURhdGFbZl07IFxyXG4gICAgICBcclxuICAgICAgYmFuZHNFbmVyZ3lbYmFuZF0gPSBiYW5kRW5lcmd5LyhsYXN0SW5kZXgtZmlyc3RJbmRleCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGJhbmRzRW5lcmd5O1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7QXJyYXl9IGVuZXJnaWVzSGlzdG9yeSBUaGUgaGlzdG9yeSBvZiBlYWNoIGJhbmQgZW5lcmd5XHJcbiAgICogQHJldHVybnMge0FycmF5fSB0aGUgYXJyYXkgb2YgZWFjaCBiYW5kIGVuZXJneSBhdmVyYWdlXHJcbiAgICovXHJcbiAgY29tcHV0ZU11bHRpYmFuZExvY2FsRW5lcmd5QXZlcmFnZSggZW5lcmdpZXNIaXN0b3J5IClcclxuICB7XHJcbiAgICBsZXQgZW5lcmdpZXNBdmVyYWdlID0gbmV3IEFycmF5KCBBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5iYW5kcyApO1xyXG5cclxuICAgIC8vIHdlIGluaXQgdGhlIHZhbHVlc1xyXG4gICAgZm9yKCBsZXQgaSA9IDA7IGkgPCBBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5iYW5kczsgaSsrIClcclxuICAgICAgZW5lcmdpZXNBdmVyYWdlW2ldID0gMDtcclxuXHJcbiAgICAvLyBmaXJzdCB3ZSBnbyB0aHJvdWdoIHRoZSBoaXN0b3J5IFxyXG4gICAgZm9yKCBsZXQgaSA9IDA7IGkgPCBlbmVyZ2llc0hpc3RvcnkubGVuZ3RoOyBpKysgKVxyXG4gICAge1xyXG4gICAgICAvLyB0aGVuIHdlIGdvIHRob3VnaCBlYWNoIGJhbmRcclxuICAgICAgZm9yKCBsZXQgYiA9IDA7IGIgPCBlbmVyZ2llc0hpc3RvcnlbaV0ubGVuZ3RoOyBiKysgKVxyXG4gICAgICB7XHJcbiAgICAgICAgZW5lcmdpZXNBdmVyYWdlW2JdKz0gZW5lcmdpZXNIaXN0b3J5W2ldW2JdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZm9yKCBsZXQgaSA9IDA7IGkgPCBBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5iYW5kczsgaSsrIClcclxuICAgICAgZW5lcmdpZXNBdmVyYWdlW2ldLz0gZW5lcmdpZXNIaXN0b3J5Lmxlbmd0aDtcclxuICAgIFxyXG4gICAgcmV0dXJuIGVuZXJnaWVzQXZlcmFnZTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBQYXJzZSBlYWNoIGJhbmQgdG8gc2VlIGlmIHRoZXJlIGlzIGEgbG9jYWwgcGVhayBvbiBlYWNoIG9uZSBcclxuICAgKiBvZiB0aGVtLiBVc2VzIHRoZSBjb21wdXRlUGVha0RldGVjdGlvbiBtZXRob2QgaW4gdGhhdCBwdXJwb3NlLlxyXG4gICAqIEBwYXJhbSB7QXJyYXl9IG11bHRpYmFuZEVuZXJneSBhcnJheSBvZiB0aGUgY29tcHV0ZWQgZW5lcmd5IG9mIGVhY2ggYmFuZFxyXG4gICAqIEBwYXJhbSB7QXJyYXl9IG11bHRpYmFuZEVuZXJneUF2ZXJhZ2UgYXJyYXkgb2YgdGhlIGNvbXB1dGVkIGF2ZXJhZ2UgbG9jYWwgZW5lcmd5IG9mIGVhY2ggYmFuZFxyXG4gICAqIEBwYXJhbSB7QXJyYXl9IG11bHRpYmFuZFBlYWsgYXJyYXkgb2YgZWFjaCBiYW5kIHBlYWtcclxuICAgKiBAcGFyYW0ge0FycmF5fSBtdWx0aWJhbmRQZWFrSGlzdG9yeSBhcnJheSBvZiBlYWNoIGJhbmQgcGVha3MgaGlzdG9yeVxyXG4gICAqIEBwYXJhbSB7Kn0gY3VycmVudFRpbWVyIGFic29sdXRlIHRpbWVyIG9uIHRoZSBjdXJyZW50IGZyYW1lXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHRocmVzaG9sZCB0aGUgaGlnaGVyIGl0IGlzLCB0aGUgaGFyZGVyIGEgcGVhayBoYXMgdG8gaGl0IHRvIGJlIGRldGVjdGVkXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHBlYWtQZXJzaXN0ZW5jeSB0aW1lIGl0IHRha2VzIGZvciBhIHBlYWsgdG8gZ28gZnJvbSAxIHRvIDBcclxuICAgKiBAcGFyYW0ge251bWJlcn0gaWdub3JlVGltZSB0aW1lIGR1cmluZyBhIHBlYWsgY2FuJ3QgYmUgZGV0ZWN0ZWQgYWZ0ZXIgYSBkZXRlY3Rpb25cclxuICAgKiBAcGFyYW0geyp9IGludGVycG9sYXRpb25GdW5jdGlvbiBbMDsgMV0gPT4gWzA7IDFdIGRlY3JlYXNlIGZ1bmN0aW9uIG9mIHRoZSBwZWFrXHJcbiAgICovXHJcbiAgY29tcHV0ZU11bHRpYmFuZFBlYWtEZXRlY3Rpb24oIG11bHRpYmFuZEVuZXJneSwgbXVsdGliYW5kRW5lcmd5QXZlcmFnZSwgbXVsdGliYW5kUGVhaywgbXVsdGliYW5kUGVha0hpc3RvcnksIGN1cnJlbnRUaW1lciwgdGhyZXNob2xkLCBwZWFrUGVyc2lzdGVuY3ksIGlnbm9yZVRpbWUsIGludGVycG9sYXRpb25GdW5jdGlvbiApXHJcbiAge1xyXG4gICAgbGV0IGJhbmRzTmIgPSBtdWx0aWJhbmRQZWFrLmxlbmd0aDtcclxuICAgIGZvciggbGV0IGJhbmQgPSAwOyBiYW5kIDwgYmFuZHNOYjsgYmFuZCsrICl7XHJcbiAgICAgIHRoaXMuY29tcHV0ZVBlYWtEZXRlY3Rpb24oIG11bHRpYmFuZEVuZXJneVtiYW5kXSwgbXVsdGliYW5kRW5lcmd5QXZlcmFnZVtiYW5kXSwgbXVsdGliYW5kUGVha1tiYW5kXSwgbXVsdGliYW5kUGVha0hpc3RvcnlbYmFuZF0sIGN1cnJlbnRUaW1lciwgdGhyZXNob2xkLCBwZWFrUGVyc2lzdGVuY3ksIGlnbm9yZVRpbWUsIGludGVycG9sYXRpb25GdW5jdGlvbiApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgZnVuY3Rpb24gbXVzdCBiZSBncm93aW5nIGFuZCBjb250aW51ZSBvbiBbMDsgMV1cclxuICAgKiBpbiB0aGlzIGNhc2UgZih4KSA9IHjCslxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBiYW5kcG9zaXRpb24gWzA7IDFdIHRoZSBiYW5kIC8gdG90YWwgb2YgYmFuZHNcclxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSBbMDsgMV0gdGhlIG5ldyBwb3NpdGlvbiBvZiB0aGUgYmFuZFxyXG4gICAqL1xyXG4gIGJhbmRJbnRlcnBvbGF0aW9uKCBiYW5kcG9zaXRpb24gKVxyXG4gIHtcclxuICAgIHJldHVybiBiYW5kcG9zaXRpb24qYmFuZHBvc2l0aW9uO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEBwYXJhbSB7Kn0gY3VycmVudFRpbWVyIFRoZSBjdXJyZW50IHRpbWVyIG9uIHRoZSBmcmFtZVxyXG4gICAqIEBwYXJhbSB7Kn0gcGVha1RpbWVyIFRoZSBhYnNvbHV0ZSB0aW1lciBvZiB0aGUgcGVha1xyXG4gICAqIEBwYXJhbSB7Kn0gcGVha1BlcnNpc3RlbmN5IFRoZSB0aW1lIGEgcGVhayB0YWtlcyB0byBnbyBkb3duIHRvIDBcclxuICAgKiBAcGFyYW0geyp9IGVhc2luZ0Z1bmN0aW9uIEZ1bmN0aW9uIGludGVycG9sYXRpb25cclxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSB0aGUgdmFsdWUgb2YgdGhlIHBlYWtcclxuICAgKi9cclxuICBwZWFrSW50ZXJwb2xhdGlvbiggY3VycmVudFRpbWVyLCBwZWFrVGltZXIsIHBlYWtQZXJzaXN0ZW5jeSwgZWFzaW5nRnVuY3Rpb24gKVxyXG4gIHtcclxuICAgIHJldHVybiBNYXRoLm1heCggMC4wLCBlYXNpbmdGdW5jdGlvbiggMS4wIC0gKGN1cnJlbnRUaW1lciAtIHBlYWtUaW1lcikgLyBwZWFrUGVyc2lzdGVuY3kgKSApO1xyXG4gIH1cclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2F1ZGlvYW5hbHlzaXMvYXVkaW8tYW5hbHlzZXIuanMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTs7Ozs7QUFFQTs7Ozs7Ozs7QUFRQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFNQTtBQUVBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFhQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUVBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7Ozs7OztBQWFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7QUFPQTtBQUVBO0FBQ0E7Ozs7OztBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///10\n")},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AnalysedDataVisualizer = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nvar _analyser = __webpack_require__(1);\n\nvar _analyser2 = _interopRequireDefault(_analyser);\n\nvar _audioAnalysedData = __webpack_require__(6);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * This values are used to set the position/size of the differents\r\n * pannels\r\n */\nvar PANNEL_SIGNAL = {\n  pos_x: 0, pos_y: 0, size_x: 256, size_y: 128\n},\n    PANNEL_SPECTRUM = {\n  pos_x: 256, pos_y: 0, size_x: 256, size_y: 128\n},\n    PANNEL_ENERGY = {\n  pos_x: 512, pos_y: 0, size_x: 256, size_y: 128\n},\n    PANNEL_MULTIBAND_ENERGIES = {\n  pos_x: 0, pos_y: 128, size_x: 1024, size_y: 125\n},\n    PANNEL_ALGO_1 = {\n  pos_x: 0, pos_y: 300, size_x: 1024, size_y: 40\n},\n    PANNEL_ALGO_2 = {\n  pos_x: 0, pos_y: 357, size_x: 1024, size_y: 400\n};\n\n/**\r\n * Provides a visual guidance to what the analysis is doing \r\n * This should only be used in development since this is only \r\n * non-optimized helper\r\n */\n\nvar AnalysedDataVisualizer = exports.AnalysedDataVisualizer = function () {\n  /** */\n  function AnalysedDataVisualizer() {\n    _classCallCheck(this, AnalysedDataVisualizer);\n\n    this.canvas = null;\n    this.context = null;\n    this.frame = 0;\n  }\n\n  /**\r\n   * Add a canvas to the body\r\n   * This canvas will be used by the draw() function\r\n   */\n\n\n  _createClass(AnalysedDataVisualizer, [{\n    key: 'init',\n    value: function init() {\n      this.canvas = document.createElement(\"canvas\");\n      this.canvas.setAttribute(\"width\", 1025);\n      this.canvas.setAttribute(\"height\", 1024);\n      document.body.appendChild(this.canvas);\n      this.context = this.canvas.getContext(\"2d\");\n      if (_app2.default.showloginfos) console.log('Visualizer initialized\\n------------');\n    }\n\n    /**\r\n     * This method needs to be called each frame \r\n     * @param {AudioAnalysedData} analysedData Data processed by the AudioAnalyser\r\n     * @param {*} startTimer Start timer of the visualization\r\n     */\n\n  }, {\n    key: 'draw',\n    value: function draw(analysedData, startTimer) {\n      this.frame++;\n\n      // we clear the canvas\n      this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n      this.context.fillStyle = \"black\";\n      this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n      this.drawSignal(analysedData.getTimedomainData());\n      this.drawSpectrum(analysedData.getFrequenciesData());\n      this.drawEnergyHistogram(analysedData.getEnergyHistory(), analysedData.getEnergyAverage());\n      this.drawPeakDetection(analysedData.peak, analysedData.peakHistory, startTimer);\n      this.drawMultibandHistogram(analysedData.getMultibandEnergyHistory());\n      this.drawMultibandPeakDetection(analysedData.multibandPeak, analysedData.multibandPeakHistory, startTimer);\n\n      this.context.strokeStyle = \"red\";\n      this.context.lineWidth = 1;\n      this.context.strokeRect(0, 0, 1024, 1024);\n    }\n\n    /**\r\n     * Draws the audio signal,\r\n     * using time domain data\r\n     * @param {Uint8Array} timedomaindata\r\n     */\n\n  }, {\n    key: 'drawSignal',\n    value: function drawSignal(timedomaindata) {\n      // first we draw the interface\n      this.context.strokeStyle = 'white';\n      this.context.strokeRect(PANNEL_SIGNAL.pos_x + 0.5, PANNEL_SIGNAL.pos_y + 0.5, PANNEL_SIGNAL.size_x, PANNEL_SIGNAL.size_y);\n      this.context.font = '12px Lucida Console';\n      this.context.fillStyle = 'white';\n      this.context.fillText('Unprocessed signal', PANNEL_SIGNAL.pos_x + 5, PANNEL_SIGNAL.pos_y + 13);\n\n      // x axis\n      this.context.beginPath();\n      this.context.moveTo(PANNEL_SIGNAL.pos_x, PANNEL_SIGNAL.pos_y + PANNEL_SIGNAL.size_y / 2);\n      this.context.lineTo(PANNEL_SIGNAL.pos_x + PANNEL_SIGNAL.size_x, PANNEL_SIGNAL.pos_y + PANNEL_SIGNAL.size_y / 2);\n      this.context.strokeStyle = 'blue';\n      this.context.stroke();\n      this.context.closePath();\n\n      // drawing the signal\n      this.context.beginPath();\n\n      var aspectRatio_x = PANNEL_SIGNAL.size_x / timedomaindata.length,\n          aspectRatio_y = PANNEL_SIGNAL.size_y / 256;\n\n      for (var i = 0; i < timedomaindata.length; i++) {\n        this.context.lineTo(i * aspectRatio_x + PANNEL_SIGNAL.pos_x, PANNEL_SIGNAL.pos_y + PANNEL_SIGNAL.size_y - timedomaindata[i] * aspectRatio_y);\n      }this.context.strokeStyle = 'white';\n      this.context.stroke();\n      this.context.closePath();\n    }\n\n    /**\r\n     * Draws the frequencies data\r\n     * @param {Uint8Array} frequencyData \r\n     */\n\n  }, {\n    key: 'drawSpectrum',\n    value: function drawSpectrum(frequencyData) {\n      var pannel = PANNEL_SPECTRUM;\n\n      // d'abord on dessine l'interface\n      this.context.strokeStyle = 'white';\n      this.context.strokeRect(pannel.pos_x + 0.5, pannel.pos_y + 0.5, pannel.size_x, pannel.size_y);\n      this.context.font = '12px Lucida Console';\n      this.context.fillStyle = 'white';\n      this.context.fillText('Signal spectrum', pannel.pos_x + 5, pannel.pos_y + 13);\n\n      var freqWidth = pannel.size_x / frequencyData.length,\n          heightRatio = pannel.size_y / 255;\n\n      for (var i = 0; i < frequencyData.length; i++) {\n        this.context.fillStyle = 'hsl(' + i / frequencyData.length * 180 + ', 100%, 50%)';\n        this.context.fillRect(pannel.pos_x + freqWidth * i + 1, pannel.pos_y + pannel.size_y - frequencyData[i] * heightRatio, freqWidth, frequencyData[i] * heightRatio);\n      }\n    }\n\n    /**\r\n     * Draw the energy histogram.\r\n     * This histogram is used by the peak detection algorithm\r\n     * @param {Array} energyHistory History of the energies\r\n     * @param {number} energyAverage The local average energy\r\n     */\n\n  }, {\n    key: 'drawEnergyHistogram',\n    value: function drawEnergyHistogram(energyHistory, energyAverage) {\n      var rect = PANNEL_ENERGY;\n\n      // first we draw the interface\n      this.context.strokeStyle = 'white';\n      this.context.strokeRect(rect.pos_x + 0.5, rect.pos_y + 0.5, rect.size_x, rect.size_y);\n      this.context.font = '12px Lucida Console';\n      this.context.fillStyle = 'red';\n      this.context.fillText('Moment energy', rect.pos_x + 5, rect.pos_y + 13);\n      this.context.fillStyle = 'white';\n      this.context.fillText('on signal compared to', rect.pos_x + 107, rect.pos_y + 13);\n      this.context.fillStyle = '#00ff00';\n      this.context.fillText('local average energy', rect.pos_x + 5, rect.pos_y + 27);\n\n      // average of the histogram \n      this.context.beginPath();\n      this.context.moveTo(rect.pos_x + rect.size_x, rect.pos_y + rect.size_y - energyAverage);\n      this.context.lineTo(rect.pos_x + rect.size_x - energyHistory.length * 2, rect.pos_y + rect.size_y - energyAverage);\n      this.context.strokeStyle = '#00ff00';\n      this.context.stroke();\n      this.context.closePath();\n\n      // we draw it \n      this.context.beginPath();\n\n      for (var i = 0; i < energyHistory.length; i++) {\n        this.context.lineTo(rect.pos_x + rect.size_x - i * 2, rect.pos_y + rect.size_y - energyHistory[energyHistory.length - i - 1]);\n      }this.context.strokeStyle = 'red';\n      this.context.stroke();\n      this.context.closePath();\n    }\n\n    /**\r\n     * Draws a timeline with all the detected peaks\r\n     * @param {Peak} peak Current peak used to real-time peak detection\r\n     * @param {Array} peakHistory Array of all the detected peaks\r\n     * @param {*} startTimer Absolute timer of the beginning of analysis\r\n     */\n\n  }, {\n    key: 'drawPeakDetection',\n    value: function drawPeakDetection(peak, peakHistory, startTimer) {\n      var rect = PANNEL_ALGO_1;\n      // d'abord on dessine l'interface\n      this.context.strokeStyle = 'white';\n      this.context.strokeRect(rect.pos_x + 0.5, rect.pos_y + 0.5, rect.size_x, rect.size_y);\n      this.context.font = '12px Lucida Console';\n      this.context.fillStyle = 'white';\n      this.context.fillText('ALGO1 / threshold: ' + _analyser2.default.options.peakDetection.options.threshold + ' / ignoreTime: ' + _analyser2.default.options.peakDetection.options.ignoreTime + ' / results: ' + peakHistory.length, rect.pos_x + 5, rect.pos_y - 2);\n\n      for (var i = 0; i < peakHistory.length; i++) {\n        this.context.beginPath();\n        this.context.moveTo(rect.pos_x + (peakHistory[i].timer - startTimer) / 1000 * 3, rect.pos_y + rect.size_y);\n        this.context.lineTo(rect.pos_x + (peakHistory[i].timer - startTimer) / 1000 * 3, rect.pos_y + 1);\n        this.context.strokeStyle = '#00ff00';\n        this.context.stroke();\n        this.context.closePath();\n      }\n\n      // on dessine le curseur \"play\" vitesse: 2px / s\n      this.context.beginPath();\n      this.context.moveTo(rect.pos_x + (new Date() - startTimer) / 1000 * 3, rect.pos_y + rect.size_y);\n      this.context.lineTo(rect.pos_x + (new Date() - startTimer) / 1000 * 3, rect.pos_y + 1);\n      this.context.strokeStyle = 'red';\n      this.context.stroke();\n      this.context.closePath();\n\n      // on a un beat \n      var beatPower = peak.value;\n      this.context.beginPath();\n      this.context.arc(rect.pos_x + rect.size_x - 20, rect.pos_y + rect.size_y / 2, 10, 0, 2 * Math.PI);\n      this.context.fillStyle = 'rgba(0,255,0,' + beatPower + ')';\n      this.context.fill();\n      this.context.closePath();\n    }\n\n    /**\r\n     * Draws the history of the energy of each band\r\n     * @param {Array} energiesHistory array history of the computed energies of each band over time\r\n     */\n\n  }, {\n    key: 'drawMultibandHistogram',\n    value: function drawMultibandHistogram(energiesHistory) {\n      var pannel = PANNEL_MULTIBAND_ENERGIES;\n\n      // interface\n      this.context.strokeStyle = 'white';\n      this.context.strokeRect(pannel.pos_x + 0.5, pannel.pos_y + 0.5, pannel.size_x, pannel.size_y);\n      this.context.font = '12px Lucida Console';\n      this.context.fillStyle = 'white';\n      this.context.fillText('Multi-band energies comparaisons: ' + _analyser2.default.options.multibandPeakDetection.options.bands + ' bands / ' + _analyser2.default.options.multibandPeakDetection.options.energyPersistence + 'ms energy persistence / max 28 on screen', pannel.pos_x + 5, pannel.pos_y + 13);\n\n      var band_histogram_width = 64,\n          band_histogram_height = 48,\n          margin = 5,\n          bands_y = 18,\n          bands_x = margin;\n\n      // parcours des bandes\n      for (var band = 0; band < _analyser2.default.options.multibandPeakDetection.options.bands && band < 28; band++) {\n        // passage à la ligne\n        if (bands_x + margin + band_histogram_width > this.canvas.width) {\n          bands_x = margin;\n          bands_y += margin + band_histogram_height;\n        }\n\n        // on dessine le cadre de la bande \n        this.context.strokeStyle = 'white';\n        this.context.strokeRect(pannel.pos_x + bands_x + 0.5, pannel.pos_y + bands_y + 0.5, band_histogram_width, band_histogram_height);\n\n        // on va seulement parcourir une valeur sur 2 de chaque histogramme\n        this.context.beginPath();\n        for (var i = 0; i < energiesHistory.length; i++) {\n          this.context.lineTo(pannel.pos_x + bands_x + 0.5 + band_histogram_width - i / 2, pannel.pos_y + bands_y + band_histogram_height - 0.5 - energiesHistory[energiesHistory.length - i - 1][band] * band_histogram_height / 256);\n        }\n        this.context.strokeStyle = 'red';\n        this.context.stroke();\n        this.context.closePath();\n\n        if (!(bands_x + margin + band_histogram_width > this.canvas.width)) {\n          bands_x += margin + band_histogram_width;\n        }\n      }\n    }\n\n    /**\r\n     * Draws a visual guidance for all the bands peak\r\n     * @param {Array} peaks array of each band peak\r\n     * @param {Array} peaksHistory array of each band peaks hisory\r\n     * @param {*} startTimer absolute timer of the start of analysis\r\n     */\n\n  }, {\n    key: 'drawMultibandPeakDetection',\n    value: function drawMultibandPeakDetection(peaks, peaksHistory, startTimer) {\n      var rect = PANNEL_ALGO_2;\n\n      // first we draw the interface\n      this.context.strokeStyle = 'white';\n      this.context.strokeRect(rect.pos_x + 0.5, rect.pos_y + 0.5, rect.size_x, rect.size_y);\n      this.context.font = '12px Lucida Console';\n      this.context.fillStyle = 'white';\n      this.context.fillText('ALGO2 / bands: ' + _analyser2.default.options.multibandPeakDetection.options.bands + ' threshold: ' + _analyser2.default.options.multibandPeakDetection.options.threshold + ' / ignoreTime: ' + _analyser2.default.options.multibandPeakDetection.options.ignoreTime, rect.pos_x + 5, rect.pos_y - 2);\n\n      var band_height = 20,\n          margin = 5;\n      var currentTimer = new Date();\n\n      for (var b = 0; b < _analyser2.default.options.multibandPeakDetection.options.bands; b++) {\n        for (var i = 0; i < peaksHistory[b].length; i++) {\n          this.context.beginPath();\n          this.context.moveTo(1 + rect.pos_x + margin + (peaksHistory[b][i].timer - startTimer) / 1000 * 3, rect.pos_y + b * band_height + margin * (b + 1));\n          this.context.lineTo(1 + rect.pos_x + margin + (peaksHistory[b][i].timer - startTimer) / 1000 * 3, rect.pos_y + b * band_height + margin * (b + 1) + band_height);\n          this.context.strokeStyle = 'hsl(' + b / _analyser2.default.options.multibandPeakDetection.options.bands * 180 + ', 100%, 50%)';\n          this.context.stroke();\n          this.context.closePath();\n        }\n\n        // détection de beat\n\n        var beatPower = peaks[b].value;\n        this.context.beginPath();\n        this.context.arc(rect.pos_x + rect.size_x - 20, rect.pos_y + b * band_height + margin * (b + 1) + band_height / 2, 7, 0, 2 * Math.PI);\n        this.context.fillStyle = 'hsl(' + b / _analyser2.default.options.multibandPeakDetection.options.bands * 180 + ', 100%, ' + beatPower * 50 + '%)';\n        this.context.fill();\n        this.context.closePath();\n\n        // on dessine le curseur \"play\" vitesse: 2px / s\n        this.context.beginPath();\n        this.context.moveTo(1 + margin + rect.pos_x + (currentTimer - startTimer) / 1000 * 3, rect.pos_y + (1 + b) * margin + b * band_height);\n        this.context.lineTo(1 + margin + rect.pos_x + (currentTimer - startTimer) / 1000 * 3, rect.pos_y + (1 + b) * margin + (b + 1) * band_height);\n        this.context.strokeStyle = 'white';\n        this.context.stroke();\n        this.context.closePath();\n\n        this.context.strokeStyle = 'white';\n        this.context.strokeRect(rect.pos_x + margin + 0.5, rect.pos_y + band_height * b + (b + 1) * margin + 0.5, rect.size_x - margin * 2, band_height);\n      }\n    }\n  }]);\n\n  return AnalysedDataVisualizer;\n}();\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2F1ZGlvYW5hbHlzaXMvdXRpbGl0eS9hbmFseXNlZC1kYXRhLXZpc3VhbGl6ZXIuanM/ZDgwOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBwQ29uZmlnIGZyb20gJy4uLy4uL2NvbmZpZy9hcHAuY29uZmlnJztcclxuaW1wb3J0IEFuYWx5c2VyQ29uZmlnIGZyb20gJy4uLy4uL2NvbmZpZy9hbmFseXNlci5jb25maWcnO1xyXG5cclxuaW1wb3J0IHsgQXVkaW9BbmFseXNlZERhdGEgfSBmcm9tICcuLi9hdWRpby1hbmFseXNlZC1kYXRhJztcclxuXHJcblxyXG4vKipcclxuICogVGhpcyB2YWx1ZXMgYXJlIHVzZWQgdG8gc2V0IHRoZSBwb3NpdGlvbi9zaXplIG9mIHRoZSBkaWZmZXJlbnRzXHJcbiAqIHBhbm5lbHNcclxuICovXHJcbmNvbnN0IFxyXG5QQU5ORUxfU0lHTkFMID0ge1xyXG4gIHBvc194OiAwLCBwb3NfeTogMCwgc2l6ZV94OiAyNTYsIHNpemVfeTogMTI4XHJcbn0sXHJcblBBTk5FTF9TUEVDVFJVTSA9IHtcclxuICBwb3NfeDogMjU2LCBwb3NfeTogMCwgc2l6ZV94OiAyNTYsIHNpemVfeTogMTI4XHJcbn0sXHJcblBBTk5FTF9FTkVSR1kgPSB7XHJcbiAgcG9zX3g6IDUxMiwgcG9zX3k6IDAsIHNpemVfeDogMjU2LCBzaXplX3k6IDEyOFxyXG59LFxyXG5QQU5ORUxfTVVMVElCQU5EX0VORVJHSUVTID0ge1xyXG4gIHBvc194OiAwLCBwb3NfeTogMTI4LCBzaXplX3g6IDEwMjQsIHNpemVfeTogMTI1XHJcbn0sXHJcblBBTk5FTF9BTEdPXzEgPSB7XHJcbiAgcG9zX3g6IDAsIHBvc195OiAzMDAsIHNpemVfeDogMTAyNCwgc2l6ZV95OiA0MFxyXG59LFxyXG5QQU5ORUxfQUxHT18yID0ge1xyXG4gIHBvc194OiAwLCBwb3NfeTogMzU3LCBzaXplX3g6IDEwMjQsIHNpemVfeTogNDAwXHJcbn07XHJcblxyXG5cclxuLyoqXHJcbiAqIFByb3ZpZGVzIGEgdmlzdWFsIGd1aWRhbmNlIHRvIHdoYXQgdGhlIGFuYWx5c2lzIGlzIGRvaW5nIFxyXG4gKiBUaGlzIHNob3VsZCBvbmx5IGJlIHVzZWQgaW4gZGV2ZWxvcG1lbnQgc2luY2UgdGhpcyBpcyBvbmx5IFxyXG4gKiBub24tb3B0aW1pemVkIGhlbHBlclxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFuYWx5c2VkRGF0YVZpc3VhbGl6ZXJcclxue1xyXG4gIC8qKiAqL1xyXG4gIGNvbnN0cnVjdG9yKClcclxuICB7XHJcbiAgICB0aGlzLmNhbnZhcyA9IG51bGw7XHJcbiAgICB0aGlzLmNvbnRleHQgPSBudWxsO1xyXG4gICAgdGhpcy5mcmFtZSA9IDA7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkIGEgY2FudmFzIHRvIHRoZSBib2R5XHJcbiAgICogVGhpcyBjYW52YXMgd2lsbCBiZSB1c2VkIGJ5IHRoZSBkcmF3KCkgZnVuY3Rpb25cclxuICAgKi9cclxuICBpbml0KClcclxuICB7XHJcbiAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiY2FudmFzXCIgKTtcclxuICAgIHRoaXMuY2FudmFzLnNldEF0dHJpYnV0ZSggXCJ3aWR0aFwiLCAxMDI1ICk7XHJcbiAgICB0aGlzLmNhbnZhcy5zZXRBdHRyaWJ1dGUoIFwiaGVpZ2h0XCIsIDEwMjQgKTtcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIHRoaXMuY2FudmFzICk7XHJcbiAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCBcIjJkXCIgKTtcclxuICAgIGlmKCBBcHBDb25maWcuc2hvd2xvZ2luZm9zICkgY29uc29sZS5sb2coIGBWaXN1YWxpemVyIGluaXRpYWxpemVkXFxuLS0tLS0tLS0tLS0tYCApO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgbWV0aG9kIG5lZWRzIHRvIGJlIGNhbGxlZCBlYWNoIGZyYW1lIFxyXG4gICAqIEBwYXJhbSB7QXVkaW9BbmFseXNlZERhdGF9IGFuYWx5c2VkRGF0YSBEYXRhIHByb2Nlc3NlZCBieSB0aGUgQXVkaW9BbmFseXNlclxyXG4gICAqIEBwYXJhbSB7Kn0gc3RhcnRUaW1lciBTdGFydCB0aW1lciBvZiB0aGUgdmlzdWFsaXphdGlvblxyXG4gICAqL1xyXG4gIGRyYXcoIGFuYWx5c2VkRGF0YSwgc3RhcnRUaW1lciApXHJcbiAge1xyXG4gICAgdGhpcy5mcmFtZSsrO1xyXG5cclxuICAgIC8vIHdlIGNsZWFyIHRoZSBjYW52YXNcclxuICAgIHRoaXMuY29udGV4dC5jbGVhclJlY3QoIDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQgKTtcclxuICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSBcImJsYWNrXCI7XHJcbiAgICB0aGlzLmNvbnRleHQuZmlsbFJlY3QoIDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQgKTtcclxuXHJcbiAgICB0aGlzLmRyYXdTaWduYWwoIGFuYWx5c2VkRGF0YS5nZXRUaW1lZG9tYWluRGF0YSgpICk7XHJcbiAgICB0aGlzLmRyYXdTcGVjdHJ1bSggYW5hbHlzZWREYXRhLmdldEZyZXF1ZW5jaWVzRGF0YSgpICk7XHJcbiAgICB0aGlzLmRyYXdFbmVyZ3lIaXN0b2dyYW0oIGFuYWx5c2VkRGF0YS5nZXRFbmVyZ3lIaXN0b3J5KCksIGFuYWx5c2VkRGF0YS5nZXRFbmVyZ3lBdmVyYWdlKCkgKTtcclxuICAgIHRoaXMuZHJhd1BlYWtEZXRlY3Rpb24oIGFuYWx5c2VkRGF0YS5wZWFrLCBhbmFseXNlZERhdGEucGVha0hpc3RvcnksIHN0YXJ0VGltZXIgKTtcclxuICAgIHRoaXMuZHJhd011bHRpYmFuZEhpc3RvZ3JhbSggYW5hbHlzZWREYXRhLmdldE11bHRpYmFuZEVuZXJneUhpc3RvcnkoKSApO1xyXG4gICAgdGhpcy5kcmF3TXVsdGliYW5kUGVha0RldGVjdGlvbiggYW5hbHlzZWREYXRhLm11bHRpYmFuZFBlYWssIGFuYWx5c2VkRGF0YS5tdWx0aWJhbmRQZWFrSGlzdG9yeSwgc3RhcnRUaW1lciApO1xyXG5cclxuICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9IFwicmVkXCI7XHJcbiAgICB0aGlzLmNvbnRleHQubGluZVdpZHRoID0gMTtcclxuICAgIHRoaXMuY29udGV4dC5zdHJva2VSZWN0KDAsMCwxMDI0LDEwMjQpO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIERyYXdzIHRoZSBhdWRpbyBzaWduYWwsXHJcbiAgICogdXNpbmcgdGltZSBkb21haW4gZGF0YVxyXG4gICAqIEBwYXJhbSB7VWludDhBcnJheX0gdGltZWRvbWFpbmRhdGFcclxuICAgKi9cclxuICBkcmF3U2lnbmFsKCB0aW1lZG9tYWluZGF0YSApXHJcbiAge1xyXG4gICAgLy8gZmlyc3Qgd2UgZHJhdyB0aGUgaW50ZXJmYWNlXHJcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnd2hpdGUnO1xyXG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZVJlY3QoIFBBTk5FTF9TSUdOQUwucG9zX3grMC41LCBQQU5ORUxfU0lHTkFMLnBvc195KzAuNSwgUEFOTkVMX1NJR05BTC5zaXplX3gsIFBBTk5FTF9TSUdOQUwuc2l6ZV95ICk7XHJcbiAgICB0aGlzLmNvbnRleHQuZm9udCA9ICcxMnB4IEx1Y2lkYSBDb25zb2xlJztcclxuICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAnd2hpdGUnO1xyXG4gICAgdGhpcy5jb250ZXh0LmZpbGxUZXh0KCAnVW5wcm9jZXNzZWQgc2lnbmFsJywgUEFOTkVMX1NJR05BTC5wb3NfeCs1LCBQQU5ORUxfU0lHTkFMLnBvc195ICsgMTMgKTtcclxuXHJcbiAgICAvLyB4IGF4aXNcclxuICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgIHRoaXMuY29udGV4dC5tb3ZlVG8oIFBBTk5FTF9TSUdOQUwucG9zX3gsIFBBTk5FTF9TSUdOQUwucG9zX3kgKyBQQU5ORUxfU0lHTkFMLnNpemVfeS8yICk7XHJcbiAgICB0aGlzLmNvbnRleHQubGluZVRvKCBQQU5ORUxfU0lHTkFMLnBvc194ICsgUEFOTkVMX1NJR05BTC5zaXplX3gsIFBBTk5FTF9TSUdOQUwucG9zX3kgKyBQQU5ORUxfU0lHTkFMLnNpemVfeS8yICk7XHJcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnYmx1ZSc7XHJcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCk7XHJcblxyXG4gICAgLy8gZHJhd2luZyB0aGUgc2lnbmFsXHJcbiAgICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcblxyXG4gICAgbGV0IGFzcGVjdFJhdGlvX3ggPSBQQU5ORUxfU0lHTkFMLnNpemVfeCAvIHRpbWVkb21haW5kYXRhLmxlbmd0aCxcclxuICAgICAgICBhc3BlY3RSYXRpb195ID0gUEFOTkVMX1NJR05BTC5zaXplX3kgLyAyNTY7XHJcbiAgICBcclxuICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGltZWRvbWFpbmRhdGEubGVuZ3RoOyBpKysgKVxyXG4gICAgICB0aGlzLmNvbnRleHQubGluZVRvKCBpICogYXNwZWN0UmF0aW9feCArIFBBTk5FTF9TSUdOQUwucG9zX3gsIChQQU5ORUxfU0lHTkFMLnBvc195K1BBTk5FTF9TSUdOQUwuc2l6ZV95LXRpbWVkb21haW5kYXRhW2ldKmFzcGVjdFJhdGlvX3kpICk7XHJcblxyXG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gJ3doaXRlJztcclxuICAgIHRoaXMuY29udGV4dC5zdHJva2UoKTtcclxuICAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBEcmF3cyB0aGUgZnJlcXVlbmNpZXMgZGF0YVxyXG4gICAqIEBwYXJhbSB7VWludDhBcnJheX0gZnJlcXVlbmN5RGF0YSBcclxuICAgKi9cclxuICBkcmF3U3BlY3RydW0oIGZyZXF1ZW5jeURhdGEgKVxyXG4gIHtcclxuICAgIGxldCBwYW5uZWwgPSBQQU5ORUxfU1BFQ1RSVU07XHJcblxyXG4gICAgLy8gZCdhYm9yZCBvbiBkZXNzaW5lIGwnaW50ZXJmYWNlXHJcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnd2hpdGUnO1xyXG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZVJlY3QoIHBhbm5lbC5wb3NfeCswLjUsIHBhbm5lbC5wb3NfeSswLjUsIHBhbm5lbC5zaXplX3gsIHBhbm5lbC5zaXplX3kgKTtcclxuICAgIHRoaXMuY29udGV4dC5mb250ID0gJzEycHggTHVjaWRhIENvbnNvbGUnO1xyXG4gICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICd3aGl0ZSc7XHJcbiAgICB0aGlzLmNvbnRleHQuZmlsbFRleHQoICdTaWduYWwgc3BlY3RydW0nLCBwYW5uZWwucG9zX3grNSwgcGFubmVsLnBvc195ICsgMTMgKTtcclxuXHJcbiAgICBsZXQgZnJlcVdpZHRoID0gcGFubmVsLnNpemVfeCAvIGZyZXF1ZW5jeURhdGEubGVuZ3RoLFxyXG4gICAgICAgIGhlaWdodFJhdGlvID0gcGFubmVsLnNpemVfeSAvIDI1NTtcclxuXHJcbiAgICBmb3IoIGxldCBpID0gMDsgaSA8IGZyZXF1ZW5jeURhdGEubGVuZ3RoOyBpKysgKVxyXG4gICAge1xyXG4gICAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gYGhzbCgke2kvZnJlcXVlbmN5RGF0YS5sZW5ndGgqMTgwfSwgMTAwJSwgNTAlKWA7XHJcbiAgICAgIHRoaXMuY29udGV4dC5maWxsUmVjdCggcGFubmVsLnBvc194K2ZyZXFXaWR0aCppKzEsIHBhbm5lbC5wb3NfeStwYW5uZWwuc2l6ZV95LWZyZXF1ZW5jeURhdGFbaV0qaGVpZ2h0UmF0aW8sIGZyZXFXaWR0aCwgZnJlcXVlbmN5RGF0YVtpXSpoZWlnaHRSYXRpbyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogRHJhdyB0aGUgZW5lcmd5IGhpc3RvZ3JhbS5cclxuICAgKiBUaGlzIGhpc3RvZ3JhbSBpcyB1c2VkIGJ5IHRoZSBwZWFrIGRldGVjdGlvbiBhbGdvcml0aG1cclxuICAgKiBAcGFyYW0ge0FycmF5fSBlbmVyZ3lIaXN0b3J5IEhpc3Rvcnkgb2YgdGhlIGVuZXJnaWVzXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGVuZXJneUF2ZXJhZ2UgVGhlIGxvY2FsIGF2ZXJhZ2UgZW5lcmd5XHJcbiAgICovXHJcbiAgZHJhd0VuZXJneUhpc3RvZ3JhbSggZW5lcmd5SGlzdG9yeSwgZW5lcmd5QXZlcmFnZSApXHJcbiAge1xyXG4gICAgbGV0IHJlY3QgPSBQQU5ORUxfRU5FUkdZO1xyXG5cclxuICAgIC8vIGZpcnN0IHdlIGRyYXcgdGhlIGludGVyZmFjZVxyXG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gJ3doaXRlJztcclxuICAgIHRoaXMuY29udGV4dC5zdHJva2VSZWN0KCByZWN0LnBvc194KzAuNSwgcmVjdC5wb3NfeSswLjUsIHJlY3Quc2l6ZV94LCByZWN0LnNpemVfeSApO1xyXG4gICAgdGhpcy5jb250ZXh0LmZvbnQgPSAnMTJweCBMdWNpZGEgQ29uc29sZSc7XHJcbiAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JlZCc7XHJcbiAgICB0aGlzLmNvbnRleHQuZmlsbFRleHQoICdNb21lbnQgZW5lcmd5JywgcmVjdC5wb3NfeCs1LCByZWN0LnBvc195ICsgMTMgKTtcclxuICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAnd2hpdGUnO1xyXG4gICAgdGhpcy5jb250ZXh0LmZpbGxUZXh0KCAnb24gc2lnbmFsIGNvbXBhcmVkIHRvJywgcmVjdC5wb3NfeCsxMDcsIHJlY3QucG9zX3kgKyAxMyApO1xyXG4gICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICcjMDBmZjAwJztcclxuICAgIHRoaXMuY29udGV4dC5maWxsVGV4dCggJ2xvY2FsIGF2ZXJhZ2UgZW5lcmd5JywgcmVjdC5wb3NfeCs1LCByZWN0LnBvc195ICsgMjcgKTtcclxuXHJcbiAgICAvLyBhdmVyYWdlIG9mIHRoZSBoaXN0b2dyYW0gXHJcbiAgICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICB0aGlzLmNvbnRleHQubW92ZVRvKCByZWN0LnBvc194K3JlY3Quc2l6ZV94LCByZWN0LnBvc195K3JlY3Quc2l6ZV95IC0gZW5lcmd5QXZlcmFnZSApO1xyXG4gICAgdGhpcy5jb250ZXh0LmxpbmVUbyggcmVjdC5wb3NfeCtyZWN0LnNpemVfeCAtIGVuZXJneUhpc3RvcnkubGVuZ3RoKjIsIHJlY3QucG9zX3krcmVjdC5zaXplX3kgLSBlbmVyZ3lBdmVyYWdlICk7XHJcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnIzAwZmYwMCc7XHJcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCk7XHJcblxyXG4gICAgLy8gd2UgZHJhdyBpdCBcclxuICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgIFxyXG4gICAgZm9yKCBsZXQgaSA9IDA7IGkgPCBlbmVyZ3lIaXN0b3J5Lmxlbmd0aDsgaSsrIClcclxuICAgICAgdGhpcy5jb250ZXh0LmxpbmVUbyggcmVjdC5wb3NfeCtyZWN0LnNpemVfeCAtIGkqMiwgcmVjdC5wb3NfeStyZWN0LnNpemVfeSAtIGVuZXJneUhpc3RvcnlbZW5lcmd5SGlzdG9yeS5sZW5ndGgtaS0xXSApO1xyXG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gJ3JlZCc7XHJcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogRHJhd3MgYSB0aW1lbGluZSB3aXRoIGFsbCB0aGUgZGV0ZWN0ZWQgcGVha3NcclxuICAgKiBAcGFyYW0ge1BlYWt9IHBlYWsgQ3VycmVudCBwZWFrIHVzZWQgdG8gcmVhbC10aW1lIHBlYWsgZGV0ZWN0aW9uXHJcbiAgICogQHBhcmFtIHtBcnJheX0gcGVha0hpc3RvcnkgQXJyYXkgb2YgYWxsIHRoZSBkZXRlY3RlZCBwZWFrc1xyXG4gICAqIEBwYXJhbSB7Kn0gc3RhcnRUaW1lciBBYnNvbHV0ZSB0aW1lciBvZiB0aGUgYmVnaW5uaW5nIG9mIGFuYWx5c2lzXHJcbiAgICovXHJcbiAgZHJhd1BlYWtEZXRlY3Rpb24oIHBlYWssIHBlYWtIaXN0b3J5LCBzdGFydFRpbWVyIClcclxuICB7XHJcbiAgICBsZXQgcmVjdCA9IFBBTk5FTF9BTEdPXzE7XHJcbiAgICAvLyBkJ2Fib3JkIG9uIGRlc3NpbmUgbCdpbnRlcmZhY2VcclxuICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9ICd3aGl0ZSc7XHJcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlUmVjdCggcmVjdC5wb3NfeCswLjUsIHJlY3QucG9zX3krMC41LCByZWN0LnNpemVfeCwgcmVjdC5zaXplX3kgKTtcclxuICAgIHRoaXMuY29udGV4dC5mb250ID0gJzEycHggTHVjaWRhIENvbnNvbGUnO1xyXG4gICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICd3aGl0ZSc7XHJcbiAgICB0aGlzLmNvbnRleHQuZmlsbFRleHQoIGBBTEdPMSAvIHRocmVzaG9sZDogJHtBbmFseXNlckNvbmZpZy5vcHRpb25zLnBlYWtEZXRlY3Rpb24ub3B0aW9ucy50aHJlc2hvbGR9IC8gaWdub3JlVGltZTogJHtBbmFseXNlckNvbmZpZy5vcHRpb25zLnBlYWtEZXRlY3Rpb24ub3B0aW9ucy5pZ25vcmVUaW1lfSAvIHJlc3VsdHM6ICR7cGVha0hpc3RvcnkubGVuZ3RofWAsIHJlY3QucG9zX3grNSwgcmVjdC5wb3NfeSAtIDIgKTtcclxuXHJcbiAgICBcclxuICAgIGZvciggbGV0IGkgPSAwOyBpIDwgcGVha0hpc3RvcnkubGVuZ3RoOyBpKysgKVxyXG4gICAge1xyXG4gICAgICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgIHRoaXMuY29udGV4dC5tb3ZlVG8oIHJlY3QucG9zX3ggKyAocGVha0hpc3RvcnlbaV0udGltZXIgLSBzdGFydFRpbWVyKS8xMDAwKjMsIHJlY3QucG9zX3kgKyByZWN0LnNpemVfeSApO1xyXG4gICAgICB0aGlzLmNvbnRleHQubGluZVRvKCByZWN0LnBvc194ICsgKHBlYWtIaXN0b3J5W2ldLnRpbWVyIC0gc3RhcnRUaW1lcikvMTAwMCozLCByZWN0LnBvc195KzEgKTtcclxuICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gJyMwMGZmMDAnO1xyXG4gICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlKCk7XHJcbiAgICAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBvbiBkZXNzaW5lIGxlIGN1cnNldXIgXCJwbGF5XCIgdml0ZXNzZTogMnB4IC8gc1xyXG4gICAgdGhpcy5jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgdGhpcy5jb250ZXh0Lm1vdmVUbyggcmVjdC5wb3NfeCArIChuZXcgRGF0ZSgpIC0gc3RhcnRUaW1lcikvMTAwMCozLCByZWN0LnBvc195ICsgcmVjdC5zaXplX3kgKTtcclxuICAgIHRoaXMuY29udGV4dC5saW5lVG8oIHJlY3QucG9zX3ggKyAobmV3IERhdGUoKSAtIHN0YXJ0VGltZXIpLzEwMDAqMywgcmVjdC5wb3NfeSsxICk7XHJcbiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAncmVkJztcclxuICAgIHRoaXMuY29udGV4dC5zdHJva2UoKTtcclxuICAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKTtcclxuXHJcbiAgICAvLyBvbiBhIHVuIGJlYXQgXHJcbiAgICBsZXQgYmVhdFBvd2VyID0gcGVhay52YWx1ZTtcclxuICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgIHRoaXMuY29udGV4dC5hcmMoIHJlY3QucG9zX3ggKyByZWN0LnNpemVfeCAtIDIwLCByZWN0LnBvc195ICsgcmVjdC5zaXplX3kgLyAyLCAxMCwgMCAsIDIqTWF0aC5QSSApO1xyXG4gICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9IGByZ2JhKDAsMjU1LDAsJHtiZWF0UG93ZXJ9KWA7XHJcbiAgICB0aGlzLmNvbnRleHQuZmlsbCgpO1xyXG4gICAgdGhpcy5jb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIERyYXdzIHRoZSBoaXN0b3J5IG9mIHRoZSBlbmVyZ3kgb2YgZWFjaCBiYW5kXHJcbiAgICogQHBhcmFtIHtBcnJheX0gZW5lcmdpZXNIaXN0b3J5IGFycmF5IGhpc3Rvcnkgb2YgdGhlIGNvbXB1dGVkIGVuZXJnaWVzIG9mIGVhY2ggYmFuZCBvdmVyIHRpbWVcclxuICAgKi9cclxuICBkcmF3TXVsdGliYW5kSGlzdG9ncmFtKCBlbmVyZ2llc0hpc3RvcnkgKVxyXG4gIHtcclxuICAgIGxldCBwYW5uZWwgPSBQQU5ORUxfTVVMVElCQU5EX0VORVJHSUVTO1xyXG5cclxuICAgIC8vIGludGVyZmFjZVxyXG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gJ3doaXRlJztcclxuICAgIHRoaXMuY29udGV4dC5zdHJva2VSZWN0KCBwYW5uZWwucG9zX3grMC41LCBwYW5uZWwucG9zX3krMC41LCBwYW5uZWwuc2l6ZV94LCBwYW5uZWwuc2l6ZV95ICk7XHJcbiAgICB0aGlzLmNvbnRleHQuZm9udCA9ICcxMnB4IEx1Y2lkYSBDb25zb2xlJztcclxuICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAnd2hpdGUnO1xyXG4gICAgdGhpcy5jb250ZXh0LmZpbGxUZXh0KCBgTXVsdGktYmFuZCBlbmVyZ2llcyBjb21wYXJhaXNvbnM6ICR7QW5hbHlzZXJDb25maWcub3B0aW9ucy5tdWx0aWJhbmRQZWFrRGV0ZWN0aW9uLm9wdGlvbnMuYmFuZHN9IGJhbmRzIC8gJHtBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5lbmVyZ3lQZXJzaXN0ZW5jZX1tcyBlbmVyZ3kgcGVyc2lzdGVuY2UgLyBtYXggMjggb24gc2NyZWVuYCwgcGFubmVsLnBvc194KzUsIHBhbm5lbC5wb3NfeSArIDEzICk7XHJcblxyXG4gICAgbGV0IGJhbmRfaGlzdG9ncmFtX3dpZHRoID0gNjQsXHJcbiAgICAgICAgYmFuZF9oaXN0b2dyYW1faGVpZ2h0ID0gNDgsXHJcbiAgICAgICAgbWFyZ2luPSA1LFxyXG4gICAgICAgIGJhbmRzX3kgPSAxOCxcclxuICAgICAgICBiYW5kc194ID0gbWFyZ2luO1xyXG5cclxuICAgIC8vIHBhcmNvdXJzIGRlcyBiYW5kZXNcclxuICAgIGZvciggbGV0IGJhbmQgPSAwOyAoYmFuZCA8IEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMubXVsdGliYW5kUGVha0RldGVjdGlvbi5vcHRpb25zLmJhbmRzICYmIGJhbmQgPCAyOCk7IGJhbmQrKyApXHJcbiAgICB7XHJcbiAgICAgIC8vIHBhc3NhZ2Ugw6AgbGEgbGlnbmVcclxuICAgICAgaWYoIGJhbmRzX3ggKyBtYXJnaW4gKyBiYW5kX2hpc3RvZ3JhbV93aWR0aCA+IHRoaXMuY2FudmFzLndpZHRoIClcclxuICAgICAge1xyXG4gICAgICAgIGJhbmRzX3ggPSBtYXJnaW47XHJcbiAgICAgICAgYmFuZHNfeSs9IG1hcmdpbitiYW5kX2hpc3RvZ3JhbV9oZWlnaHQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIG9uIGRlc3NpbmUgbGUgY2FkcmUgZGUgbGEgYmFuZGUgXHJcbiAgICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9ICd3aGl0ZSc7XHJcbiAgICAgIHRoaXMuY29udGV4dC5zdHJva2VSZWN0KCBwYW5uZWwucG9zX3ggKyBiYW5kc194ICsgMC41LCBwYW5uZWwucG9zX3kgKyBiYW5kc195ICsgMC41LCBiYW5kX2hpc3RvZ3JhbV93aWR0aCwgYmFuZF9oaXN0b2dyYW1faGVpZ2h0ICk7XHJcbiAgICBcclxuICAgICAgLy8gb24gdmEgc2V1bGVtZW50IHBhcmNvdXJpciB1bmUgdmFsZXVyIHN1ciAyIGRlIGNoYXF1ZSBoaXN0b2dyYW1tZVxyXG4gICAgICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgZW5lcmdpZXNIaXN0b3J5Lmxlbmd0aDsgaSsrIClcclxuICAgICAge1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5saW5lVG8oIHBhbm5lbC5wb3NfeCArIGJhbmRzX3ggKyAwLjUgKyBiYW5kX2hpc3RvZ3JhbV93aWR0aCAtIGkgLyAyLCBwYW5uZWwucG9zX3kgKyBiYW5kc195ICsgYmFuZF9oaXN0b2dyYW1faGVpZ2h0IC0gMC41IC0gZW5lcmdpZXNIaXN0b3J5W2VuZXJnaWVzSGlzdG9yeS5sZW5ndGgtaS0xXVtiYW5kXSAqIGJhbmRfaGlzdG9ncmFtX2hlaWdodCAvIDI1NiApXHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gJ3JlZCc7XHJcbiAgICAgIHRoaXMuY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgdGhpcy5jb250ZXh0LmNsb3NlUGF0aCgpO1xyXG5cclxuICAgICAgaWYoICEoYmFuZHNfeCArIG1hcmdpbiArIGJhbmRfaGlzdG9ncmFtX3dpZHRoID4gdGhpcy5jYW52YXMud2lkdGgpIClcclxuICAgICAge1xyXG4gICAgICAgIGJhbmRzX3grPSBtYXJnaW4rYmFuZF9oaXN0b2dyYW1fd2lkdGg7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBEcmF3cyBhIHZpc3VhbCBndWlkYW5jZSBmb3IgYWxsIHRoZSBiYW5kcyBwZWFrXHJcbiAgICogQHBhcmFtIHtBcnJheX0gcGVha3MgYXJyYXkgb2YgZWFjaCBiYW5kIHBlYWtcclxuICAgKiBAcGFyYW0ge0FycmF5fSBwZWFrc0hpc3RvcnkgYXJyYXkgb2YgZWFjaCBiYW5kIHBlYWtzIGhpc29yeVxyXG4gICAqIEBwYXJhbSB7Kn0gc3RhcnRUaW1lciBhYnNvbHV0ZSB0aW1lciBvZiB0aGUgc3RhcnQgb2YgYW5hbHlzaXNcclxuICAgKi9cclxuICBkcmF3TXVsdGliYW5kUGVha0RldGVjdGlvbiggcGVha3MsIHBlYWtzSGlzdG9yeSwgc3RhcnRUaW1lciApXHJcbiAge1xyXG4gICAgbGV0IHJlY3QgPSBQQU5ORUxfQUxHT18yO1xyXG5cclxuICAgIC8vIGZpcnN0IHdlIGRyYXcgdGhlIGludGVyZmFjZVxyXG4gICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gJ3doaXRlJztcclxuICAgIHRoaXMuY29udGV4dC5zdHJva2VSZWN0KCByZWN0LnBvc194KzAuNSwgcmVjdC5wb3NfeSswLjUsIHJlY3Quc2l6ZV94LCByZWN0LnNpemVfeSApO1xyXG4gICAgdGhpcy5jb250ZXh0LmZvbnQgPSAnMTJweCBMdWNpZGEgQ29uc29sZSc7XHJcbiAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3doaXRlJztcclxuICAgIHRoaXMuY29udGV4dC5maWxsVGV4dCggYEFMR08yIC8gYmFuZHM6ICR7QW5hbHlzZXJDb25maWcub3B0aW9ucy5tdWx0aWJhbmRQZWFrRGV0ZWN0aW9uLm9wdGlvbnMuYmFuZHN9IHRocmVzaG9sZDogJHtBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy50aHJlc2hvbGR9IC8gaWdub3JlVGltZTogJHtBbmFseXNlckNvbmZpZy5vcHRpb25zLm11bHRpYmFuZFBlYWtEZXRlY3Rpb24ub3B0aW9ucy5pZ25vcmVUaW1lfWAsIHJlY3QucG9zX3grNSwgcmVjdC5wb3NfeSAtIDIgKTtcclxuXHJcbiAgICBsZXQgYmFuZF9oZWlnaHQgPSAyMCxcclxuICAgICAgICBtYXJnaW4gPSA1O1xyXG4gICAgbGV0IGN1cnJlbnRUaW1lciA9IG5ldyBEYXRlKCk7XHJcbiAgICBcclxuICAgIGZvciggbGV0IGIgPSAwOyBiIDwgQW5hbHlzZXJDb25maWcub3B0aW9ucy5tdWx0aWJhbmRQZWFrRGV0ZWN0aW9uLm9wdGlvbnMuYmFuZHM7IGIrKyApXHJcbiAgICB7XHJcbiAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgcGVha3NIaXN0b3J5W2JdLmxlbmd0aDsgaSsrIClcclxuICAgICAge1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICB0aGlzLmNvbnRleHQubW92ZVRvKCAxK3JlY3QucG9zX3ggKyBtYXJnaW4gKyAocGVha3NIaXN0b3J5W2JdW2ldLnRpbWVyLXN0YXJ0VGltZXIpLzEwMDAqMywgcmVjdC5wb3NfeSArIGIqYmFuZF9oZWlnaHQgKyBtYXJnaW4qKGIrMSkgKTtcclxuICAgICAgICB0aGlzLmNvbnRleHQubGluZVRvKCAxK3JlY3QucG9zX3ggKyBtYXJnaW4gKyAocGVha3NIaXN0b3J5W2JdW2ldLnRpbWVyLXN0YXJ0VGltZXIpLzEwMDAqMywgcmVjdC5wb3NfeSArIGIqYmFuZF9oZWlnaHQgKyBtYXJnaW4qKGIrMSkgKyBiYW5kX2hlaWdodCApO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9IGBoc2woJHtiL0FuYWx5c2VyQ29uZmlnLm9wdGlvbnMubXVsdGliYW5kUGVha0RldGVjdGlvbi5vcHRpb25zLmJhbmRzKjE4MH0sIDEwMCUsIDUwJSlgO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5zdHJva2UoKTtcclxuICAgICAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIGTDqXRlY3Rpb24gZGUgYmVhdFxyXG4gICAgICBcclxuICAgICAgbGV0IGJlYXRQb3dlciA9IHBlYWtzW2JdLnZhbHVlO1xyXG4gICAgICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgIHRoaXMuY29udGV4dC5hcmMoIHJlY3QucG9zX3ggKyByZWN0LnNpemVfeCAtIDIwLCByZWN0LnBvc195ICsgYipiYW5kX2hlaWdodCArIG1hcmdpbiooYisxKSArIGJhbmRfaGVpZ2h0LzIsIDcsIDAgLCAyKk1hdGguUEkgKTtcclxuICAgICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9IGBoc2woJHtiL0FuYWx5c2VyQ29uZmlnLm9wdGlvbnMubXVsdGliYW5kUGVha0RldGVjdGlvbi5vcHRpb25zLmJhbmRzKjE4MH0sIDEwMCUsICR7YmVhdFBvd2VyKjUwfSUpYDtcclxuICAgICAgdGhpcy5jb250ZXh0LmZpbGwoKTtcclxuICAgICAgdGhpcy5jb250ZXh0LmNsb3NlUGF0aCgpO1xyXG5cclxuICAgICAgLy8gb24gZGVzc2luZSBsZSBjdXJzZXVyIFwicGxheVwiIHZpdGVzc2U6IDJweCAvIHNcclxuICAgICAgdGhpcy5jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICB0aGlzLmNvbnRleHQubW92ZVRvKCAxK21hcmdpbiArIHJlY3QucG9zX3ggKyAoY3VycmVudFRpbWVyIC0gc3RhcnRUaW1lcikvMTAwMCozLCByZWN0LnBvc195ICsgKDErYikqbWFyZ2luICsgYipiYW5kX2hlaWdodCApO1xyXG4gICAgICB0aGlzLmNvbnRleHQubGluZVRvKCAxK21hcmdpbiArIHJlY3QucG9zX3ggKyAoY3VycmVudFRpbWVyIC0gc3RhcnRUaW1lcikvMTAwMCozLCByZWN0LnBvc195ICsgKDErYikqbWFyZ2luICsgKGIrMSkqYmFuZF9oZWlnaHQgKTtcclxuICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gJ3doaXRlJztcclxuICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCk7XHJcblxyXG4gICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnd2hpdGUnO1xyXG4gICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlUmVjdCggcmVjdC5wb3NfeCArIG1hcmdpbiArIDAuNSwgcmVjdC5wb3NfeSArYmFuZF9oZWlnaHQqYiArIChiKzEpKm1hcmdpbiArIDAuNSwgcmVjdC5zaXplX3gtbWFyZ2luKjIsIGJhbmRfaGVpZ2h0ICk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG59O1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvYXVkaW9hbmFseXNpcy91dGlsaXR5L2FuYWx5c2VkLWRhdGEtdmlzdWFsaXplci5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7QUFFQTs7OztBQUlBO0FBRUE7QUFEQTtBQURBO0FBS0E7QUFEQTtBQUpBO0FBUUE7QUFEQTtBQVBBO0FBV0E7QUFEQTtBQVZBO0FBY0E7QUFEQTtBQWJBO0FBaUJBO0FBREE7QUFDQTtBQUlBOzs7Ozs7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBRUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///11\n")},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.HUD = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\n/**\r\n * Handles the elements from the HUD\r\n */\nvar HUD = exports.HUD = function () {\n  function HUD() {\n    var _this = this;\n\n    _classCallCheck(this, HUD);\n\n    this.elements = [];\n    this.show = _app2.default.hudDisplayed;\n\n    document.addEventListener("keydown", function (event) {\n      _this.keyDownEvent(event);\n    });\n  }\n\n  /**\r\n   * Adds an element to the HUD\r\n   * @param {*} element the element MUST implement the method toggle()\r\n   */\n\n\n  _createClass(HUD, [{\n    key: "add",\n    value: function add(element) {\n      this.elements.push(element);\n      element.toggle(this.show);\n    }\n\n    /**\r\n     * \r\n     * @param {KeyboardEvent } event \r\n     */\n\n  }, {\n    key: "keyDownEvent",\n    value: function keyDownEvent(event) {\n      var _this2 = this;\n\n      if (event.key == _app2.default.hudToggleKey) {\n        event.stopPropagation();\n        this.show = !this.show;\n        this.elements.forEach(function (elem) {\n          elem.toggle(_this2.show);\n        });\n      }\n    }\n  }]);\n\n  return HUD;\n}();\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2h1ZC9odWQtY29udHJvbGxlci5qcz83M2VjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBcHBDb25maWcgZnJvbSAnLi4vY29uZmlnL2FwcC5jb25maWcnO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGVzIHRoZSBlbGVtZW50cyBmcm9tIHRoZSBIVURcclxuICovXHJcbmV4cG9ydCBjbGFzcyBIVURcclxue1xyXG4gIGNvbnN0cnVjdG9yKClcclxuICB7XHJcbiAgICB0aGlzLmVsZW1lbnRzID0gW107XHJcbiAgICB0aGlzLnNob3cgPSBBcHBDb25maWcuaHVkRGlzcGxheWVkO1xyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIFwia2V5ZG93blwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgdGhpcy5rZXlEb3duRXZlbnQoZXZlbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkcyBhbiBlbGVtZW50IHRvIHRoZSBIVURcclxuICAgKiBAcGFyYW0geyp9IGVsZW1lbnQgdGhlIGVsZW1lbnQgTVVTVCBpbXBsZW1lbnQgdGhlIG1ldGhvZCB0b2dnbGUoKVxyXG4gICAqL1xyXG4gIGFkZCggZWxlbWVudCApXHJcbiAge1xyXG4gICAgdGhpcy5lbGVtZW50cy5wdXNoKCBlbGVtZW50ICk7XHJcbiAgICBlbGVtZW50LnRvZ2dsZSggdGhpcy5zaG93ICk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogXHJcbiAgICogQHBhcmFtIHtLZXlib2FyZEV2ZW50wqB9IGV2ZW50IFxyXG4gICAqL1xyXG4gIGtleURvd25FdmVudCggZXZlbnQgKVxyXG4gIHtcclxuICAgIGlmKCBldmVudC5rZXkgPT0gQXBwQ29uZmlnLmh1ZFRvZ2dsZUtleSApXHJcbiAgICB7XHJcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICB0aGlzLnNob3cgPSAhdGhpcy5zaG93O1xyXG4gICAgICB0aGlzLmVsZW1lbnRzLmZvckVhY2goIChlbGVtKSA9PiB7XHJcbiAgICAgICAgZWxlbS50b2dnbGUoIHRoaXMuc2hvdyApO1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2h1ZC9odWQtY29udHJvbGxlci5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTs7Ozs7OztBQUVBOzs7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///12\n')},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.Stats = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _statsJs = __webpack_require__(14);\n\nvar _statsJs2 = _interopRequireDefault(_statsJs);\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\n/**\r\n * This class provides an abstraction for controlling stats\r\n */\nvar Stats = exports.Stats = function () {\n  /**\r\n   * @param {number=} position 0: top-left / 1: top-right / 2: bottom-left / 3: bottom-right (optional)\r\n   */\n  function Stats(position) {\n    _classCallCheck(this, Stats);\n\n    if (typeof position == "undefined") position = 0;\n\n    this.stats = new _statsJs2.default();\n    this.stats.domElement.style.position = "absolute";\n\n    switch (position) {\n      case 1:\n        this.stats.domElement.style.right = "0";\n      case 0:\n        this.stats.domElement.style.top = "0";\n        break;\n      case 3:\n        this.stats.domElement.style.right = "0";\n      case 2:\n        this.stats.domElement.style.bottom = "0";\n        break;\n    }\n\n    document.body.appendChild(this.stats.domElement);\n    if (_app2.default.showloginfos) console.log(\'Stats initiliazed\\n------------\');\n  }\n\n  /**\r\n   * hide/show the HUD\r\n   * @param {boolean} show\r\n   */\n\n\n  _createClass(Stats, [{\n    key: \'toggle\',\n    value: function toggle(show) {\n      if (show && this.stats.domElement.hasAttribute("hidden")) this.stats.domElement.removeAttribute("hidden");else if (!show) this.stats.domElement.setAttribute("hidden", true);\n    }\n\n    /**\r\n     * Positions\r\n     */\n\n  }, {\n    key: \'begin\',\n\n\n    /**\r\n     * needs to be called when a stat analysis is desired\r\n     */\n    value: function begin() {\n      this.stats.begin();\n    }\n\n    /**\r\n     * needs to be called when a stat analysis is done\r\n     */\n\n  }, {\n    key: \'end\',\n    value: function end() {\n      this.stats.end();\n    }\n  }], [{\n    key: \'POSITIONS\',\n    get: function get() {\n      return {\n        TOP_LEFT: 0, TOP_RIGHT: 1, BOTTOM_LEFT: 2, BOTTOM_RIGHT: 3\n      };\n    }\n  }]);\n\n  return Stats;\n}();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3Rvb2xzL3N0YXRzLmpzPzE5OGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFN0YXRzSlMgZnJvbSAnc3RhdHMtanMnO1xyXG5pbXBvcnQgQXBwQ29uZmlnIGZyb20gJy4uL2NvbmZpZy9hcHAuY29uZmlnJztcclxuXHJcblxyXG4vKipcclxuICogVGhpcyBjbGFzcyBwcm92aWRlcyBhbiBhYnN0cmFjdGlvbiBmb3IgY29udHJvbGxpbmcgc3RhdHNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBTdGF0c1xyXG57XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtudW1iZXI9fSBwb3NpdGlvbiAwOiB0b3AtbGVmdCAvIDE6IHRvcC1yaWdodCAvIDI6IGJvdHRvbS1sZWZ0IC8gMzogYm90dG9tLXJpZ2h0IChvcHRpb25hbClcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvciggcG9zaXRpb24gKVxyXG4gIHtcclxuICAgIGlmKCB0eXBlb2YocG9zaXRpb24pID09IFwidW5kZWZpbmVkXCIgKVxyXG4gICAgICBwb3NpdGlvbiA9IDA7XHJcbiAgICBcclxuICAgIHRoaXMuc3RhdHMgPSBuZXcgU3RhdHNKUygpO1xyXG4gICAgdGhpcy5zdGF0cy5kb21FbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xyXG5cclxuICAgIHN3aXRjaCggcG9zaXRpb24gKVxyXG4gICAge1xyXG4gICAgICBjYXNlIDE6XHJcbiAgICAgICAgdGhpcy5zdGF0cy5kb21FbGVtZW50LnN0eWxlLnJpZ2h0ID0gXCIwXCI7XHJcbiAgICAgIGNhc2UgMDpcclxuICAgICAgICB0aGlzLnN0YXRzLmRvbUVsZW1lbnQuc3R5bGUudG9wID0gXCIwXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgMzogXHJcbiAgICAgICAgdGhpcy5zdGF0cy5kb21FbGVtZW50LnN0eWxlLnJpZ2h0ID0gXCIwXCI7XHJcbiAgICAgIGNhc2UgMjpcclxuICAgICAgICB0aGlzLnN0YXRzLmRvbUVsZW1lbnQuc3R5bGUuYm90dG9tID0gXCIwXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggdGhpcy5zdGF0cy5kb21FbGVtZW50ICk7XHJcbiAgICBpZiggQXBwQ29uZmlnLnNob3dsb2dpbmZvcyApIGNvbnNvbGUubG9nKGBTdGF0cyBpbml0aWxpYXplZFxcbi0tLS0tLS0tLS0tLWApO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIGhpZGUvc2hvdyB0aGUgSFVEXHJcbiAgICogQHBhcmFtIHtib29sZWFufSBzaG93XHJcbiAgICovXHJcbiAgdG9nZ2xlKCBzaG93IClcclxuICB7XHJcbiAgICBpZiggc2hvdyAmJiB0aGlzLnN0YXRzLmRvbUVsZW1lbnQuaGFzQXR0cmlidXRlKFwiaGlkZGVuXCIpIClcclxuICAgICAgdGhpcy5zdGF0cy5kb21FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImhpZGRlblwiKTtcclxuICAgIGVsc2UgaWYoICFzaG93IClcclxuICAgICAgdGhpcy5zdGF0cy5kb21FbGVtZW50LnNldEF0dHJpYnV0ZShcImhpZGRlblwiLCB0cnVlKTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBQb3NpdGlvbnNcclxuICAgKi9cclxuICBzdGF0aWMgZ2V0IFBPU0lUSU9OUygpXHJcbiAge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgVE9QX0xFRlQ6IDAsIFRPUF9SSUdIVDogMSwgQk9UVE9NX0xFRlQ6IDIsIEJPVFRPTV9SSUdIVDogM1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogbmVlZHMgdG8gYmUgY2FsbGVkIHdoZW4gYSBzdGF0IGFuYWx5c2lzIGlzIGRlc2lyZWRcclxuICAgKi9cclxuICBiZWdpbigpXHJcbiAge1xyXG4gICAgdGhpcy5zdGF0cy5iZWdpbigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogbmVlZHMgdG8gYmUgY2FsbGVkIHdoZW4gYSBzdGF0IGFuYWx5c2lzIGlzIGRvbmVcclxuICAgKi9cclxuICBlbmQoKVxyXG4gIHtcclxuICAgIHRoaXMuc3RhdHMuZW5kKCk7XHJcbiAgfVxyXG59XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy90b29scy9zdGF0cy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQUVBOzs7QUFHQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBQ0E7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUlBO0FBRUE7QUFJQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBVUE7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUlBO0FBQ0E7QUFDQTs7O0FBcEJBO0FBQ0E7QUFDQTtBQURBO0FBR0E7Ozs7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///13\n')},function(module,exports,__webpack_require__){"use strict";eval('/* WEBPACK VAR INJECTION */(function(module) {\n\nvar _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };\n\n// stats.js - http://github.com/mrdoob/stats.js\nvar Stats = function Stats() {\n  var l = Date.now(),\n      m = l,\n      g = 0,\n      n = Infinity,\n      o = 0,\n      h = 0,\n      p = Infinity,\n      q = 0,\n      r = 0,\n      s = 0,\n      f = document.createElement("div");f.id = "stats";f.addEventListener("mousedown", function (b) {\n    b.preventDefault();t(++s % 2);\n  }, !1);f.style.cssText = "width:80px;opacity:0.9;cursor:pointer";var a = document.createElement("div");a.id = "fps";a.style.cssText = "padding:0 0 3px 3px;text-align:left;background-color:#002";f.appendChild(a);var i = document.createElement("div");i.id = "fpsText";i.style.cssText = "color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";\n  i.innerHTML = "FPS";a.appendChild(i);var c = document.createElement("div");c.id = "fpsGraph";c.style.cssText = "position:relative;width:74px;height:30px;background-color:#0ff";for (a.appendChild(c); 74 > c.children.length;) {\n    var j = document.createElement("span");j.style.cssText = "width:1px;height:30px;float:left;background-color:#113";c.appendChild(j);\n  }var d = document.createElement("div");d.id = "ms";d.style.cssText = "padding:0 0 3px 3px;text-align:left;background-color:#020;display:none";f.appendChild(d);var k = document.createElement("div");\n  k.id = "msText";k.style.cssText = "color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";k.innerHTML = "MS";d.appendChild(k);var e = document.createElement("div");e.id = "msGraph";e.style.cssText = "position:relative;width:74px;height:30px;background-color:#0f0";for (d.appendChild(e); 74 > e.children.length;) {\n    j = document.createElement("span"), j.style.cssText = "width:1px;height:30px;float:left;background-color:#131", e.appendChild(j);\n  }var t = function t(b) {\n    s = b;switch (s) {case 0:\n        a.style.display = "block";d.style.display = "none";break;case 1:\n        a.style.display = "none", d.style.display = "block";}\n  };return { REVISION: 12, domElement: f, setMode: t, begin: function begin() {\n      l = Date.now();\n    }, end: function end() {\n      var b = Date.now();g = b - l;n = Math.min(n, g);o = Math.max(o, g);k.textContent = g + " MS (" + n + "-" + o + ")";var a = Math.min(30, 30 - 30 * (g / 200));e.appendChild(e.firstChild).style.height = a + "px";r++;b > m + 1E3 && (h = Math.round(1E3 * r / (b - m)), p = Math.min(p, h), q = Math.max(q, h), i.textContent = h + " FPS (" + p + "-" + q + ")", a = Math.min(30, 30 - 30 * (h / 100)), c.appendChild(c.firstChild).style.height = a + "px", m = b, r = 0);return b;\n    }, update: function update() {\n      l = this.end();\n    } };\n};"object" === ( false ? "undefined" : _typeof(module)) && (module.exports = Stats);\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(15)(module)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL3N0YXRzLWpzL2J1aWxkL3N0YXRzLm1pbi5qcz9jMzVhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHN0YXRzLmpzIC0gaHR0cDovL2dpdGh1Yi5jb20vbXJkb29iL3N0YXRzLmpzXG52YXIgU3RhdHM9ZnVuY3Rpb24oKXt2YXIgbD1EYXRlLm5vdygpLG09bCxnPTAsbj1JbmZpbml0eSxvPTAsaD0wLHA9SW5maW5pdHkscT0wLHI9MCxzPTAsZj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2YuaWQ9XCJzdGF0c1wiO2YuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLGZ1bmN0aW9uKGIpe2IucHJldmVudERlZmF1bHQoKTt0KCsrcyUyKX0sITEpO2Yuc3R5bGUuY3NzVGV4dD1cIndpZHRoOjgwcHg7b3BhY2l0eTowLjk7Y3Vyc29yOnBvaW50ZXJcIjt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2EuaWQ9XCJmcHNcIjthLnN0eWxlLmNzc1RleHQ9XCJwYWRkaW5nOjAgMCAzcHggM3B4O3RleHQtYWxpZ246bGVmdDtiYWNrZ3JvdW5kLWNvbG9yOiMwMDJcIjtmLmFwcGVuZENoaWxkKGEpO3ZhciBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7aS5pZD1cImZwc1RleHRcIjtpLnN0eWxlLmNzc1RleHQ9XCJjb2xvcjojMGZmO2ZvbnQtZmFtaWx5OkhlbHZldGljYSxBcmlhbCxzYW5zLXNlcmlmO2ZvbnQtc2l6ZTo5cHg7Zm9udC13ZWlnaHQ6Ym9sZDtsaW5lLWhlaWdodDoxNXB4XCI7XG5pLmlubmVySFRNTD1cIkZQU1wiO2EuYXBwZW5kQ2hpbGQoaSk7dmFyIGM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtjLmlkPVwiZnBzR3JhcGhcIjtjLnN0eWxlLmNzc1RleHQ9XCJwb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDo3NHB4O2hlaWdodDozMHB4O2JhY2tncm91bmQtY29sb3I6IzBmZlwiO2ZvcihhLmFwcGVuZENoaWxkKGMpOzc0PmMuY2hpbGRyZW4ubGVuZ3RoOyl7dmFyIGo9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7ai5zdHlsZS5jc3NUZXh0PVwid2lkdGg6MXB4O2hlaWdodDozMHB4O2Zsb2F0OmxlZnQ7YmFja2dyb3VuZC1jb2xvcjojMTEzXCI7Yy5hcHBlbmRDaGlsZChqKX12YXIgZD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2QuaWQ9XCJtc1wiO2Quc3R5bGUuY3NzVGV4dD1cInBhZGRpbmc6MCAwIDNweCAzcHg7dGV4dC1hbGlnbjpsZWZ0O2JhY2tncm91bmQtY29sb3I6IzAyMDtkaXNwbGF5Om5vbmVcIjtmLmFwcGVuZENoaWxkKGQpO3ZhciBrPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5rLmlkPVwibXNUZXh0XCI7ay5zdHlsZS5jc3NUZXh0PVwiY29sb3I6IzBmMDtmb250LWZhbWlseTpIZWx2ZXRpY2EsQXJpYWwsc2Fucy1zZXJpZjtmb250LXNpemU6OXB4O2ZvbnQtd2VpZ2h0OmJvbGQ7bGluZS1oZWlnaHQ6MTVweFwiO2suaW5uZXJIVE1MPVwiTVNcIjtkLmFwcGVuZENoaWxkKGspO3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7ZS5pZD1cIm1zR3JhcGhcIjtlLnN0eWxlLmNzc1RleHQ9XCJwb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDo3NHB4O2hlaWdodDozMHB4O2JhY2tncm91bmQtY29sb3I6IzBmMFwiO2ZvcihkLmFwcGVuZENoaWxkKGUpOzc0PmUuY2hpbGRyZW4ubGVuZ3RoOylqPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLGouc3R5bGUuY3NzVGV4dD1cIndpZHRoOjFweDtoZWlnaHQ6MzBweDtmbG9hdDpsZWZ0O2JhY2tncm91bmQtY29sb3I6IzEzMVwiLGUuYXBwZW5kQ2hpbGQoaik7dmFyIHQ9ZnVuY3Rpb24oYil7cz1iO3N3aXRjaChzKXtjYXNlIDA6YS5zdHlsZS5kaXNwbGF5PVxuXCJibG9ja1wiO2Quc3R5bGUuZGlzcGxheT1cIm5vbmVcIjticmVhaztjYXNlIDE6YS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiLGQuc3R5bGUuZGlzcGxheT1cImJsb2NrXCJ9fTtyZXR1cm57UkVWSVNJT046MTIsZG9tRWxlbWVudDpmLHNldE1vZGU6dCxiZWdpbjpmdW5jdGlvbigpe2w9RGF0ZS5ub3coKX0sZW5kOmZ1bmN0aW9uKCl7dmFyIGI9RGF0ZS5ub3coKTtnPWItbDtuPU1hdGgubWluKG4sZyk7bz1NYXRoLm1heChvLGcpO2sudGV4dENvbnRlbnQ9ZytcIiBNUyAoXCIrbitcIi1cIitvK1wiKVwiO3ZhciBhPU1hdGgubWluKDMwLDMwLTMwKihnLzIwMCkpO2UuYXBwZW5kQ2hpbGQoZS5maXJzdENoaWxkKS5zdHlsZS5oZWlnaHQ9YStcInB4XCI7cisrO2I+bSsxRTMmJihoPU1hdGgucm91bmQoMUUzKnIvKGItbSkpLHA9TWF0aC5taW4ocCxoKSxxPU1hdGgubWF4KHEsaCksaS50ZXh0Q29udGVudD1oK1wiIEZQUyAoXCIrcCtcIi1cIitxK1wiKVwiLGE9TWF0aC5taW4oMzAsMzAtMzAqKGgvMTAwKSksYy5hcHBlbmRDaGlsZChjLmZpcnN0Q2hpbGQpLnN0eWxlLmhlaWdodD1cbmErXCJweFwiLG09YixyPTApO3JldHVybiBifSx1cGRhdGU6ZnVuY3Rpb24oKXtsPXRoaXMuZW5kKCl9fX07XCJvYmplY3RcIj09PXR5cGVvZiBtb2R1bGUmJihtb2R1bGUuZXhwb3J0cz1TdGF0cyk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbm9kZV9tb2R1bGVzL3N0YXRzLWpzL2J1aWxkL3N0YXRzLm1pbi5qcyJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///14\n')},function(module,exports,__webpack_require__){"use strict";eval('\n\nmodule.exports = function (module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function () {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, "loaded", {\n\t\t\tenumerable: true,\n\t\t\tget: function get() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, "id", {\n\t\t\tenumerable: true,\n\t\t\tget: function get() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL3dlYnBhY2svYnVpbGRpbi9tb2R1bGUuanM/ZWY1MSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xyXG5cdGlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XHJcblx0XHRtb2R1bGUuZGVwcmVjYXRlID0gZnVuY3Rpb24oKSB7fTtcclxuXHRcdG1vZHVsZS5wYXRocyA9IFtdO1xyXG5cdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XHJcblx0XHRpZighbW9kdWxlLmNoaWxkcmVuKSBtb2R1bGUuY2hpbGRyZW4gPSBbXTtcclxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsIFwibG9hZGVkXCIsIHtcclxuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcclxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmw7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJpZFwiLCB7XHJcblx0XHRcdGVudW1lcmFibGU6IHRydWUsXHJcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0cmV0dXJuIG1vZHVsZS5pO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xyXG5cdH1cclxuXHRyZXR1cm4gbW9kdWxlO1xyXG59O1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbm9kZV9tb2R1bGVzL3dlYnBhY2svYnVpbGRpbi9tb2R1bGUuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///15\n')},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.GUI = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _dat = __webpack_require__(17);\n\nvar _dat2 = _interopRequireDefault(_dat);\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\n/**\r\n * This class provides an abstraction for a GUI utilisation\r\n */\nvar GUI = exports.GUI = function () {\n  /**\r\n   * @param {boolean=} closed If the GUI is closed or not (optional)\r\n   */\n  function GUI(controls, closed) {\n    _classCallCheck(this, GUI);\n\n    this.gui = new _dat2.default.GUI();\n    this.controllers = {};\n\n    this.parseControls(this.gui, controls);\n\n    if (closed === true) this.gui.close();\n\n    if (_app2.default.showloginfos) console.log(\'UI controls initialiazed\\n------------\');\n  }\n\n  /**\r\n   * hide/show the HUD\r\n   * @param {boolean} show\r\n   */\n\n\n  _createClass(GUI, [{\n    key: \'toggle\',\n    value: function toggle(show) {\n      if (show && this.gui.domElement.hasAttribute("hidden")) this.gui.domElement.removeAttribute("hidden");else if (!show) this.gui.domElement.setAttribute("hidden", true);\n    }\n\n    /**\r\n     * Parse the controls, from user-controls, to set up the dat.gui\r\n     */\n\n  }, {\n    key: \'parseControls\',\n    value: function parseControls(gui, controls) {\n      var _this = this;\n\n      controls.forEach(function (control) {\n\n        // first case, it\'s a folder\n        if (Array.isArray(control) && typeof control[0] === "string") {\n          var copy = control.slice(0);\n          copy.shift();\n          _this.controllers[control[0]] = gui.addFolder(control[0]);\n          _this.parseControls(_this.controllers[control[0]], copy);\n        } else if (control.type === "color") // it\'s a color\n          {\n            _this.controllers[control.property] = gui.addColor(control.object, control.property);\n            if (typeof control.callback != "undefined") _this.controllers[control.property].onFinishChange(control.callback);\n          } else if (typeof control.object[control.property] === "string" || typeof control.object[control.property] === "boolean") // it\'s a string or a string, same logic\n          {\n            _this.controllers[control.property] = gui.add(control.object, control.property);\n            if (typeof control.callback != "undefined") _this.controllers[control.property].onFinishChange(control.callback);\n          } else // it\'s a number property \n          {\n            var properties = Object.assign({ min: 0, max: 100, step: 1 }, control);\n            _this.controllers[control.property] = gui.add(control.object, control.property, properties.min, properties.max, properties.step);\n            if (typeof properties.callback != "undefined") _this.controllers[control.property].onFinishChange(properties.callback);\n          }\n      });\n    }\n\n    /**\r\n     * Adds a new controller to the GUI\r\n     * @param {string} id Unique string identifier to the property\r\n     * @param {Object} object Object containing the property value\r\n     * @param {string} property Property of the object\r\n     * @param {number} min\r\n     * @param {number} max \r\n     * @param {number} step \r\n     * @param {*=} callbackOnChanged Callback function on changed value\r\n     */\n\n  }, {\n    key: \'add\',\n    value: function add(id, object, property, min, max, step, callbackOnChanged) {\n      var controller = this.gui.add(object, property, min, max);\n      controller.step(step);\n      if (typeof callbackOnChanged != "undefined") controller.onFinishChange(callbackOnChanged);\n      this.controllers[id] = controller;\n    }\n\n    /**\r\n     * Adds a folder to the GUI\r\n     * @param {string} id Unique string identifier to the folder\r\n     * @param {string} name Name displayed\r\n     */\n\n  }, {\n    key: \'addFolder\',\n    value: function addFolder(id, name) {\n      this.controllers[id] = this.gui.addFolder(name);\n    }\n\n    /**\r\n     * Adds a new controller to the folder\r\n     * @param {string} folderId Unique id of the folder\r\n     * @param {string} id Unique string identifier to the property\r\n     * @param {Object} object Object containing the property value\r\n     * @param {string} property Property of the object\r\n     * @param {number} min\r\n     * @param {number} max \r\n     * @param {number} step \r\n     * @param {*=} callbackOnChanged Callback function on changed value\r\n     */\n\n  }, {\n    key: \'addToFolder\',\n    value: function addToFolder(folderId, id, object, property, min, max, step, callbackOnChanged) {\n      var controller = this.controllers[folderId].add(object, property, min, max);\n      controller.step(step);\n      if (typeof callbackOnChanged != "undefined") controller.onFinishChange(callbackOnChanged);\n      this.controllers[id] = controller;\n    }\n\n    /**\r\n     * Add a color controller to the GUI\r\n     * @param {string} id Unique ID for the color\r\n     * @param {Object} object Object containing the property value\r\n     * @param {string} property The property that will handle the value\r\n     */\n\n  }, {\n    key: \'addColor\',\n    value: function addColor(id, object, property) {\n      this.controllers[id] = this.gui.addColor(object, property);\n    }\n\n    /**\r\n     * Add a color controller to the GUI\r\n     * @param {string} folderId Unique id of the folder\r\n     * @param {string} id Unique ID for the color\r\n     * @param {Object} object Object containing the property value\r\n     * @param {string} property The property that will handle the value\r\n     */\n\n  }, {\n    key: \'addColorToFolder\',\n    value: function addColorToFolder(folderId, id, object, property) {\n      this.controllers[id] = this.controllers[folderID].addColor(object, property);\n    }\n  }]);\n\n  return GUI;\n}();\n\n;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3Rvb2xzL2d1aS5qcz83OTI5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkYXQgZnJvbSAnZGF0Lmd1aSc7XHJcbmltcG9ydCBBcHBDb25maWcgZnJvbSAnLi4vY29uZmlnL2FwcC5jb25maWcnO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGFuIGFic3RyYWN0aW9uIGZvciBhIEdVSSB1dGlsaXNhdGlvblxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEdVSVxyXG57XHJcbiAgLyoqXHJcbiAgICogQHBhcmFtIHtib29sZWFuPX0gY2xvc2VkIElmIHRoZSBHVUkgaXMgY2xvc2VkIG9yIG5vdCAob3B0aW9uYWwpXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoIGNvbnRyb2xzLCBjbG9zZWQgKVxyXG4gIHtcclxuICAgIHRoaXMuZ3VpID0gbmV3IGRhdC5HVUkoKTtcclxuICAgIHRoaXMuY29udHJvbGxlcnMgPSB7fTtcclxuXHJcbiAgICB0aGlzLnBhcnNlQ29udHJvbHMoIHRoaXMuZ3VpLCBjb250cm9scyApO1xyXG5cclxuICAgIGlmKCBjbG9zZWQgPT09IHRydWUgKVxyXG4gICAgICB0aGlzLmd1aS5jbG9zZSgpO1xyXG5cclxuICAgIGlmKCBBcHBDb25maWcuc2hvd2xvZ2luZm9zICkgY29uc29sZS5sb2coYFVJIGNvbnRyb2xzIGluaXRpYWxpYXplZFxcbi0tLS0tLS0tLS0tLWApO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIGhpZGUvc2hvdyB0aGUgSFVEXHJcbiAgICogQHBhcmFtIHtib29sZWFufSBzaG93XHJcbiAgICovXHJcbiAgdG9nZ2xlKCBzaG93IClcclxuICB7XHJcbiAgICBpZiggc2hvdyAmJiB0aGlzLmd1aS5kb21FbGVtZW50Lmhhc0F0dHJpYnV0ZShcImhpZGRlblwiKSApXHJcbiAgICAgIHRoaXMuZ3VpLmRvbUVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiaGlkZGVuXCIpO1xyXG4gICAgZWxzZSBpZiggIXNob3cgKVxyXG4gICAgICB0aGlzLmd1aS5kb21FbGVtZW50LnNldEF0dHJpYnV0ZShcImhpZGRlblwiLCB0cnVlKTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBQYXJzZSB0aGUgY29udHJvbHMsIGZyb20gdXNlci1jb250cm9scywgdG8gc2V0IHVwIHRoZSBkYXQuZ3VpXHJcbiAgICovXHJcbiAgcGFyc2VDb250cm9scyggZ3VpLCBjb250cm9scyApXHJcbiAge1xyXG4gICAgY29udHJvbHMuZm9yRWFjaCggKGNvbnRyb2wpID0+IHtcclxuXHJcbiAgICAgIC8vIGZpcnN0IGNhc2UsIGl0J3MgYSBmb2xkZXJcclxuICAgICAgaWYoIEFycmF5LmlzQXJyYXkoY29udHJvbCkgJiYgdHlwZW9mIGNvbnRyb2xbMF0gPT09IFwic3RyaW5nXCIgKVxyXG4gICAgICB7XHJcbiAgICAgICAgbGV0IGNvcHkgPSBjb250cm9sLnNsaWNlKDApO1xyXG4gICAgICAgIGNvcHkuc2hpZnQoKTtcclxuICAgICAgICB0aGlzLmNvbnRyb2xsZXJzW2NvbnRyb2xbMF1dID0gZ3VpLmFkZEZvbGRlcihjb250cm9sWzBdKTtcclxuICAgICAgICB0aGlzLnBhcnNlQ29udHJvbHMoIHRoaXMuY29udHJvbGxlcnNbY29udHJvbFswXV0sIGNvcHkgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSBpZiggY29udHJvbC50eXBlID09PSBcImNvbG9yXCIgKSAvLyBpdCdzIGEgY29sb3JcclxuICAgICAge1xyXG4gICAgICAgIHRoaXMuY29udHJvbGxlcnNbY29udHJvbC5wcm9wZXJ0eV0gPSBndWkuYWRkQ29sb3IoIGNvbnRyb2wub2JqZWN0LCBjb250cm9sLnByb3BlcnR5ICk7XHJcbiAgICAgICAgaWYoIHR5cGVvZiBjb250cm9sLmNhbGxiYWNrICE9IFwidW5kZWZpbmVkXCIgKVxyXG4gICAgICAgICAgdGhpcy5jb250cm9sbGVyc1tjb250cm9sLnByb3BlcnR5XS5vbkZpbmlzaENoYW5nZSggY29udHJvbC5jYWxsYmFjayApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBlbHNlIGlmKCB0eXBlb2YgY29udHJvbC5vYmplY3RbY29udHJvbC5wcm9wZXJ0eV0gPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGNvbnRyb2wub2JqZWN0W2NvbnRyb2wucHJvcGVydHldID09PSBcImJvb2xlYW5cIiApIC8vIGl0J3MgYSBzdHJpbmcgb3IgYSBzdHJpbmcsIHNhbWUgbG9naWNcclxuICAgICAge1xyXG4gICAgICAgIHRoaXMuY29udHJvbGxlcnNbY29udHJvbC5wcm9wZXJ0eV0gPSBndWkuYWRkKCBjb250cm9sLm9iamVjdCwgY29udHJvbC5wcm9wZXJ0eSApO1xyXG4gICAgICAgIGlmKCB0eXBlb2YgY29udHJvbC5jYWxsYmFjayAhPSBcInVuZGVmaW5lZFwiIClcclxuICAgICAgICAgIHRoaXMuY29udHJvbGxlcnNbY29udHJvbC5wcm9wZXJ0eV0ub25GaW5pc2hDaGFuZ2UoIGNvbnRyb2wuY2FsbGJhY2sgKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgZWxzZSAvLyBpdCdzIGEgbnVtYmVyIHByb3BlcnR5IFxyXG4gICAgICB7XHJcbiAgICAgICAgbGV0IHByb3BlcnRpZXMgPSBPYmplY3QuYXNzaWduKHsgbWluOiAwLCBtYXg6IDEwMCwgc3RlcDogMX0sIGNvbnRyb2wpO1xyXG4gICAgICAgIHRoaXMuY29udHJvbGxlcnNbY29udHJvbC5wcm9wZXJ0eV0gPSBndWkuYWRkKCBjb250cm9sLm9iamVjdCwgY29udHJvbC5wcm9wZXJ0eSwgcHJvcGVydGllcy5taW4sIHByb3BlcnRpZXMubWF4LCBwcm9wZXJ0aWVzLnN0ZXAgKTtcclxuICAgICAgICBpZiggdHlwZW9mIHByb3BlcnRpZXMuY2FsbGJhY2sgIT0gXCJ1bmRlZmluZWRcIiApXHJcbiAgICAgICAgICB0aGlzLmNvbnRyb2xsZXJzW2NvbnRyb2wucHJvcGVydHldLm9uRmluaXNoQ2hhbmdlKCBwcm9wZXJ0aWVzLmNhbGxiYWNrICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBBZGRzIGEgbmV3IGNvbnRyb2xsZXIgdG8gdGhlIEdVSVxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBVbmlxdWUgc3RyaW5nIGlkZW50aWZpZXIgdG8gdGhlIHByb3BlcnR5XHJcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBPYmplY3QgY29udGFpbmluZyB0aGUgcHJvcGVydHkgdmFsdWVcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHkgUHJvcGVydHkgb2YgdGhlIG9iamVjdFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtaW5cclxuICAgKiBAcGFyYW0ge251bWJlcn0gbWF4IFxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwIFxyXG4gICAqIEBwYXJhbSB7Kj19IGNhbGxiYWNrT25DaGFuZ2VkIENhbGxiYWNrIGZ1bmN0aW9uIG9uIGNoYW5nZWQgdmFsdWVcclxuICAgKi9cclxuICBhZGQoIGlkLCBvYmplY3QsIHByb3BlcnR5LCBtaW4sIG1heCwgc3RlcCwgY2FsbGJhY2tPbkNoYW5nZWQgKVxyXG4gIHtcclxuICAgIGxldCBjb250cm9sbGVyID0gdGhpcy5ndWkuYWRkKCBvYmplY3QsIHByb3BlcnR5LCBtaW4sIG1heCApO1xyXG4gICAgY29udHJvbGxlci5zdGVwKCBzdGVwICk7XHJcbiAgICBpZiggdHlwZW9mKGNhbGxiYWNrT25DaGFuZ2VkKSAhPSBcInVuZGVmaW5lZFwiIClcclxuICAgICAgY29udHJvbGxlci5vbkZpbmlzaENoYW5nZSggY2FsbGJhY2tPbkNoYW5nZWQgKTtcclxuICAgIHRoaXMuY29udHJvbGxlcnNbaWRdID0gY29udHJvbGxlcjtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBBZGRzIGEgZm9sZGVyIHRvIHRoZSBHVUlcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgVW5pcXVlIHN0cmluZyBpZGVudGlmaWVyIHRvIHRoZSBmb2xkZXJcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBOYW1lIGRpc3BsYXllZFxyXG4gICAqL1xyXG4gIGFkZEZvbGRlciggaWQsIG5hbWUgKVxyXG4gIHtcclxuICAgIHRoaXMuY29udHJvbGxlcnNbaWRdID0gdGhpcy5ndWkuYWRkRm9sZGVyKG5hbWUpO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgYSBuZXcgY29udHJvbGxlciB0byB0aGUgZm9sZGVyXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZvbGRlcklkIFVuaXF1ZSBpZCBvZiB0aGUgZm9sZGVyXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGlkIFVuaXF1ZSBzdHJpbmcgaWRlbnRpZmllciB0byB0aGUgcHJvcGVydHlcclxuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IE9iamVjdCBjb250YWluaW5nIHRoZSBwcm9wZXJ0eSB2YWx1ZVxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eSBQcm9wZXJ0eSBvZiB0aGUgb2JqZWN0XHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IG1pblxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBtYXggXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHN0ZXAgXHJcbiAgICogQHBhcmFtIHsqPX0gY2FsbGJhY2tPbkNoYW5nZWQgQ2FsbGJhY2sgZnVuY3Rpb24gb24gY2hhbmdlZCB2YWx1ZVxyXG4gICAqL1xyXG4gIGFkZFRvRm9sZGVyKCBmb2xkZXJJZCwgaWQsIG9iamVjdCwgcHJvcGVydHksIG1pbiwgbWF4LCBzdGVwLCBjYWxsYmFja09uQ2hhbmdlZCApXHJcbiAge1xyXG4gICAgbGV0IGNvbnRyb2xsZXIgPSB0aGlzLmNvbnRyb2xsZXJzW2ZvbGRlcklkXS5hZGQoIG9iamVjdCwgcHJvcGVydHksIG1pbiwgbWF4ICk7XHJcbiAgICBjb250cm9sbGVyLnN0ZXAoIHN0ZXAgKTtcclxuICAgIGlmKCB0eXBlb2YoY2FsbGJhY2tPbkNoYW5nZWQpICE9IFwidW5kZWZpbmVkXCIgKVxyXG4gICAgICBjb250cm9sbGVyLm9uRmluaXNoQ2hhbmdlKCBjYWxsYmFja09uQ2hhbmdlZCApO1xyXG4gICAgdGhpcy5jb250cm9sbGVyc1tpZF0gPSBjb250cm9sbGVyO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZCBhIGNvbG9yIGNvbnRyb2xsZXIgdG8gdGhlIEdVSVxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBVbmlxdWUgSUQgZm9yIHRoZSBjb2xvclxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IGNvbnRhaW5pbmcgdGhlIHByb3BlcnR5IHZhbHVlXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5IFRoZSBwcm9wZXJ0eSB0aGF0IHdpbGwgaGFuZGxlIHRoZSB2YWx1ZVxyXG4gICAqL1xyXG4gIGFkZENvbG9yKCBpZCwgb2JqZWN0LCBwcm9wZXJ0eSApXHJcbiAge1xyXG4gICAgdGhpcy5jb250cm9sbGVyc1tpZF0gPSB0aGlzLmd1aS5hZGRDb2xvciggb2JqZWN0LCBwcm9wZXJ0eSApO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZCBhIGNvbG9yIGNvbnRyb2xsZXIgdG8gdGhlIEdVSVxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmb2xkZXJJZCBVbmlxdWUgaWQgb2YgdGhlIGZvbGRlclxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBVbmlxdWUgSUQgZm9yIHRoZSBjb2xvclxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IGNvbnRhaW5pbmcgdGhlIHByb3BlcnR5IHZhbHVlXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5IFRoZSBwcm9wZXJ0eSB0aGF0IHdpbGwgaGFuZGxlIHRoZSB2YWx1ZVxyXG4gICAqL1xyXG4gIGFkZENvbG9yVG9Gb2xkZXIoIGZvbGRlcklkLCBpZCwgb2JqZWN0LCBwcm9wZXJ0eSApXHJcbiAge1xyXG4gICAgdGhpcy5jb250cm9sbGVyc1tpZF0gPSB0aGlzLmNvbnRyb2xsZXJzW2ZvbGRlcklEXS5hZGRDb2xvciggb2JqZWN0LCBwcm9wZXJ0eSApO1xyXG4gIH1cclxuICBcclxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL3Rvb2xzL2d1aS5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQUVBOzs7QUFHQTtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUlBO0FBRUE7QUFJQTtBQUNBO0FBRUE7Ozs7OztBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7Ozs7QUFVQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7OztBQUtBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7Ozs7O0FBV0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQU9BO0FBRUE7QUFDQTs7Ozs7O0FBRUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///16\n')},function(module,exports,__webpack_require__){"use strict";eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;\n\nvar _typeof2 = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n(function (global, factory) {\n  ( false ? 'undefined' : _typeof2(exports)) === 'object' && typeof module !== 'undefined' ? module.exports = factory() :  true ? !(__WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) : global.dat = factory();\n})(undefined, function () {\n  'use strict';\n\n  function ___$insertStyle(css) {\n    if (!css) {\n      return;\n    }\n    if (typeof window === 'undefined') {\n      return;\n    }\n\n    var style = document.createElement('style');\n\n    style.setAttribute('type', 'text/css');\n    style.innerHTML = css;\n    document.head.appendChild(style);\n\n    return css;\n  }\n\n  function colorToString(color, forceCSSHex) {\n    var colorFormat = color.__state.conversionName.toString();\n    var r = Math.round(color.r);\n    var g = Math.round(color.g);\n    var b = Math.round(color.b);\n    var a = color.a;\n    var h = Math.round(color.h);\n    var s = color.s.toFixed(1);\n    var v = color.v.toFixed(1);\n    if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {\n      var str = color.hex.toString(16);\n      while (str.length < 6) {\n        str = '0' + str;\n      }\n      return '#' + str;\n    } else if (colorFormat === 'CSS_RGB') {\n      return 'rgb(' + r + ',' + g + ',' + b + ')';\n    } else if (colorFormat === 'CSS_RGBA') {\n      return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n    } else if (colorFormat === 'HEX') {\n      return '0x' + color.hex.toString(16);\n    } else if (colorFormat === 'RGB_ARRAY') {\n      return '[' + r + ',' + g + ',' + b + ']';\n    } else if (colorFormat === 'RGBA_ARRAY') {\n      return '[' + r + ',' + g + ',' + b + ',' + a + ']';\n    } else if (colorFormat === 'RGB_OBJ') {\n      return '{r:' + r + ',g:' + g + ',b:' + b + '}';\n    } else if (colorFormat === 'RGBA_OBJ') {\n      return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\n    } else if (colorFormat === 'HSV_OBJ') {\n      return '{h:' + h + ',s:' + s + ',v:' + v + '}';\n    } else if (colorFormat === 'HSVA_OBJ') {\n      return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\n    }\n    return 'unknown format';\n  }\n\n  var ARR_EACH = Array.prototype.forEach;\n  var ARR_SLICE = Array.prototype.slice;\n  var Common = {\n    BREAK: {},\n    extend: function extend(target) {\n      this.each(ARR_SLICE.call(arguments, 1), function (obj) {\n        var keys = this.isObject(obj) ? Object.keys(obj) : [];\n        keys.forEach(function (key) {\n          if (!this.isUndefined(obj[key])) {\n            target[key] = obj[key];\n          }\n        }.bind(this));\n      }, this);\n      return target;\n    },\n    defaults: function defaults(target) {\n      this.each(ARR_SLICE.call(arguments, 1), function (obj) {\n        var keys = this.isObject(obj) ? Object.keys(obj) : [];\n        keys.forEach(function (key) {\n          if (this.isUndefined(target[key])) {\n            target[key] = obj[key];\n          }\n        }.bind(this));\n      }, this);\n      return target;\n    },\n    compose: function compose() {\n      var toCall = ARR_SLICE.call(arguments);\n      return function () {\n        var args = ARR_SLICE.call(arguments);\n        for (var i = toCall.length - 1; i >= 0; i--) {\n          args = [toCall[i].apply(this, args)];\n        }\n        return args[0];\n      };\n    },\n    each: function each(obj, itr, scope) {\n      if (!obj) {\n        return;\n      }\n      if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\n        obj.forEach(itr, scope);\n      } else if (obj.length === obj.length + 0) {\n        var key = void 0;\n        var l = void 0;\n        for (key = 0, l = obj.length; key < l; key++) {\n          if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\n            return;\n          }\n        }\n      } else {\n        for (var _key in obj) {\n          if (itr.call(scope, obj[_key], _key) === this.BREAK) {\n            return;\n          }\n        }\n      }\n    },\n    defer: function defer(fnc) {\n      setTimeout(fnc, 0);\n    },\n    debounce: function debounce(func, threshold, callImmediately) {\n      var timeout = void 0;\n      return function () {\n        var obj = this;\n        var args = arguments;\n        function delayed() {\n          timeout = null;\n          if (!callImmediately) func.apply(obj, args);\n        }\n        var callNow = callImmediately || !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(delayed, threshold);\n        if (callNow) {\n          func.apply(obj, args);\n        }\n      };\n    },\n    toArray: function toArray(obj) {\n      if (obj.toArray) return obj.toArray();\n      return ARR_SLICE.call(obj);\n    },\n    isUndefined: function isUndefined(obj) {\n      return obj === undefined;\n    },\n    isNull: function isNull(obj) {\n      return obj === null;\n    },\n    isNaN: function (_isNaN) {\n      function isNaN(_x) {\n        return _isNaN.apply(this, arguments);\n      }\n      isNaN.toString = function () {\n        return _isNaN.toString();\n      };\n      return isNaN;\n    }(function (obj) {\n      return isNaN(obj);\n    }),\n    isArray: Array.isArray || function (obj) {\n      return obj.constructor === Array;\n    },\n    isObject: function isObject(obj) {\n      return obj === Object(obj);\n    },\n    isNumber: function isNumber(obj) {\n      return obj === obj + 0;\n    },\n    isString: function isString(obj) {\n      return obj === obj + '';\n    },\n    isBoolean: function isBoolean(obj) {\n      return obj === false || obj === true;\n    },\n    isFunction: function isFunction(obj) {\n      return Object.prototype.toString.call(obj) === '[object Function]';\n    }\n  };\n\n  var INTERPRETATIONS = [{\n    litmus: Common.isString,\n    conversions: {\n      THREE_CHAR_HEX: {\n        read: function read(original) {\n          var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n          if (test === null) {\n            return false;\n          }\n          return {\n            space: 'HEX',\n            hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)\n          };\n        },\n        write: colorToString\n      },\n      SIX_CHAR_HEX: {\n        read: function read(original) {\n          var test = original.match(/^#([A-F0-9]{6})$/i);\n          if (test === null) {\n            return false;\n          }\n          return {\n            space: 'HEX',\n            hex: parseInt('0x' + test[1].toString(), 0)\n          };\n        },\n        write: colorToString\n      },\n      CSS_RGB: {\n        read: function read(original) {\n          var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n          if (test === null) {\n            return false;\n          }\n          return {\n            space: 'RGB',\n            r: parseFloat(test[1]),\n            g: parseFloat(test[2]),\n            b: parseFloat(test[3])\n          };\n        },\n        write: colorToString\n      },\n      CSS_RGBA: {\n        read: function read(original) {\n          var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n          if (test === null) {\n            return false;\n          }\n          return {\n            space: 'RGB',\n            r: parseFloat(test[1]),\n            g: parseFloat(test[2]),\n            b: parseFloat(test[3]),\n            a: parseFloat(test[4])\n          };\n        },\n        write: colorToString\n      }\n    }\n  }, {\n    litmus: Common.isNumber,\n    conversions: {\n      HEX: {\n        read: function read(original) {\n          return {\n            space: 'HEX',\n            hex: original,\n            conversionName: 'HEX'\n          };\n        },\n        write: function write(color) {\n          return color.hex;\n        }\n      }\n    }\n  }, {\n    litmus: Common.isArray,\n    conversions: {\n      RGB_ARRAY: {\n        read: function read(original) {\n          if (original.length !== 3) {\n            return false;\n          }\n          return {\n            space: 'RGB',\n            r: original[0],\n            g: original[1],\n            b: original[2]\n          };\n        },\n        write: function write(color) {\n          return [color.r, color.g, color.b];\n        }\n      },\n      RGBA_ARRAY: {\n        read: function read(original) {\n          if (original.length !== 4) return false;\n          return {\n            space: 'RGB',\n            r: original[0],\n            g: original[1],\n            b: original[2],\n            a: original[3]\n          };\n        },\n        write: function write(color) {\n          return [color.r, color.g, color.b, color.a];\n        }\n      }\n    }\n  }, {\n    litmus: Common.isObject,\n    conversions: {\n      RGBA_OBJ: {\n        read: function read(original) {\n          if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b) && Common.isNumber(original.a)) {\n            return {\n              space: 'RGB',\n              r: original.r,\n              g: original.g,\n              b: original.b,\n              a: original.a\n            };\n          }\n          return false;\n        },\n        write: function write(color) {\n          return {\n            r: color.r,\n            g: color.g,\n            b: color.b,\n            a: color.a\n          };\n        }\n      },\n      RGB_OBJ: {\n        read: function read(original) {\n          if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b)) {\n            return {\n              space: 'RGB',\n              r: original.r,\n              g: original.g,\n              b: original.b\n            };\n          }\n          return false;\n        },\n        write: function write(color) {\n          return {\n            r: color.r,\n            g: color.g,\n            b: color.b\n          };\n        }\n      },\n      HSVA_OBJ: {\n        read: function read(original) {\n          if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v) && Common.isNumber(original.a)) {\n            return {\n              space: 'HSV',\n              h: original.h,\n              s: original.s,\n              v: original.v,\n              a: original.a\n            };\n          }\n          return false;\n        },\n        write: function write(color) {\n          return {\n            h: color.h,\n            s: color.s,\n            v: color.v,\n            a: color.a\n          };\n        }\n      },\n      HSV_OBJ: {\n        read: function read(original) {\n          if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v)) {\n            return {\n              space: 'HSV',\n              h: original.h,\n              s: original.s,\n              v: original.v\n            };\n          }\n          return false;\n        },\n        write: function write(color) {\n          return {\n            h: color.h,\n            s: color.s,\n            v: color.v\n          };\n        }\n      }\n    }\n  }];\n  var result = void 0;\n  var toReturn = void 0;\n  var interpret = function interpret() {\n    toReturn = false;\n    var original = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];\n    Common.each(INTERPRETATIONS, function (family) {\n      if (family.litmus(original)) {\n        Common.each(family.conversions, function (conversion, conversionName) {\n          result = conversion.read(original);\n          if (toReturn === false && result !== false) {\n            toReturn = result;\n            result.conversionName = conversionName;\n            result.conversion = conversion;\n            return Common.BREAK;\n          }\n        });\n        return Common.BREAK;\n      }\n    });\n    return toReturn;\n  };\n\n  var tmpComponent = void 0;\n  var ColorMath = {\n    hsv_to_rgb: function hsv_to_rgb(h, s, v) {\n      var hi = Math.floor(h / 60) % 6;\n      var f = h / 60 - Math.floor(h / 60);\n      var p = v * (1.0 - s);\n      var q = v * (1.0 - f * s);\n      var t = v * (1.0 - (1.0 - f) * s);\n      var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];\n      return {\n        r: c[0] * 255,\n        g: c[1] * 255,\n        b: c[2] * 255\n      };\n    },\n    rgb_to_hsv: function rgb_to_hsv(r, g, b) {\n      var min = Math.min(r, g, b);\n      var max = Math.max(r, g, b);\n      var delta = max - min;\n      var h = void 0;\n      var s = void 0;\n      if (max !== 0) {\n        s = delta / max;\n      } else {\n        return {\n          h: NaN,\n          s: 0,\n          v: 0\n        };\n      }\n      if (r === max) {\n        h = (g - b) / delta;\n      } else if (g === max) {\n        h = 2 + (b - r) / delta;\n      } else {\n        h = 4 + (r - g) / delta;\n      }\n      h /= 6;\n      if (h < 0) {\n        h += 1;\n      }\n      return {\n        h: h * 360,\n        s: s,\n        v: max / 255\n      };\n    },\n    rgb_to_hex: function rgb_to_hex(r, g, b) {\n      var hex = this.hex_with_component(0, 2, r);\n      hex = this.hex_with_component(hex, 1, g);\n      hex = this.hex_with_component(hex, 0, b);\n      return hex;\n    },\n    component_from_hex: function component_from_hex(hex, componentIndex) {\n      return hex >> componentIndex * 8 & 0xFF;\n    },\n    hex_with_component: function hex_with_component(hex, componentIndex, value) {\n      return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);\n    }\n  };\n\n  var _typeof = typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\" ? function (obj) {\n    return typeof obj === 'undefined' ? 'undefined' : _typeof2(obj);\n  } : function (obj) {\n    return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj === 'undefined' ? 'undefined' : _typeof2(obj);\n  };\n\n  var classCallCheck = function classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  var createClass = function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  }();\n\n  var get = function get(object, property, receiver) {\n    if (object === null) object = Function.prototype;\n    var desc = Object.getOwnPropertyDescriptor(object, property);\n\n    if (desc === undefined) {\n      var parent = Object.getPrototypeOf(object);\n\n      if (parent === null) {\n        return undefined;\n      } else {\n        return get(parent, property, receiver);\n      }\n    } else if (\"value\" in desc) {\n      return desc.value;\n    } else {\n      var getter = desc.get;\n\n      if (getter === undefined) {\n        return undefined;\n      }\n\n      return getter.call(receiver);\n    }\n  };\n\n  var inherits = function inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === 'undefined' ? 'undefined' : _typeof2(superClass)));\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  var possibleConstructorReturn = function possibleConstructorReturn(self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && ((typeof call === 'undefined' ? 'undefined' : _typeof2(call)) === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  var Color = function () {\n    function Color() {\n      classCallCheck(this, Color);\n      this.__state = interpret.apply(this, arguments);\n      if (this.__state === false) {\n        throw new Error('Failed to interpret color arguments');\n      }\n      this.__state.a = this.__state.a || 1;\n    }\n    createClass(Color, [{\n      key: 'toString',\n      value: function toString() {\n        return colorToString(this);\n      }\n    }, {\n      key: 'toHexString',\n      value: function toHexString() {\n        return colorToString(this, true);\n      }\n    }, {\n      key: 'toOriginal',\n      value: function toOriginal() {\n        return this.__state.conversion.write(this);\n      }\n    }]);\n    return Color;\n  }();\n  function defineRGBComponent(target, component, componentHexIndex) {\n    Object.defineProperty(target, component, {\n      get: function get$$1() {\n        if (this.__state.space === 'RGB') {\n          return this.__state[component];\n        }\n        Color.recalculateRGB(this, component, componentHexIndex);\n        return this.__state[component];\n      },\n      set: function set$$1(v) {\n        if (this.__state.space !== 'RGB') {\n          Color.recalculateRGB(this, component, componentHexIndex);\n          this.__state.space = 'RGB';\n        }\n        this.__state[component] = v;\n      }\n    });\n  }\n  function defineHSVComponent(target, component) {\n    Object.defineProperty(target, component, {\n      get: function get$$1() {\n        if (this.__state.space === 'HSV') {\n          return this.__state[component];\n        }\n        Color.recalculateHSV(this);\n        return this.__state[component];\n      },\n      set: function set$$1(v) {\n        if (this.__state.space !== 'HSV') {\n          Color.recalculateHSV(this);\n          this.__state.space = 'HSV';\n        }\n        this.__state[component] = v;\n      }\n    });\n  }\n  Color.recalculateRGB = function (color, component, componentHexIndex) {\n    if (color.__state.space === 'HEX') {\n      color.__state[component] = ColorMath.component_from_hex(color.__state.hex, componentHexIndex);\n    } else if (color.__state.space === 'HSV') {\n      Common.extend(color.__state, ColorMath.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n    } else {\n      throw new Error('Corrupted color state');\n    }\n  };\n  Color.recalculateHSV = function (color) {\n    var result = ColorMath.rgb_to_hsv(color.r, color.g, color.b);\n    Common.extend(color.__state, {\n      s: result.s,\n      v: result.v\n    });\n    if (!Common.isNaN(result.h)) {\n      color.__state.h = result.h;\n    } else if (Common.isUndefined(color.__state.h)) {\n      color.__state.h = 0;\n    }\n  };\n  Color.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\n  defineRGBComponent(Color.prototype, 'r', 2);\n  defineRGBComponent(Color.prototype, 'g', 1);\n  defineRGBComponent(Color.prototype, 'b', 0);\n  defineHSVComponent(Color.prototype, 'h');\n  defineHSVComponent(Color.prototype, 's');\n  defineHSVComponent(Color.prototype, 'v');\n  Object.defineProperty(Color.prototype, 'a', {\n    get: function get$$1() {\n      return this.__state.a;\n    },\n    set: function set$$1(v) {\n      this.__state.a = v;\n    }\n  });\n  Object.defineProperty(Color.prototype, 'hex', {\n    get: function get$$1() {\n      if (!this.__state.space !== 'HEX') {\n        this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b);\n      }\n      return this.__state.hex;\n    },\n    set: function set$$1(v) {\n      this.__state.space = 'HEX';\n      this.__state.hex = v;\n    }\n  });\n\n  var Controller = function () {\n    function Controller(object, property) {\n      classCallCheck(this, Controller);\n      this.initialValue = object[property];\n      this.domElement = document.createElement('div');\n      this.object = object;\n      this.property = property;\n      this.__onChange = undefined;\n      this.__onFinishChange = undefined;\n    }\n    createClass(Controller, [{\n      key: 'onChange',\n      value: function onChange(fnc) {\n        this.__onChange = fnc;\n        return this;\n      }\n    }, {\n      key: 'onFinishChange',\n      value: function onFinishChange(fnc) {\n        this.__onFinishChange = fnc;\n        return this;\n      }\n    }, {\n      key: 'setValue',\n      value: function setValue(newValue) {\n        this.object[this.property] = newValue;\n        if (this.__onChange) {\n          this.__onChange.call(this, newValue);\n        }\n        this.updateDisplay();\n        return this;\n      }\n    }, {\n      key: 'getValue',\n      value: function getValue() {\n        return this.object[this.property];\n      }\n    }, {\n      key: 'updateDisplay',\n      value: function updateDisplay() {\n        return this;\n      }\n    }, {\n      key: 'isModified',\n      value: function isModified() {\n        return this.initialValue !== this.getValue();\n      }\n    }]);\n    return Controller;\n  }();\n\n  var EVENT_MAP = {\n    HTMLEvents: ['change'],\n    MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\n    KeyboardEvents: ['keydown']\n  };\n  var EVENT_MAP_INV = {};\n  Common.each(EVENT_MAP, function (v, k) {\n    Common.each(v, function (e) {\n      EVENT_MAP_INV[e] = k;\n    });\n  });\n  var CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\n  function cssValueToPixels(val) {\n    if (val === '0' || Common.isUndefined(val)) {\n      return 0;\n    }\n    var match = val.match(CSS_VALUE_PIXELS);\n    if (!Common.isNull(match)) {\n      return parseFloat(match[1]);\n    }\n    return 0;\n  }\n  var dom = {\n    makeSelectable: function makeSelectable(elem, selectable) {\n      if (elem === undefined || elem.style === undefined) return;\n      elem.onselectstart = selectable ? function () {\n        return false;\n      } : function () {};\n      elem.style.MozUserSelect = selectable ? 'auto' : 'none';\n      elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\n      elem.unselectable = selectable ? 'on' : 'off';\n    },\n    makeFullscreen: function makeFullscreen(elem, hor, vert) {\n      var vertical = vert;\n      var horizontal = hor;\n      if (Common.isUndefined(horizontal)) {\n        horizontal = true;\n      }\n      if (Common.isUndefined(vertical)) {\n        vertical = true;\n      }\n      elem.style.position = 'absolute';\n      if (horizontal) {\n        elem.style.left = 0;\n        elem.style.right = 0;\n      }\n      if (vertical) {\n        elem.style.top = 0;\n        elem.style.bottom = 0;\n      }\n    },\n    fakeEvent: function fakeEvent(elem, eventType, pars, aux) {\n      var params = pars || {};\n      var className = EVENT_MAP_INV[eventType];\n      if (!className) {\n        throw new Error('Event type ' + eventType + ' not supported.');\n      }\n      var evt = document.createEvent(className);\n      switch (className) {\n        case 'MouseEvents':\n          {\n            var clientX = params.x || params.clientX || 0;\n            var clientY = params.y || params.clientY || 0;\n            evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0, 0, clientX, clientY, false, false, false, false, 0, null);\n            break;\n          }\n        case 'KeyboardEvents':\n          {\n            var init = evt.initKeyboardEvent || evt.initKeyEvent;\n            Common.defaults(params, {\n              cancelable: true,\n              ctrlKey: false,\n              altKey: false,\n              shiftKey: false,\n              metaKey: false,\n              keyCode: undefined,\n              charCode: undefined\n            });\n            init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);\n            break;\n          }\n        default:\n          {\n            evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\n            break;\n          }\n      }\n      Common.defaults(evt, aux);\n      elem.dispatchEvent(evt);\n    },\n    bind: function bind(elem, event, func, newBool) {\n      var bool = newBool || false;\n      if (elem.addEventListener) {\n        elem.addEventListener(event, func, bool);\n      } else if (elem.attachEvent) {\n        elem.attachEvent('on' + event, func);\n      }\n      return dom;\n    },\n    unbind: function unbind(elem, event, func, newBool) {\n      var bool = newBool || false;\n      if (elem.removeEventListener) {\n        elem.removeEventListener(event, func, bool);\n      } else if (elem.detachEvent) {\n        elem.detachEvent('on' + event, func);\n      }\n      return dom;\n    },\n    addClass: function addClass(elem, className) {\n      if (elem.className === undefined) {\n        elem.className = className;\n      } else if (elem.className !== className) {\n        var classes = elem.className.split(/ +/);\n        if (classes.indexOf(className) === -1) {\n          classes.push(className);\n          elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\n        }\n      }\n      return dom;\n    },\n    removeClass: function removeClass(elem, className) {\n      if (className) {\n        if (elem.className === className) {\n          elem.removeAttribute('class');\n        } else {\n          var classes = elem.className.split(/ +/);\n          var index = classes.indexOf(className);\n          if (index !== -1) {\n            classes.splice(index, 1);\n            elem.className = classes.join(' ');\n          }\n        }\n      } else {\n        elem.className = undefined;\n      }\n      return dom;\n    },\n    hasClass: function hasClass(elem, className) {\n      return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\n    },\n    getWidth: function getWidth(elem) {\n      var style = getComputedStyle(elem);\n      return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);\n    },\n    getHeight: function getHeight(elem) {\n      var style = getComputedStyle(elem);\n      return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);\n    },\n    getOffset: function getOffset(el) {\n      var elem = el;\n      var offset = { left: 0, top: 0 };\n      if (elem.offsetParent) {\n        do {\n          offset.left += elem.offsetLeft;\n          offset.top += elem.offsetTop;\n          elem = elem.offsetParent;\n        } while (elem);\n      }\n      return offset;\n    },\n    isActive: function isActive(elem) {\n      return elem === document.activeElement && (elem.type || elem.href);\n    }\n  };\n\n  var BooleanController = function (_Controller) {\n    inherits(BooleanController, _Controller);\n    function BooleanController(object, property) {\n      classCallCheck(this, BooleanController);\n      var _this2 = possibleConstructorReturn(this, (BooleanController.__proto__ || Object.getPrototypeOf(BooleanController)).call(this, object, property));\n      var _this = _this2;\n      _this2.__prev = _this2.getValue();\n      _this2.__checkbox = document.createElement('input');\n      _this2.__checkbox.setAttribute('type', 'checkbox');\n      function onChange() {\n        _this.setValue(!_this.__prev);\n      }\n      dom.bind(_this2.__checkbox, 'change', onChange, false);\n      _this2.domElement.appendChild(_this2.__checkbox);\n      _this2.updateDisplay();\n      return _this2;\n    }\n    createClass(BooleanController, [{\n      key: 'setValue',\n      value: function setValue(v) {\n        var toReturn = get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'setValue', this).call(this, v);\n        if (this.__onFinishChange) {\n          this.__onFinishChange.call(this, this.getValue());\n        }\n        this.__prev = this.getValue();\n        return toReturn;\n      }\n    }, {\n      key: 'updateDisplay',\n      value: function updateDisplay() {\n        if (this.getValue() === true) {\n          this.__checkbox.setAttribute('checked', 'checked');\n          this.__checkbox.checked = true;\n          this.__prev = true;\n        } else {\n          this.__checkbox.checked = false;\n          this.__prev = false;\n        }\n        return get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'updateDisplay', this).call(this);\n      }\n    }]);\n    return BooleanController;\n  }(Controller);\n\n  var OptionController = function (_Controller) {\n    inherits(OptionController, _Controller);\n    function OptionController(object, property, opts) {\n      classCallCheck(this, OptionController);\n      var _this2 = possibleConstructorReturn(this, (OptionController.__proto__ || Object.getPrototypeOf(OptionController)).call(this, object, property));\n      var options = opts;\n      var _this = _this2;\n      _this2.__select = document.createElement('select');\n      if (Common.isArray(options)) {\n        var map = {};\n        Common.each(options, function (element) {\n          map[element] = element;\n        });\n        options = map;\n      }\n      Common.each(options, function (value, key) {\n        var opt = document.createElement('option');\n        opt.innerHTML = key;\n        opt.setAttribute('value', value);\n        _this.__select.appendChild(opt);\n      });\n      _this2.updateDisplay();\n      dom.bind(_this2.__select, 'change', function () {\n        var desiredValue = this.options[this.selectedIndex].value;\n        _this.setValue(desiredValue);\n      });\n      _this2.domElement.appendChild(_this2.__select);\n      return _this2;\n    }\n    createClass(OptionController, [{\n      key: 'setValue',\n      value: function setValue(v) {\n        var toReturn = get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'setValue', this).call(this, v);\n        if (this.__onFinishChange) {\n          this.__onFinishChange.call(this, this.getValue());\n        }\n        return toReturn;\n      }\n    }, {\n      key: 'updateDisplay',\n      value: function updateDisplay() {\n        if (dom.isActive(this.__select)) return this;\n        this.__select.value = this.getValue();\n        return get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'updateDisplay', this).call(this);\n      }\n    }]);\n    return OptionController;\n  }(Controller);\n\n  var StringController = function (_Controller) {\n    inherits(StringController, _Controller);\n    function StringController(object, property) {\n      classCallCheck(this, StringController);\n      var _this2 = possibleConstructorReturn(this, (StringController.__proto__ || Object.getPrototypeOf(StringController)).call(this, object, property));\n      var _this = _this2;\n      function onChange() {\n        _this.setValue(_this.__input.value);\n      }\n      function onBlur() {\n        if (_this.__onFinishChange) {\n          _this.__onFinishChange.call(_this, _this.getValue());\n        }\n      }\n      _this2.__input = document.createElement('input');\n      _this2.__input.setAttribute('type', 'text');\n      dom.bind(_this2.__input, 'keyup', onChange);\n      dom.bind(_this2.__input, 'change', onChange);\n      dom.bind(_this2.__input, 'blur', onBlur);\n      dom.bind(_this2.__input, 'keydown', function (e) {\n        if (e.keyCode === 13) {\n          this.blur();\n        }\n      });\n      _this2.updateDisplay();\n      _this2.domElement.appendChild(_this2.__input);\n      return _this2;\n    }\n    createClass(StringController, [{\n      key: 'updateDisplay',\n      value: function updateDisplay() {\n        if (!dom.isActive(this.__input)) {\n          this.__input.value = this.getValue();\n        }\n        return get(StringController.prototype.__proto__ || Object.getPrototypeOf(StringController.prototype), 'updateDisplay', this).call(this);\n      }\n    }]);\n    return StringController;\n  }(Controller);\n\n  function numDecimals(x) {\n    var _x = x.toString();\n    if (_x.indexOf('.') > -1) {\n      return _x.length - _x.indexOf('.') - 1;\n    }\n    return 0;\n  }\n  var NumberController = function (_Controller) {\n    inherits(NumberController, _Controller);\n    function NumberController(object, property, params) {\n      classCallCheck(this, NumberController);\n      var _this = possibleConstructorReturn(this, (NumberController.__proto__ || Object.getPrototypeOf(NumberController)).call(this, object, property));\n      var _params = params || {};\n      _this.__min = _params.min;\n      _this.__max = _params.max;\n      _this.__step = _params.step;\n      if (Common.isUndefined(_this.__step)) {\n        if (_this.initialValue === 0) {\n          _this.__impliedStep = 1;\n        } else {\n          _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;\n        }\n      } else {\n        _this.__impliedStep = _this.__step;\n      }\n      _this.__precision = numDecimals(_this.__impliedStep);\n      return _this;\n    }\n    createClass(NumberController, [{\n      key: 'setValue',\n      value: function setValue(v) {\n        var _v = v;\n        if (this.__min !== undefined && _v < this.__min) {\n          _v = this.__min;\n        } else if (this.__max !== undefined && _v > this.__max) {\n          _v = this.__max;\n        }\n        if (this.__step !== undefined && _v % this.__step !== 0) {\n          _v = Math.round(_v / this.__step) * this.__step;\n        }\n        return get(NumberController.prototype.__proto__ || Object.getPrototypeOf(NumberController.prototype), 'setValue', this).call(this, _v);\n      }\n    }, {\n      key: 'min',\n      value: function min(minValue) {\n        this.__min = minValue;\n        return this;\n      }\n    }, {\n      key: 'max',\n      value: function max(maxValue) {\n        this.__max = maxValue;\n        return this;\n      }\n    }, {\n      key: 'step',\n      value: function step(stepValue) {\n        this.__step = stepValue;\n        this.__impliedStep = stepValue;\n        this.__precision = numDecimals(stepValue);\n        return this;\n      }\n    }]);\n    return NumberController;\n  }(Controller);\n\n  function roundToDecimal(value, decimals) {\n    var tenTo = Math.pow(10, decimals);\n    return Math.round(value * tenTo) / tenTo;\n  }\n  var NumberControllerBox = function (_NumberController) {\n    inherits(NumberControllerBox, _NumberController);\n    function NumberControllerBox(object, property, params) {\n      classCallCheck(this, NumberControllerBox);\n      var _this2 = possibleConstructorReturn(this, (NumberControllerBox.__proto__ || Object.getPrototypeOf(NumberControllerBox)).call(this, object, property, params));\n      _this2.__truncationSuspended = false;\n      var _this = _this2;\n      var prevY = void 0;\n      function onChange() {\n        var attempted = parseFloat(_this.__input.value);\n        if (!Common.isNaN(attempted)) {\n          _this.setValue(attempted);\n        }\n      }\n      function onFinish() {\n        if (_this.__onFinishChange) {\n          _this.__onFinishChange.call(_this, _this.getValue());\n        }\n      }\n      function onBlur() {\n        onFinish();\n      }\n      function onMouseDrag(e) {\n        var diff = prevY - e.clientY;\n        _this.setValue(_this.getValue() + diff * _this.__impliedStep);\n        prevY = e.clientY;\n      }\n      function onMouseUp() {\n        dom.unbind(window, 'mousemove', onMouseDrag);\n        dom.unbind(window, 'mouseup', onMouseUp);\n        onFinish();\n      }\n      function onMouseDown(e) {\n        dom.bind(window, 'mousemove', onMouseDrag);\n        dom.bind(window, 'mouseup', onMouseUp);\n        prevY = e.clientY;\n      }\n      _this2.__input = document.createElement('input');\n      _this2.__input.setAttribute('type', 'text');\n      dom.bind(_this2.__input, 'change', onChange);\n      dom.bind(_this2.__input, 'blur', onBlur);\n      dom.bind(_this2.__input, 'mousedown', onMouseDown);\n      dom.bind(_this2.__input, 'keydown', function (e) {\n        if (e.keyCode === 13) {\n          _this.__truncationSuspended = true;\n          this.blur();\n          _this.__truncationSuspended = false;\n          onFinish();\n        }\n      });\n      _this2.updateDisplay();\n      _this2.domElement.appendChild(_this2.__input);\n      return _this2;\n    }\n    createClass(NumberControllerBox, [{\n      key: 'updateDisplay',\n      value: function updateDisplay() {\n        this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\n        return get(NumberControllerBox.prototype.__proto__ || Object.getPrototypeOf(NumberControllerBox.prototype), 'updateDisplay', this).call(this);\n      }\n    }]);\n    return NumberControllerBox;\n  }(NumberController);\n\n  function map(v, i1, i2, o1, o2) {\n    return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\n  }\n  var NumberControllerSlider = function (_NumberController) {\n    inherits(NumberControllerSlider, _NumberController);\n    function NumberControllerSlider(object, property, min, max, step) {\n      classCallCheck(this, NumberControllerSlider);\n      var _this2 = possibleConstructorReturn(this, (NumberControllerSlider.__proto__ || Object.getPrototypeOf(NumberControllerSlider)).call(this, object, property, { min: min, max: max, step: step }));\n      var _this = _this2;\n      _this2.__background = document.createElement('div');\n      _this2.__foreground = document.createElement('div');\n      dom.bind(_this2.__background, 'mousedown', onMouseDown);\n      dom.bind(_this2.__background, 'touchstart', onTouchStart);\n      dom.addClass(_this2.__background, 'slider');\n      dom.addClass(_this2.__foreground, 'slider-fg');\n      function onMouseDown(e) {\n        document.activeElement.blur();\n        dom.bind(window, 'mousemove', onMouseDrag);\n        dom.bind(window, 'mouseup', onMouseUp);\n        onMouseDrag(e);\n      }\n      function onMouseDrag(e) {\n        e.preventDefault();\n        var bgRect = _this.__background.getBoundingClientRect();\n        _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\n        return false;\n      }\n      function onMouseUp() {\n        dom.unbind(window, 'mousemove', onMouseDrag);\n        dom.unbind(window, 'mouseup', onMouseUp);\n        if (_this.__onFinishChange) {\n          _this.__onFinishChange.call(_this, _this.getValue());\n        }\n      }\n      function onTouchStart(e) {\n        if (e.touches.length !== 1) {\n          return;\n        }\n        dom.bind(window, 'touchmove', onTouchMove);\n        dom.bind(window, 'touchend', onTouchEnd);\n        onTouchMove(e);\n      }\n      function onTouchMove(e) {\n        var clientX = e.touches[0].clientX;\n        var bgRect = _this.__background.getBoundingClientRect();\n        _this.setValue(map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\n      }\n      function onTouchEnd() {\n        dom.unbind(window, 'touchmove', onTouchMove);\n        dom.unbind(window, 'touchend', onTouchEnd);\n        if (_this.__onFinishChange) {\n          _this.__onFinishChange.call(_this, _this.getValue());\n        }\n      }\n      _this2.updateDisplay();\n      _this2.__background.appendChild(_this2.__foreground);\n      _this2.domElement.appendChild(_this2.__background);\n      return _this2;\n    }\n    createClass(NumberControllerSlider, [{\n      key: 'updateDisplay',\n      value: function updateDisplay() {\n        var pct = (this.getValue() - this.__min) / (this.__max - this.__min);\n        this.__foreground.style.width = pct * 100 + '%';\n        return get(NumberControllerSlider.prototype.__proto__ || Object.getPrototypeOf(NumberControllerSlider.prototype), 'updateDisplay', this).call(this);\n      }\n    }]);\n    return NumberControllerSlider;\n  }(NumberController);\n\n  var FunctionController = function (_Controller) {\n    inherits(FunctionController, _Controller);\n    function FunctionController(object, property, text) {\n      classCallCheck(this, FunctionController);\n      var _this2 = possibleConstructorReturn(this, (FunctionController.__proto__ || Object.getPrototypeOf(FunctionController)).call(this, object, property));\n      var _this = _this2;\n      _this2.__button = document.createElement('div');\n      _this2.__button.innerHTML = text === undefined ? 'Fire' : text;\n      dom.bind(_this2.__button, 'click', function (e) {\n        e.preventDefault();\n        _this.fire();\n        return false;\n      });\n      dom.addClass(_this2.__button, 'button');\n      _this2.domElement.appendChild(_this2.__button);\n      return _this2;\n    }\n    createClass(FunctionController, [{\n      key: 'fire',\n      value: function fire() {\n        if (this.__onChange) {\n          this.__onChange.call(this);\n        }\n        this.getValue().call(this.object);\n        if (this.__onFinishChange) {\n          this.__onFinishChange.call(this, this.getValue());\n        }\n      }\n    }]);\n    return FunctionController;\n  }(Controller);\n\n  var ColorController = function (_Controller) {\n    inherits(ColorController, _Controller);\n    function ColorController(object, property) {\n      classCallCheck(this, ColorController);\n      var _this2 = possibleConstructorReturn(this, (ColorController.__proto__ || Object.getPrototypeOf(ColorController)).call(this, object, property));\n      _this2.__color = new Color(_this2.getValue());\n      _this2.__temp = new Color(0);\n      var _this = _this2;\n      _this2.domElement = document.createElement('div');\n      dom.makeSelectable(_this2.domElement, false);\n      _this2.__selector = document.createElement('div');\n      _this2.__selector.className = 'selector';\n      _this2.__saturation_field = document.createElement('div');\n      _this2.__saturation_field.className = 'saturation-field';\n      _this2.__field_knob = document.createElement('div');\n      _this2.__field_knob.className = 'field-knob';\n      _this2.__field_knob_border = '2px solid ';\n      _this2.__hue_knob = document.createElement('div');\n      _this2.__hue_knob.className = 'hue-knob';\n      _this2.__hue_field = document.createElement('div');\n      _this2.__hue_field.className = 'hue-field';\n      _this2.__input = document.createElement('input');\n      _this2.__input.type = 'text';\n      _this2.__input_textShadow = '0 1px 1px ';\n      dom.bind(_this2.__input, 'keydown', function (e) {\n        if (e.keyCode === 13) {\n          onBlur.call(this);\n        }\n      });\n      dom.bind(_this2.__input, 'blur', onBlur);\n      dom.bind(_this2.__selector, 'mousedown', function () {\n        dom.addClass(this, 'drag').bind(window, 'mouseup', function () {\n          dom.removeClass(_this.__selector, 'drag');\n        });\n      });\n      dom.bind(_this2.__selector, 'touchstart', function () {\n        dom.addClass(this, 'drag').bind(window, 'touchend', function () {\n          dom.removeClass(_this.__selector, 'drag');\n        });\n      });\n      var valueField = document.createElement('div');\n      Common.extend(_this2.__selector.style, {\n        width: '122px',\n        height: '102px',\n        padding: '3px',\n        backgroundColor: '#222',\n        boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\n      });\n      Common.extend(_this2.__field_knob.style, {\n        position: 'absolute',\n        width: '12px',\n        height: '12px',\n        border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),\n        boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\n        borderRadius: '12px',\n        zIndex: 1\n      });\n      Common.extend(_this2.__hue_knob.style, {\n        position: 'absolute',\n        width: '15px',\n        height: '2px',\n        borderRight: '4px solid #fff',\n        zIndex: 1\n      });\n      Common.extend(_this2.__saturation_field.style, {\n        width: '100px',\n        height: '100px',\n        border: '1px solid #555',\n        marginRight: '3px',\n        display: 'inline-block',\n        cursor: 'pointer'\n      });\n      Common.extend(valueField.style, {\n        width: '100%',\n        height: '100%',\n        background: 'none'\n      });\n      linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\n      Common.extend(_this2.__hue_field.style, {\n        width: '15px',\n        height: '100px',\n        border: '1px solid #555',\n        cursor: 'ns-resize',\n        position: 'absolute',\n        top: '3px',\n        right: '3px'\n      });\n      hueGradient(_this2.__hue_field);\n      Common.extend(_this2.__input.style, {\n        outline: 'none',\n        textAlign: 'center',\n        color: '#fff',\n        border: 0,\n        fontWeight: 'bold',\n        textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'\n      });\n      dom.bind(_this2.__saturation_field, 'mousedown', fieldDown);\n      dom.bind(_this2.__saturation_field, 'touchstart', fieldDown);\n      dom.bind(_this2.__field_knob, 'mousedown', fieldDown);\n      dom.bind(_this2.__field_knob, 'touchstart', fieldDown);\n      dom.bind(_this2.__hue_field, 'mousedown', fieldDownH);\n      dom.bind(_this2.__hue_field, 'touchstart', fieldDownH);\n      function fieldDown(e) {\n        setSV(e);\n        dom.bind(window, 'mousemove', setSV);\n        dom.bind(window, 'touchmove', setSV);\n        dom.bind(window, 'mouseup', fieldUpSV);\n        dom.bind(window, 'touchend', fieldUpSV);\n      }\n      function fieldDownH(e) {\n        setH(e);\n        dom.bind(window, 'mousemove', setH);\n        dom.bind(window, 'touchmove', setH);\n        dom.bind(window, 'mouseup', fieldUpH);\n        dom.bind(window, 'touchend', fieldUpH);\n      }\n      function fieldUpSV() {\n        dom.unbind(window, 'mousemove', setSV);\n        dom.unbind(window, 'touchmove', setSV);\n        dom.unbind(window, 'mouseup', fieldUpSV);\n        dom.unbind(window, 'touchend', fieldUpSV);\n        onFinish();\n      }\n      function fieldUpH() {\n        dom.unbind(window, 'mousemove', setH);\n        dom.unbind(window, 'touchmove', setH);\n        dom.unbind(window, 'mouseup', fieldUpH);\n        dom.unbind(window, 'touchend', fieldUpH);\n        onFinish();\n      }\n      function onBlur() {\n        var i = interpret(this.value);\n        if (i !== false) {\n          _this.__color.__state = i;\n          _this.setValue(_this.__color.toOriginal());\n        } else {\n          this.value = _this.__color.toString();\n        }\n      }\n      function onFinish() {\n        if (_this.__onFinishChange) {\n          _this.__onFinishChange.call(_this, _this.__color.toOriginal());\n        }\n      }\n      _this2.__saturation_field.appendChild(valueField);\n      _this2.__selector.appendChild(_this2.__field_knob);\n      _this2.__selector.appendChild(_this2.__saturation_field);\n      _this2.__selector.appendChild(_this2.__hue_field);\n      _this2.__hue_field.appendChild(_this2.__hue_knob);\n      _this2.domElement.appendChild(_this2.__input);\n      _this2.domElement.appendChild(_this2.__selector);\n      _this2.updateDisplay();\n      function setSV(e) {\n        if (e.type.indexOf('touch') === -1) {\n          e.preventDefault();\n        }\n        var fieldRect = _this.__saturation_field.getBoundingClientRect();\n        var _ref = e.touches && e.touches[0] || e,\n            clientX = _ref.clientX,\n            clientY = _ref.clientY;\n        var s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\n        var v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\n        if (v > 1) {\n          v = 1;\n        } else if (v < 0) {\n          v = 0;\n        }\n        if (s > 1) {\n          s = 1;\n        } else if (s < 0) {\n          s = 0;\n        }\n        _this.__color.v = v;\n        _this.__color.s = s;\n        _this.setValue(_this.__color.toOriginal());\n        return false;\n      }\n      function setH(e) {\n        if (e.type.indexOf('touch') === -1) {\n          e.preventDefault();\n        }\n        var fieldRect = _this.__hue_field.getBoundingClientRect();\n        var _ref2 = e.touches && e.touches[0] || e,\n            clientY = _ref2.clientY;\n        var h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\n        if (h > 1) {\n          h = 1;\n        } else if (h < 0) {\n          h = 0;\n        }\n        _this.__color.h = h * 360;\n        _this.setValue(_this.__color.toOriginal());\n        return false;\n      }\n      return _this2;\n    }\n    createClass(ColorController, [{\n      key: 'updateDisplay',\n      value: function updateDisplay() {\n        var i = interpret(this.getValue());\n        if (i !== false) {\n          var mismatch = false;\n          Common.each(Color.COMPONENTS, function (component) {\n            if (!Common.isUndefined(i[component]) && !Common.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {\n              mismatch = true;\n              return {};\n            }\n          }, this);\n          if (mismatch) {\n            Common.extend(this.__color.__state, i);\n          }\n        }\n        Common.extend(this.__temp.__state, this.__color.__state);\n        this.__temp.a = 1;\n        var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;\n        var _flip = 255 - flip;\n        Common.extend(this.__field_knob.style, {\n          marginLeft: 100 * this.__color.s - 7 + 'px',\n          marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\n          backgroundColor: this.__temp.toHexString(),\n          border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\n        });\n        this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\n        this.__temp.s = 1;\n        this.__temp.v = 1;\n        linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\n        this.__input.value = this.__color.toString();\n        Common.extend(this.__input.style, {\n          backgroundColor: this.__color.toHexString(),\n          color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\n          textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\n        });\n      }\n    }]);\n    return ColorController;\n  }(Controller);\n  var vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\n  function linearGradient(elem, x, a, b) {\n    elem.style.background = '';\n    Common.each(vendors, function (vendor) {\n      elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\n    });\n  }\n  function hueGradient(elem) {\n    elem.style.background = '';\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  }\n\n  var css = {\n    load: function load(url, indoc) {\n      var doc = indoc || document;\n      var link = doc.createElement('link');\n      link.type = 'text/css';\n      link.rel = 'stylesheet';\n      link.href = url;\n      doc.getElementsByTagName('head')[0].appendChild(link);\n    },\n    inject: function inject(cssContent, indoc) {\n      var doc = indoc || document;\n      var injected = document.createElement('style');\n      injected.type = 'text/css';\n      injected.innerHTML = cssContent;\n      var head = doc.getElementsByTagName('head')[0];\n      try {\n        head.appendChild(injected);\n      } catch (e) {}\n    }\n  };\n\n  var saveDialogContents = \"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n\\n    </div>\\n\\n  </div>\\n\\n</div>\";\n\n  var ControllerFactory = function ControllerFactory(object, property) {\n    var initialValue = object[property];\n    if (Common.isArray(arguments[2]) || Common.isObject(arguments[2])) {\n      return new OptionController(object, property, arguments[2]);\n    }\n    if (Common.isNumber(initialValue)) {\n      if (Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])) {\n        if (Common.isNumber(arguments[4])) {\n          return new NumberControllerSlider(object, property, arguments[2], arguments[3], arguments[4]);\n        }\n        return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\n      }\n      if (Common.isNumber(arguments[4])) {\n        return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3], step: arguments[4] });\n      }\n      return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\n    }\n    if (Common.isString(initialValue)) {\n      return new StringController(object, property);\n    }\n    if (Common.isFunction(initialValue)) {\n      return new FunctionController(object, property, '');\n    }\n    if (Common.isBoolean(initialValue)) {\n      return new BooleanController(object, property);\n    }\n    return null;\n  };\n\n  function requestAnimationFrame(callback) {\n    setTimeout(callback, 1000 / 60);\n  }\n  var requestAnimationFrame$1 = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;\n\n  var CenteredDiv = function () {\n    function CenteredDiv() {\n      classCallCheck(this, CenteredDiv);\n      this.backgroundElement = document.createElement('div');\n      Common.extend(this.backgroundElement.style, {\n        backgroundColor: 'rgba(0,0,0,0.8)',\n        top: 0,\n        left: 0,\n        display: 'none',\n        zIndex: '1000',\n        opacity: 0,\n        WebkitTransition: 'opacity 0.2s linear',\n        transition: 'opacity 0.2s linear'\n      });\n      dom.makeFullscreen(this.backgroundElement);\n      this.backgroundElement.style.position = 'fixed';\n      this.domElement = document.createElement('div');\n      Common.extend(this.domElement.style, {\n        position: 'fixed',\n        display: 'none',\n        zIndex: '1001',\n        opacity: 0,\n        WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\n        transition: 'transform 0.2s ease-out, opacity 0.2s linear'\n      });\n      document.body.appendChild(this.backgroundElement);\n      document.body.appendChild(this.domElement);\n      var _this = this;\n      dom.bind(this.backgroundElement, 'click', function () {\n        _this.hide();\n      });\n    }\n    createClass(CenteredDiv, [{\n      key: 'show',\n      value: function show() {\n        var _this = this;\n        this.backgroundElement.style.display = 'block';\n        this.domElement.style.display = 'block';\n        this.domElement.style.opacity = 0;\n        this.domElement.style.webkitTransform = 'scale(1.1)';\n        this.layout();\n        Common.defer(function () {\n          _this.backgroundElement.style.opacity = 1;\n          _this.domElement.style.opacity = 1;\n          _this.domElement.style.webkitTransform = 'scale(1)';\n        });\n      }\n    }, {\n      key: 'hide',\n      value: function hide() {\n        var _this = this;\n        var hide = function hide() {\n          _this.domElement.style.display = 'none';\n          _this.backgroundElement.style.display = 'none';\n          dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\n          dom.unbind(_this.domElement, 'transitionend', hide);\n          dom.unbind(_this.domElement, 'oTransitionEnd', hide);\n        };\n        dom.bind(this.domElement, 'webkitTransitionEnd', hide);\n        dom.bind(this.domElement, 'transitionend', hide);\n        dom.bind(this.domElement, 'oTransitionEnd', hide);\n        this.backgroundElement.style.opacity = 0;\n        this.domElement.style.opacity = 0;\n        this.domElement.style.webkitTransform = 'scale(1.1)';\n      }\n    }, {\n      key: 'layout',\n      value: function layout() {\n        this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\n        this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\n      }\n    }]);\n    return CenteredDiv;\n  }();\n\n  var styleSheet = ___$insertStyle(\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid transparent}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\");\n\n  css.inject(styleSheet);\n  var CSS_NAMESPACE = 'dg';\n  var HIDE_KEY_CODE = 72;\n  var CLOSE_BUTTON_HEIGHT = 20;\n  var DEFAULT_DEFAULT_PRESET_NAME = 'Default';\n  var SUPPORTS_LOCAL_STORAGE = function () {\n    try {\n      return 'localStorage' in window && window.localStorage !== null;\n    } catch (e) {\n      return false;\n    }\n  }();\n  var SAVE_DIALOGUE = void 0;\n  var autoPlaceVirgin = true;\n  var autoPlaceContainer = void 0;\n  var hide = false;\n  var hideableGuis = [];\n  var GUI = function GUI(pars) {\n    var _this = this;\n    var params = pars || {};\n    this.domElement = document.createElement('div');\n    this.__ul = document.createElement('ul');\n    this.domElement.appendChild(this.__ul);\n    dom.addClass(this.domElement, CSS_NAMESPACE);\n    this.__folders = {};\n    this.__controllers = [];\n    this.__rememberedObjects = [];\n    this.__rememberedObjectIndecesToControllers = [];\n    this.__listening = [];\n    params = Common.defaults(params, {\n      closeOnTop: false,\n      autoPlace: true,\n      width: GUI.DEFAULT_WIDTH\n    });\n    params = Common.defaults(params, {\n      resizable: params.autoPlace,\n      hideable: params.autoPlace\n    });\n    if (!Common.isUndefined(params.load)) {\n      if (params.preset) {\n        params.load.preset = params.preset;\n      }\n    } else {\n      params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\n    }\n    if (Common.isUndefined(params.parent) && params.hideable) {\n      hideableGuis.push(this);\n    }\n    params.resizable = Common.isUndefined(params.parent) && params.resizable;\n    if (params.autoPlace && Common.isUndefined(params.scrollable)) {\n      params.scrollable = true;\n    }\n    var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\n    var saveToLocalStorage = void 0;\n    Object.defineProperties(this, {\n      parent: {\n        get: function get$$1() {\n          return params.parent;\n        }\n      },\n      scrollable: {\n        get: function get$$1() {\n          return params.scrollable;\n        }\n      },\n      autoPlace: {\n        get: function get$$1() {\n          return params.autoPlace;\n        }\n      },\n      closeOnTop: {\n        get: function get$$1() {\n          return params.closeOnTop;\n        }\n      },\n      preset: {\n        get: function get$$1() {\n          if (_this.parent) {\n            return _this.getRoot().preset;\n          }\n          return params.load.preset;\n        },\n        set: function set$$1(v) {\n          if (_this.parent) {\n            _this.getRoot().preset = v;\n          } else {\n            params.load.preset = v;\n          }\n          setPresetSelectIndex(this);\n          _this.revert();\n        }\n      },\n      width: {\n        get: function get$$1() {\n          return params.width;\n        },\n        set: function set$$1(v) {\n          params.width = v;\n          setWidth(_this, v);\n        }\n      },\n      name: {\n        get: function get$$1() {\n          return params.name;\n        },\n        set: function set$$1(v) {\n          params.name = v;\n          if (titleRowName) {\n            titleRowName.innerHTML = params.name;\n          }\n        }\n      },\n      closed: {\n        get: function get$$1() {\n          return params.closed;\n        },\n        set: function set$$1(v) {\n          params.closed = v;\n          if (params.closed) {\n            dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\n          } else {\n            dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\n          }\n          this.onResize();\n          if (_this.__closeButton) {\n            _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\n          }\n        }\n      },\n      load: {\n        get: function get$$1() {\n          return params.load;\n        }\n      },\n      useLocalStorage: {\n        get: function get$$1() {\n          return useLocalStorage;\n        },\n        set: function set$$1(bool) {\n          if (SUPPORTS_LOCAL_STORAGE) {\n            useLocalStorage = bool;\n            if (bool) {\n              dom.bind(window, 'unload', saveToLocalStorage);\n            } else {\n              dom.unbind(window, 'unload', saveToLocalStorage);\n            }\n            localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\n          }\n        }\n      }\n    });\n    if (Common.isUndefined(params.parent)) {\n      params.closed = false;\n      dom.addClass(this.domElement, GUI.CLASS_MAIN);\n      dom.makeSelectable(this.domElement, false);\n      if (SUPPORTS_LOCAL_STORAGE) {\n        if (useLocalStorage) {\n          _this.useLocalStorage = true;\n          var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\n          if (savedGui) {\n            params.load = JSON.parse(savedGui);\n          }\n        }\n      }\n      this.__closeButton = document.createElement('div');\n      this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\n      if (params.closeOnTop) {\n        dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\n        this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\n      } else {\n        dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\n        this.domElement.appendChild(this.__closeButton);\n      }\n      dom.bind(this.__closeButton, 'click', function () {\n        _this.closed = !_this.closed;\n      });\n    } else {\n      if (params.closed === undefined) {\n        params.closed = true;\n      }\n      var _titleRowName = document.createTextNode(params.name);\n      dom.addClass(_titleRowName, 'controller-name');\n      var titleRow = addRow(_this, _titleRowName);\n      var onClickTitle = function onClickTitle(e) {\n        e.preventDefault();\n        _this.closed = !_this.closed;\n        return false;\n      };\n      dom.addClass(this.__ul, GUI.CLASS_CLOSED);\n      dom.addClass(titleRow, 'title');\n      dom.bind(titleRow, 'click', onClickTitle);\n      if (!params.closed) {\n        this.closed = false;\n      }\n    }\n    if (params.autoPlace) {\n      if (Common.isUndefined(params.parent)) {\n        if (autoPlaceVirgin) {\n          autoPlaceContainer = document.createElement('div');\n          dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\n          dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\n          document.body.appendChild(autoPlaceContainer);\n          autoPlaceVirgin = false;\n        }\n        autoPlaceContainer.appendChild(this.domElement);\n        dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\n      }\n      if (!this.parent) {\n        setWidth(_this, params.width);\n      }\n    }\n    this.__resizeHandler = function () {\n      _this.onResizeDebounced();\n    };\n    dom.bind(window, 'resize', this.__resizeHandler);\n    dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\n    dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\n    dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\n    this.onResize();\n    if (params.resizable) {\n      addResizeHandle(this);\n    }\n    saveToLocalStorage = function saveToLocalStorage() {\n      if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\n        localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\n      }\n    };\n    this.saveToLocalStorageIfPossible = saveToLocalStorage;\n    function resetWidth() {\n      var root = _this.getRoot();\n      root.width += 1;\n      Common.defer(function () {\n        root.width -= 1;\n      });\n    }\n    if (!params.parent) {\n      resetWidth();\n    }\n  };\n  GUI.toggleHide = function () {\n    hide = !hide;\n    Common.each(hideableGuis, function (gui) {\n      gui.domElement.style.display = hide ? 'none' : '';\n    });\n  };\n  GUI.CLASS_AUTO_PLACE = 'a';\n  GUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\n  GUI.CLASS_MAIN = 'main';\n  GUI.CLASS_CONTROLLER_ROW = 'cr';\n  GUI.CLASS_TOO_TALL = 'taller-than-window';\n  GUI.CLASS_CLOSED = 'closed';\n  GUI.CLASS_CLOSE_BUTTON = 'close-button';\n  GUI.CLASS_CLOSE_TOP = 'close-top';\n  GUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\n  GUI.CLASS_DRAG = 'drag';\n  GUI.DEFAULT_WIDTH = 245;\n  GUI.TEXT_CLOSED = 'Close Controls';\n  GUI.TEXT_OPEN = 'Open Controls';\n  GUI._keydownHandler = function (e) {\n    if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\n      GUI.toggleHide();\n    }\n  };\n  dom.bind(window, 'keydown', GUI._keydownHandler, false);\n  Common.extend(GUI.prototype, {\n    add: function add(object, property) {\n      return _add(this, object, property, {\n        factoryArgs: Array.prototype.slice.call(arguments, 2)\n      });\n    },\n    addColor: function addColor(object, property) {\n      return _add(this, object, property, {\n        color: true\n      });\n    },\n    remove: function remove(controller) {\n      this.__ul.removeChild(controller.__li);\n      this.__controllers.splice(this.__controllers.indexOf(controller), 1);\n      var _this = this;\n      Common.defer(function () {\n        _this.onResize();\n      });\n    },\n    destroy: function destroy() {\n      if (this.parent) {\n        throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\n      }\n      if (this.autoPlace) {\n        autoPlaceContainer.removeChild(this.domElement);\n      }\n      var _this = this;\n      Common.each(this.__folders, function (subfolder) {\n        _this.removeFolder(subfolder);\n      });\n      dom.unbind(window, 'keydown', GUI._keydownHandler, false);\n      removeListeners(this);\n    },\n    addFolder: function addFolder(name) {\n      if (this.__folders[name] !== undefined) {\n        throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\n      }\n      var newGuiParams = { name: name, parent: this };\n      newGuiParams.autoPlace = this.autoPlace;\n      if (this.load && this.load.folders && this.load.folders[name]) {\n        newGuiParams.closed = this.load.folders[name].closed;\n        newGuiParams.load = this.load.folders[name];\n      }\n      var gui = new GUI(newGuiParams);\n      this.__folders[name] = gui;\n      var li = addRow(this, gui.domElement);\n      dom.addClass(li, 'folder');\n      return gui;\n    },\n    removeFolder: function removeFolder(folder) {\n      this.__ul.removeChild(folder.domElement.parentElement);\n      delete this.__folders[folder.name];\n      if (this.load && this.load.folders && this.load.folders[folder.name]) {\n        delete this.load.folders[folder.name];\n      }\n      removeListeners(folder);\n      var _this = this;\n      Common.each(folder.__folders, function (subfolder) {\n        folder.removeFolder(subfolder);\n      });\n      Common.defer(function () {\n        _this.onResize();\n      });\n    },\n    open: function open() {\n      this.closed = false;\n    },\n    close: function close() {\n      this.closed = true;\n    },\n    onResize: function onResize() {\n      var root = this.getRoot();\n      if (root.scrollable) {\n        var top = dom.getOffset(root.__ul).top;\n        var h = 0;\n        Common.each(root.__ul.childNodes, function (node) {\n          if (!(root.autoPlace && node === root.__save_row)) {\n            h += dom.getHeight(node);\n          }\n        });\n        if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\n          dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\n          root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\n        } else {\n          dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\n          root.__ul.style.height = 'auto';\n        }\n      }\n      if (root.__resize_handle) {\n        Common.defer(function () {\n          root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\n        });\n      }\n      if (root.__closeButton) {\n        root.__closeButton.style.width = root.width + 'px';\n      }\n    },\n    onResizeDebounced: Common.debounce(function () {\n      this.onResize();\n    }, 50),\n    remember: function remember() {\n      if (Common.isUndefined(SAVE_DIALOGUE)) {\n        SAVE_DIALOGUE = new CenteredDiv();\n        SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents;\n      }\n      if (this.parent) {\n        throw new Error('You can only call remember on a top level GUI.');\n      }\n      var _this = this;\n      Common.each(Array.prototype.slice.call(arguments), function (object) {\n        if (_this.__rememberedObjects.length === 0) {\n          addSaveMenu(_this);\n        }\n        if (_this.__rememberedObjects.indexOf(object) === -1) {\n          _this.__rememberedObjects.push(object);\n        }\n      });\n      if (this.autoPlace) {\n        setWidth(this, this.width);\n      }\n    },\n    getRoot: function getRoot() {\n      var gui = this;\n      while (gui.parent) {\n        gui = gui.parent;\n      }\n      return gui;\n    },\n    getSaveObject: function getSaveObject() {\n      var toReturn = this.load;\n      toReturn.closed = this.closed;\n      if (this.__rememberedObjects.length > 0) {\n        toReturn.preset = this.preset;\n        if (!toReturn.remembered) {\n          toReturn.remembered = {};\n        }\n        toReturn.remembered[this.preset] = getCurrentPreset(this);\n      }\n      toReturn.folders = {};\n      Common.each(this.__folders, function (element, key) {\n        toReturn.folders[key] = element.getSaveObject();\n      });\n      return toReturn;\n    },\n    save: function save() {\n      if (!this.load.remembered) {\n        this.load.remembered = {};\n      }\n      this.load.remembered[this.preset] = getCurrentPreset(this);\n      markPresetModified(this, false);\n      this.saveToLocalStorageIfPossible();\n    },\n    saveAs: function saveAs(presetName) {\n      if (!this.load.remembered) {\n        this.load.remembered = {};\n        this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\n      }\n      this.load.remembered[presetName] = getCurrentPreset(this);\n      this.preset = presetName;\n      addPresetOption(this, presetName, true);\n      this.saveToLocalStorageIfPossible();\n    },\n    revert: function revert(gui) {\n      Common.each(this.__controllers, function (controller) {\n        if (!this.getRoot().load.remembered) {\n          controller.setValue(controller.initialValue);\n        } else {\n          recallSavedValue(gui || this.getRoot(), controller);\n        }\n        if (controller.__onFinishChange) {\n          controller.__onFinishChange.call(controller, controller.getValue());\n        }\n      }, this);\n      Common.each(this.__folders, function (folder) {\n        folder.revert(folder);\n      });\n      if (!gui) {\n        markPresetModified(this.getRoot(), false);\n      }\n    },\n    listen: function listen(controller) {\n      var init = this.__listening.length === 0;\n      this.__listening.push(controller);\n      if (init) {\n        updateDisplays(this.__listening);\n      }\n    },\n    updateDisplay: function updateDisplay() {\n      Common.each(this.__controllers, function (controller) {\n        controller.updateDisplay();\n      });\n      Common.each(this.__folders, function (folder) {\n        folder.updateDisplay();\n      });\n    }\n  });\n  function addRow(gui, newDom, liBefore) {\n    var li = document.createElement('li');\n    if (newDom) {\n      li.appendChild(newDom);\n    }\n    if (liBefore) {\n      gui.__ul.insertBefore(li, liBefore);\n    } else {\n      gui.__ul.appendChild(li);\n    }\n    gui.onResize();\n    return li;\n  }\n  function removeListeners(gui) {\n    dom.unbind(window, 'resize', gui.__resizeHandler);\n    if (gui.saveToLocalStorageIfPossible) {\n      dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\n    }\n  }\n  function markPresetModified(gui, modified) {\n    var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\n    if (modified) {\n      opt.innerHTML = opt.value + '*';\n    } else {\n      opt.innerHTML = opt.value;\n    }\n  }\n  function augmentController(gui, li, controller) {\n    controller.__li = li;\n    controller.__gui = gui;\n    Common.extend(controller, {\n      options: function options(_options) {\n        if (arguments.length > 1) {\n          var nextSibling = controller.__li.nextElementSibling;\n          controller.remove();\n          return _add(gui, controller.object, controller.property, {\n            before: nextSibling,\n            factoryArgs: [Common.toArray(arguments)]\n          });\n        }\n        if (Common.isArray(_options) || Common.isObject(_options)) {\n          var _nextSibling = controller.__li.nextElementSibling;\n          controller.remove();\n          return _add(gui, controller.object, controller.property, {\n            before: _nextSibling,\n            factoryArgs: [_options]\n          });\n        }\n      },\n      name: function name(_name) {\n        controller.__li.firstElementChild.firstElementChild.innerHTML = _name;\n        return controller;\n      },\n      listen: function listen() {\n        controller.__gui.listen(controller);\n        return controller;\n      },\n      remove: function remove() {\n        controller.__gui.remove(controller);\n        return controller;\n      }\n    });\n    if (controller instanceof NumberControllerSlider) {\n      var box = new NumberControllerBox(controller.object, controller.property, { min: controller.__min, max: controller.__max, step: controller.__step });\n      Common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step'], function (method) {\n        var pc = controller[method];\n        var pb = box[method];\n        controller[method] = box[method] = function () {\n          var args = Array.prototype.slice.call(arguments);\n          pb.apply(box, args);\n          return pc.apply(controller, args);\n        };\n      });\n      dom.addClass(li, 'has-slider');\n      controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\n    } else if (controller instanceof NumberControllerBox) {\n      var r = function r(returned) {\n        if (Common.isNumber(controller.__min) && Common.isNumber(controller.__max)) {\n          var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\n          var wasListening = controller.__gui.__listening.indexOf(controller) > -1;\n          controller.remove();\n          var newController = _add(gui, controller.object, controller.property, {\n            before: controller.__li.nextElementSibling,\n            factoryArgs: [controller.__min, controller.__max, controller.__step]\n          });\n          newController.name(oldName);\n          if (wasListening) newController.listen();\n          return newController;\n        }\n        return returned;\n      };\n      controller.min = Common.compose(r, controller.min);\n      controller.max = Common.compose(r, controller.max);\n    } else if (controller instanceof BooleanController) {\n      dom.bind(li, 'click', function () {\n        dom.fakeEvent(controller.__checkbox, 'click');\n      });\n      dom.bind(controller.__checkbox, 'click', function (e) {\n        e.stopPropagation();\n      });\n    } else if (controller instanceof FunctionController) {\n      dom.bind(li, 'click', function () {\n        dom.fakeEvent(controller.__button, 'click');\n      });\n      dom.bind(li, 'mouseover', function () {\n        dom.addClass(controller.__button, 'hover');\n      });\n      dom.bind(li, 'mouseout', function () {\n        dom.removeClass(controller.__button, 'hover');\n      });\n    } else if (controller instanceof ColorController) {\n      dom.addClass(li, 'color');\n      controller.updateDisplay = Common.compose(function (val) {\n        li.style.borderLeftColor = controller.__color.toString();\n        return val;\n      }, controller.updateDisplay);\n      controller.updateDisplay();\n    }\n    controller.setValue = Common.compose(function (val) {\n      if (gui.getRoot().__preset_select && controller.isModified()) {\n        markPresetModified(gui.getRoot(), true);\n      }\n      return val;\n    }, controller.setValue);\n  }\n  function recallSavedValue(gui, controller) {\n    var root = gui.getRoot();\n    var matchedIndex = root.__rememberedObjects.indexOf(controller.object);\n    if (matchedIndex !== -1) {\n      var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\n      if (controllerMap === undefined) {\n        controllerMap = {};\n        root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\n      }\n      controllerMap[controller.property] = controller;\n      if (root.load && root.load.remembered) {\n        var presetMap = root.load.remembered;\n        var preset = void 0;\n        if (presetMap[gui.preset]) {\n          preset = presetMap[gui.preset];\n        } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\n          preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\n        } else {\n          return;\n        }\n        if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\n          var value = preset[matchedIndex][controller.property];\n          controller.initialValue = value;\n          controller.setValue(value);\n        }\n      }\n    }\n  }\n  function _add(gui, object, property, params) {\n    if (object[property] === undefined) {\n      throw new Error('Object \"' + object + '\" has no property \"' + property + '\"');\n    }\n    var controller = void 0;\n    if (params.color) {\n      controller = new ColorController(object, property);\n    } else {\n      var factoryArgs = [object, property].concat(params.factoryArgs);\n      controller = ControllerFactory.apply(gui, factoryArgs);\n    }\n    if (params.before instanceof Controller) {\n      params.before = params.before.__li;\n    }\n    recallSavedValue(gui, controller);\n    dom.addClass(controller.domElement, 'c');\n    var name = document.createElement('span');\n    dom.addClass(name, 'property-name');\n    name.innerHTML = controller.property;\n    var container = document.createElement('div');\n    container.appendChild(name);\n    container.appendChild(controller.domElement);\n    var li = addRow(gui, container, params.before);\n    dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\n    if (controller instanceof ColorController) {\n      dom.addClass(li, 'color');\n    } else {\n      dom.addClass(li, _typeof(controller.getValue()));\n    }\n    augmentController(gui, li, controller);\n    gui.__controllers.push(controller);\n    return controller;\n  }\n  function getLocalStorageHash(gui, key) {\n    return document.location.href + '.' + key;\n  }\n  function addPresetOption(gui, name, setSelected) {\n    var opt = document.createElement('option');\n    opt.innerHTML = name;\n    opt.value = name;\n    gui.__preset_select.appendChild(opt);\n    if (setSelected) {\n      gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\n    }\n  }\n  function showHideExplain(gui, explain) {\n    explain.style.display = gui.useLocalStorage ? 'block' : 'none';\n  }\n  function addSaveMenu(gui) {\n    var div = gui.__save_row = document.createElement('li');\n    dom.addClass(gui.domElement, 'has-save');\n    gui.__ul.insertBefore(div, gui.__ul.firstChild);\n    dom.addClass(div, 'save-row');\n    var gears = document.createElement('span');\n    gears.innerHTML = '&nbsp;';\n    dom.addClass(gears, 'button gears');\n    var button = document.createElement('span');\n    button.innerHTML = 'Save';\n    dom.addClass(button, 'button');\n    dom.addClass(button, 'save');\n    var button2 = document.createElement('span');\n    button2.innerHTML = 'New';\n    dom.addClass(button2, 'button');\n    dom.addClass(button2, 'save-as');\n    var button3 = document.createElement('span');\n    button3.innerHTML = 'Revert';\n    dom.addClass(button3, 'button');\n    dom.addClass(button3, 'revert');\n    var select = gui.__preset_select = document.createElement('select');\n    if (gui.load && gui.load.remembered) {\n      Common.each(gui.load.remembered, function (value, key) {\n        addPresetOption(gui, key, key === gui.preset);\n      });\n    } else {\n      addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\n    }\n    dom.bind(select, 'change', function () {\n      for (var index = 0; index < gui.__preset_select.length; index++) {\n        gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\n      }\n      gui.preset = this.value;\n    });\n    div.appendChild(select);\n    div.appendChild(gears);\n    div.appendChild(button);\n    div.appendChild(button2);\n    div.appendChild(button3);\n    if (SUPPORTS_LOCAL_STORAGE) {\n      var explain = document.getElementById('dg-local-explain');\n      var localStorageCheckBox = document.getElementById('dg-local-storage');\n      var saveLocally = document.getElementById('dg-save-locally');\n      saveLocally.style.display = 'block';\n      if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\n        localStorageCheckBox.setAttribute('checked', 'checked');\n      }\n      showHideExplain(gui, explain);\n      dom.bind(localStorageCheckBox, 'change', function () {\n        gui.useLocalStorage = !gui.useLocalStorage;\n        showHideExplain(gui, explain);\n      });\n    }\n    var newConstructorTextArea = document.getElementById('dg-new-constructor');\n    dom.bind(newConstructorTextArea, 'keydown', function (e) {\n      if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\n        SAVE_DIALOGUE.hide();\n      }\n    });\n    dom.bind(gears, 'click', function () {\n      newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\n      SAVE_DIALOGUE.show();\n      newConstructorTextArea.focus();\n      newConstructorTextArea.select();\n    });\n    dom.bind(button, 'click', function () {\n      gui.save();\n    });\n    dom.bind(button2, 'click', function () {\n      var presetName = prompt('Enter a new preset name.');\n      if (presetName) {\n        gui.saveAs(presetName);\n      }\n    });\n    dom.bind(button3, 'click', function () {\n      gui.revert();\n    });\n  }\n  function addResizeHandle(gui) {\n    var pmouseX = void 0;\n    gui.__resize_handle = document.createElement('div');\n    Common.extend(gui.__resize_handle.style, {\n      width: '6px',\n      marginLeft: '-3px',\n      height: '200px',\n      cursor: 'ew-resize',\n      position: 'absolute'\n    });\n    function drag(e) {\n      e.preventDefault();\n      gui.width += pmouseX - e.clientX;\n      gui.onResize();\n      pmouseX = e.clientX;\n      return false;\n    }\n    function dragStop() {\n      dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\n      dom.unbind(window, 'mousemove', drag);\n      dom.unbind(window, 'mouseup', dragStop);\n    }\n    function dragStart(e) {\n      e.preventDefault();\n      pmouseX = e.clientX;\n      dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\n      dom.bind(window, 'mousemove', drag);\n      dom.bind(window, 'mouseup', dragStop);\n      return false;\n    }\n    dom.bind(gui.__resize_handle, 'mousedown', dragStart);\n    dom.bind(gui.__closeButton, 'mousedown', dragStart);\n    gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\n  }\n  function setWidth(gui, w) {\n    gui.domElement.style.width = w + 'px';\n    if (gui.__save_row && gui.autoPlace) {\n      gui.__save_row.style.width = w + 'px';\n    }\n    if (gui.__closeButton) {\n      gui.__closeButton.style.width = w + 'px';\n    }\n  }\n  function getCurrentPreset(gui, useInitialValues) {\n    var toReturn = {};\n    Common.each(gui.__rememberedObjects, function (val, index) {\n      var savedValues = {};\n      var controllerMap = gui.__rememberedObjectIndecesToControllers[index];\n      Common.each(controllerMap, function (controller, property) {\n        savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\n      });\n      toReturn[index] = savedValues;\n    });\n    return toReturn;\n  }\n  function setPresetSelectIndex(gui) {\n    for (var index = 0; index < gui.__preset_select.length; index++) {\n      if (gui.__preset_select[index].value === gui.preset) {\n        gui.__preset_select.selectedIndex = index;\n      }\n    }\n  }\n  function updateDisplays(controllerArray) {\n    if (controllerArray.length !== 0) {\n      requestAnimationFrame$1.call(window, function () {\n        updateDisplays(controllerArray);\n      });\n    }\n    Common.each(controllerArray, function (c) {\n      c.updateDisplay();\n    });\n  }\n\n  var index = {\n    color: {\n      Color: Color,\n      math: ColorMath,\n      interpret: interpret\n    },\n    controllers: {\n      Controller: Controller,\n      BooleanController: BooleanController,\n      OptionController: OptionController,\n      StringController: StringController,\n      NumberController: NumberController,\n      NumberControllerBox: NumberControllerBox,\n      NumberControllerSlider: NumberControllerSlider,\n      FunctionController: FunctionController,\n      ColorController: ColorController\n    },\n    dom: {\n      dom: dom\n    },\n    gui: {\n      GUI: GUI\n    },\n    GUI: GUI\n  };\n\n  return index;\n});\n//# sourceMappingURL=dat.gui.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL2RhdC5ndWkvYnVpbGQvZGF0Lmd1aS5qcz81NzljIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogZGF0LWd1aSBKYXZhU2NyaXB0IENvbnRyb2xsZXIgTGlicmFyeVxuICogaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL2RhdC1ndWlcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSBEYXRhIEFydHMgVGVhbSwgR29vZ2xlIENyZWF0aXZlIExhYlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqL1xuXG4oZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG5cdChnbG9iYWwuZGF0ID0gZmFjdG9yeSgpKTtcbn0odGhpcywgKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBfX18kaW5zZXJ0U3R5bGUoY3NzKSB7XG4gIGlmICghY3NzKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG5cbiAgc3R5bGUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQvY3NzJyk7XG4gIHN0eWxlLmlubmVySFRNTCA9IGNzcztcbiAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG5cbiAgcmV0dXJuIGNzcztcbn1cblxuZnVuY3Rpb24gY29sb3JUb1N0cmluZyAoY29sb3IsIGZvcmNlQ1NTSGV4KSB7XG4gIHZhciBjb2xvckZvcm1hdCA9IGNvbG9yLl9fc3RhdGUuY29udmVyc2lvbk5hbWUudG9TdHJpbmcoKTtcbiAgdmFyIHIgPSBNYXRoLnJvdW5kKGNvbG9yLnIpO1xuICB2YXIgZyA9IE1hdGgucm91bmQoY29sb3IuZyk7XG4gIHZhciBiID0gTWF0aC5yb3VuZChjb2xvci5iKTtcbiAgdmFyIGEgPSBjb2xvci5hO1xuICB2YXIgaCA9IE1hdGgucm91bmQoY29sb3IuaCk7XG4gIHZhciBzID0gY29sb3Iucy50b0ZpeGVkKDEpO1xuICB2YXIgdiA9IGNvbG9yLnYudG9GaXhlZCgxKTtcbiAgaWYgKGZvcmNlQ1NTSGV4IHx8IGNvbG9yRm9ybWF0ID09PSAnVEhSRUVfQ0hBUl9IRVgnIHx8IGNvbG9yRm9ybWF0ID09PSAnU0lYX0NIQVJfSEVYJykge1xuICAgIHZhciBzdHIgPSBjb2xvci5oZXgudG9TdHJpbmcoMTYpO1xuICAgIHdoaWxlIChzdHIubGVuZ3RoIDwgNikge1xuICAgICAgc3RyID0gJzAnICsgc3RyO1xuICAgIH1cbiAgICByZXR1cm4gJyMnICsgc3RyO1xuICB9IGVsc2UgaWYgKGNvbG9yRm9ybWF0ID09PSAnQ1NTX1JHQicpIHtcbiAgICByZXR1cm4gJ3JnYignICsgciArICcsJyArIGcgKyAnLCcgKyBiICsgJyknO1xuICB9IGVsc2UgaWYgKGNvbG9yRm9ybWF0ID09PSAnQ1NTX1JHQkEnKSB7XG4gICAgcmV0dXJuICdyZ2JhKCcgKyByICsgJywnICsgZyArICcsJyArIGIgKyAnLCcgKyBhICsgJyknO1xuICB9IGVsc2UgaWYgKGNvbG9yRm9ybWF0ID09PSAnSEVYJykge1xuICAgIHJldHVybiAnMHgnICsgY29sb3IuaGV4LnRvU3RyaW5nKDE2KTtcbiAgfSBlbHNlIGlmIChjb2xvckZvcm1hdCA9PT0gJ1JHQl9BUlJBWScpIHtcbiAgICByZXR1cm4gJ1snICsgciArICcsJyArIGcgKyAnLCcgKyBiICsgJ10nO1xuICB9IGVsc2UgaWYgKGNvbG9yRm9ybWF0ID09PSAnUkdCQV9BUlJBWScpIHtcbiAgICByZXR1cm4gJ1snICsgciArICcsJyArIGcgKyAnLCcgKyBiICsgJywnICsgYSArICddJztcbiAgfSBlbHNlIGlmIChjb2xvckZvcm1hdCA9PT0gJ1JHQl9PQkonKSB7XG4gICAgcmV0dXJuICd7cjonICsgciArICcsZzonICsgZyArICcsYjonICsgYiArICd9JztcbiAgfSBlbHNlIGlmIChjb2xvckZvcm1hdCA9PT0gJ1JHQkFfT0JKJykge1xuICAgIHJldHVybiAne3I6JyArIHIgKyAnLGc6JyArIGcgKyAnLGI6JyArIGIgKyAnLGE6JyArIGEgKyAnfSc7XG4gIH0gZWxzZSBpZiAoY29sb3JGb3JtYXQgPT09ICdIU1ZfT0JKJykge1xuICAgIHJldHVybiAne2g6JyArIGggKyAnLHM6JyArIHMgKyAnLHY6JyArIHYgKyAnfSc7XG4gIH0gZWxzZSBpZiAoY29sb3JGb3JtYXQgPT09ICdIU1ZBX09CSicpIHtcbiAgICByZXR1cm4gJ3toOicgKyBoICsgJyxzOicgKyBzICsgJyx2OicgKyB2ICsgJyxhOicgKyBhICsgJ30nO1xuICB9XG4gIHJldHVybiAndW5rbm93biBmb3JtYXQnO1xufVxuXG52YXIgQVJSX0VBQ0ggPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaDtcbnZhciBBUlJfU0xJQ0UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG52YXIgQ29tbW9uID0ge1xuICBCUkVBSzoge30sXG4gIGV4dGVuZDogZnVuY3Rpb24gZXh0ZW5kKHRhcmdldCkge1xuICAgIHRoaXMuZWFjaChBUlJfU0xJQ0UuY2FsbChhcmd1bWVudHMsIDEpLCBmdW5jdGlvbiAob2JqKSB7XG4gICAgICB2YXIga2V5cyA9IHRoaXMuaXNPYmplY3Qob2JqKSA/IE9iamVjdC5rZXlzKG9iaikgOiBbXTtcbiAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIGlmICghdGhpcy5pc1VuZGVmaW5lZChvYmpba2V5XSkpIHtcbiAgICAgICAgICB0YXJnZXRba2V5XSA9IG9ialtrZXldO1xuICAgICAgICB9XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sIHRoaXMpO1xuICAgIHJldHVybiB0YXJnZXQ7XG4gIH0sXG4gIGRlZmF1bHRzOiBmdW5jdGlvbiBkZWZhdWx0cyh0YXJnZXQpIHtcbiAgICB0aGlzLmVhY2goQVJSX1NMSUNFLmNhbGwoYXJndW1lbnRzLCAxKSwgZnVuY3Rpb24gKG9iaikge1xuICAgICAgdmFyIGtleXMgPSB0aGlzLmlzT2JqZWN0KG9iaikgPyBPYmplY3Qua2V5cyhvYmopIDogW107XG4gICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICBpZiAodGhpcy5pc1VuZGVmaW5lZCh0YXJnZXRba2V5XSkpIHtcbiAgICAgICAgICB0YXJnZXRba2V5XSA9IG9ialtrZXldO1xuICAgICAgICB9XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sIHRoaXMpO1xuICAgIHJldHVybiB0YXJnZXQ7XG4gIH0sXG4gIGNvbXBvc2U6IGZ1bmN0aW9uIGNvbXBvc2UoKSB7XG4gICAgdmFyIHRvQ2FsbCA9IEFSUl9TTElDRS5jYWxsKGFyZ3VtZW50cyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBhcmdzID0gQVJSX1NMSUNFLmNhbGwoYXJndW1lbnRzKTtcbiAgICAgIGZvciAodmFyIGkgPSB0b0NhbGwubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgYXJncyA9IFt0b0NhbGxbaV0uYXBwbHkodGhpcywgYXJncyldO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFyZ3NbMF07XG4gICAgfTtcbiAgfSxcbiAgZWFjaDogZnVuY3Rpb24gZWFjaChvYmosIGl0ciwgc2NvcGUpIHtcbiAgICBpZiAoIW9iaikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoQVJSX0VBQ0ggJiYgb2JqLmZvckVhY2ggJiYgb2JqLmZvckVhY2ggPT09IEFSUl9FQUNIKSB7XG4gICAgICBvYmouZm9yRWFjaChpdHIsIHNjb3BlKTtcbiAgICB9IGVsc2UgaWYgKG9iai5sZW5ndGggPT09IG9iai5sZW5ndGggKyAwKSB7XG4gICAgICB2YXIga2V5ID0gdm9pZCAwO1xuICAgICAgdmFyIGwgPSB2b2lkIDA7XG4gICAgICBmb3IgKGtleSA9IDAsIGwgPSBvYmoubGVuZ3RoOyBrZXkgPCBsOyBrZXkrKykge1xuICAgICAgICBpZiAoa2V5IGluIG9iaiAmJiBpdHIuY2FsbChzY29wZSwgb2JqW2tleV0sIGtleSkgPT09IHRoaXMuQlJFQUspIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZm9yICh2YXIgX2tleSBpbiBvYmopIHtcbiAgICAgICAgaWYgKGl0ci5jYWxsKHNjb3BlLCBvYmpbX2tleV0sIF9rZXkpID09PSB0aGlzLkJSRUFLKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBkZWZlcjogZnVuY3Rpb24gZGVmZXIoZm5jKSB7XG4gICAgc2V0VGltZW91dChmbmMsIDApO1xuICB9LFxuICBkZWJvdW5jZTogZnVuY3Rpb24gZGVib3VuY2UoZnVuYywgdGhyZXNob2xkLCBjYWxsSW1tZWRpYXRlbHkpIHtcbiAgICB2YXIgdGltZW91dCA9IHZvaWQgMDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIG9iaiA9IHRoaXM7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIGZ1bmN0aW9uIGRlbGF5ZWQoKSB7XG4gICAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgICBpZiAoIWNhbGxJbW1lZGlhdGVseSkgZnVuYy5hcHBseShvYmosIGFyZ3MpO1xuICAgICAgfVxuICAgICAgdmFyIGNhbGxOb3cgPSBjYWxsSW1tZWRpYXRlbHkgfHwgIXRpbWVvdXQ7XG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChkZWxheWVkLCB0aHJlc2hvbGQpO1xuICAgICAgaWYgKGNhbGxOb3cpIHtcbiAgICAgICAgZnVuYy5hcHBseShvYmosIGFyZ3MpO1xuICAgICAgfVxuICAgIH07XG4gIH0sXG4gIHRvQXJyYXk6IGZ1bmN0aW9uIHRvQXJyYXkob2JqKSB7XG4gICAgaWYgKG9iai50b0FycmF5KSByZXR1cm4gb2JqLnRvQXJyYXkoKTtcbiAgICByZXR1cm4gQVJSX1NMSUNFLmNhbGwob2JqKTtcbiAgfSxcbiAgaXNVbmRlZmluZWQ6IGZ1bmN0aW9uIGlzVW5kZWZpbmVkKG9iaikge1xuICAgIHJldHVybiBvYmogPT09IHVuZGVmaW5lZDtcbiAgfSxcbiAgaXNOdWxsOiBmdW5jdGlvbiBpc051bGwob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gbnVsbDtcbiAgfSxcbiAgaXNOYU46IGZ1bmN0aW9uIChfaXNOYU4pIHtcbiAgICBmdW5jdGlvbiBpc05hTihfeCkge1xuICAgICAgcmV0dXJuIF9pc05hTi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgICBpc05hTi50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfaXNOYU4udG9TdHJpbmcoKTtcbiAgICB9O1xuICAgIHJldHVybiBpc05hTjtcbiAgfShmdW5jdGlvbiAob2JqKSB7XG4gICAgcmV0dXJuIGlzTmFOKG9iaik7XG4gIH0pLFxuICBpc0FycmF5OiBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChvYmopIHtcbiAgICByZXR1cm4gb2JqLmNvbnN0cnVjdG9yID09PSBBcnJheTtcbiAgfSxcbiAgaXNPYmplY3Q6IGZ1bmN0aW9uIGlzT2JqZWN0KG9iaikge1xuICAgIHJldHVybiBvYmogPT09IE9iamVjdChvYmopO1xuICB9LFxuICBpc051bWJlcjogZnVuY3Rpb24gaXNOdW1iZXIob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gb2JqICsgMDtcbiAgfSxcbiAgaXNTdHJpbmc6IGZ1bmN0aW9uIGlzU3RyaW5nKG9iaikge1xuICAgIHJldHVybiBvYmogPT09IG9iaiArICcnO1xuICB9LFxuICBpc0Jvb2xlYW46IGZ1bmN0aW9uIGlzQm9vbGVhbihvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSBmYWxzZSB8fCBvYmogPT09IHRydWU7XG4gIH0sXG4gIGlzRnVuY3Rpb246IGZ1bmN0aW9uIGlzRnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopID09PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuICB9XG59O1xuXG52YXIgSU5URVJQUkVUQVRJT05TID0gW1xue1xuICBsaXRtdXM6IENvbW1vbi5pc1N0cmluZyxcbiAgY29udmVyc2lvbnM6IHtcbiAgICBUSFJFRV9DSEFSX0hFWDoge1xuICAgICAgcmVhZDogZnVuY3Rpb24gcmVhZChvcmlnaW5hbCkge1xuICAgICAgICB2YXIgdGVzdCA9IG9yaWdpbmFsLm1hdGNoKC9eIyhbQS1GMC05XSkoW0EtRjAtOV0pKFtBLUYwLTldKSQvaSk7XG4gICAgICAgIGlmICh0ZXN0ID09PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3BhY2U6ICdIRVgnLFxuICAgICAgICAgIGhleDogcGFyc2VJbnQoJzB4JyArIHRlc3RbMV0udG9TdHJpbmcoKSArIHRlc3RbMV0udG9TdHJpbmcoKSArIHRlc3RbMl0udG9TdHJpbmcoKSArIHRlc3RbMl0udG9TdHJpbmcoKSArIHRlc3RbM10udG9TdHJpbmcoKSArIHRlc3RbM10udG9TdHJpbmcoKSwgMClcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICB3cml0ZTogY29sb3JUb1N0cmluZ1xuICAgIH0sXG4gICAgU0lYX0NIQVJfSEVYOiB7XG4gICAgICByZWFkOiBmdW5jdGlvbiByZWFkKG9yaWdpbmFsKSB7XG4gICAgICAgIHZhciB0ZXN0ID0gb3JpZ2luYWwubWF0Y2goL14jKFtBLUYwLTldezZ9KSQvaSk7XG4gICAgICAgIGlmICh0ZXN0ID09PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3BhY2U6ICdIRVgnLFxuICAgICAgICAgIGhleDogcGFyc2VJbnQoJzB4JyArIHRlc3RbMV0udG9TdHJpbmcoKSwgMClcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICB3cml0ZTogY29sb3JUb1N0cmluZ1xuICAgIH0sXG4gICAgQ1NTX1JHQjoge1xuICAgICAgcmVhZDogZnVuY3Rpb24gcmVhZChvcmlnaW5hbCkge1xuICAgICAgICB2YXIgdGVzdCA9IG9yaWdpbmFsLm1hdGNoKC9ecmdiXFwoXFxzKiguKylcXHMqLFxccyooLispXFxzKixcXHMqKC4rKVxccypcXCkvKTtcbiAgICAgICAgaWYgKHRlc3QgPT09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzcGFjZTogJ1JHQicsXG4gICAgICAgICAgcjogcGFyc2VGbG9hdCh0ZXN0WzFdKSxcbiAgICAgICAgICBnOiBwYXJzZUZsb2F0KHRlc3RbMl0pLFxuICAgICAgICAgIGI6IHBhcnNlRmxvYXQodGVzdFszXSlcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICB3cml0ZTogY29sb3JUb1N0cmluZ1xuICAgIH0sXG4gICAgQ1NTX1JHQkE6IHtcbiAgICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQob3JpZ2luYWwpIHtcbiAgICAgICAgdmFyIHRlc3QgPSBvcmlnaW5hbC5tYXRjaCgvXnJnYmFcXChcXHMqKC4rKVxccyosXFxzKiguKylcXHMqLFxccyooLispXFxzKixcXHMqKC4rKVxccypcXCkvKTtcbiAgICAgICAgaWYgKHRlc3QgPT09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzcGFjZTogJ1JHQicsXG4gICAgICAgICAgcjogcGFyc2VGbG9hdCh0ZXN0WzFdKSxcbiAgICAgICAgICBnOiBwYXJzZUZsb2F0KHRlc3RbMl0pLFxuICAgICAgICAgIGI6IHBhcnNlRmxvYXQodGVzdFszXSksXG4gICAgICAgICAgYTogcGFyc2VGbG9hdCh0ZXN0WzRdKVxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHdyaXRlOiBjb2xvclRvU3RyaW5nXG4gICAgfVxuICB9XG59LFxue1xuICBsaXRtdXM6IENvbW1vbi5pc051bWJlcixcbiAgY29udmVyc2lvbnM6IHtcbiAgICBIRVg6IHtcbiAgICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQob3JpZ2luYWwpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzcGFjZTogJ0hFWCcsXG4gICAgICAgICAgaGV4OiBvcmlnaW5hbCxcbiAgICAgICAgICBjb252ZXJzaW9uTmFtZTogJ0hFWCdcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICB3cml0ZTogZnVuY3Rpb24gd3JpdGUoY29sb3IpIHtcbiAgICAgICAgcmV0dXJuIGNvbG9yLmhleDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0sXG57XG4gIGxpdG11czogQ29tbW9uLmlzQXJyYXksXG4gIGNvbnZlcnNpb25zOiB7XG4gICAgUkdCX0FSUkFZOiB7XG4gICAgICByZWFkOiBmdW5jdGlvbiByZWFkKG9yaWdpbmFsKSB7XG4gICAgICAgIGlmIChvcmlnaW5hbC5sZW5ndGggIT09IDMpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzcGFjZTogJ1JHQicsXG4gICAgICAgICAgcjogb3JpZ2luYWxbMF0sXG4gICAgICAgICAgZzogb3JpZ2luYWxbMV0sXG4gICAgICAgICAgYjogb3JpZ2luYWxbMl1cbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICB3cml0ZTogZnVuY3Rpb24gd3JpdGUoY29sb3IpIHtcbiAgICAgICAgcmV0dXJuIFtjb2xvci5yLCBjb2xvci5nLCBjb2xvci5iXTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFJHQkFfQVJSQVk6IHtcbiAgICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQob3JpZ2luYWwpIHtcbiAgICAgICAgaWYgKG9yaWdpbmFsLmxlbmd0aCAhPT0gNCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHNwYWNlOiAnUkdCJyxcbiAgICAgICAgICByOiBvcmlnaW5hbFswXSxcbiAgICAgICAgICBnOiBvcmlnaW5hbFsxXSxcbiAgICAgICAgICBiOiBvcmlnaW5hbFsyXSxcbiAgICAgICAgICBhOiBvcmlnaW5hbFszXVxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZShjb2xvcikge1xuICAgICAgICByZXR1cm4gW2NvbG9yLnIsIGNvbG9yLmcsIGNvbG9yLmIsIGNvbG9yLmFdO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSxcbntcbiAgbGl0bXVzOiBDb21tb24uaXNPYmplY3QsXG4gIGNvbnZlcnNpb25zOiB7XG4gICAgUkdCQV9PQko6IHtcbiAgICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQob3JpZ2luYWwpIHtcbiAgICAgICAgaWYgKENvbW1vbi5pc051bWJlcihvcmlnaW5hbC5yKSAmJiBDb21tb24uaXNOdW1iZXIob3JpZ2luYWwuZykgJiYgQ29tbW9uLmlzTnVtYmVyKG9yaWdpbmFsLmIpICYmIENvbW1vbi5pc051bWJlcihvcmlnaW5hbC5hKSkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzcGFjZTogJ1JHQicsXG4gICAgICAgICAgICByOiBvcmlnaW5hbC5yLFxuICAgICAgICAgICAgZzogb3JpZ2luYWwuZyxcbiAgICAgICAgICAgIGI6IG9yaWdpbmFsLmIsXG4gICAgICAgICAgICBhOiBvcmlnaW5hbC5hXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9LFxuICAgICAgd3JpdGU6IGZ1bmN0aW9uIHdyaXRlKGNvbG9yKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcjogY29sb3IucixcbiAgICAgICAgICBnOiBjb2xvci5nLFxuICAgICAgICAgIGI6IGNvbG9yLmIsXG4gICAgICAgICAgYTogY29sb3IuYVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sXG4gICAgUkdCX09CSjoge1xuICAgICAgcmVhZDogZnVuY3Rpb24gcmVhZChvcmlnaW5hbCkge1xuICAgICAgICBpZiAoQ29tbW9uLmlzTnVtYmVyKG9yaWdpbmFsLnIpICYmIENvbW1vbi5pc051bWJlcihvcmlnaW5hbC5nKSAmJiBDb21tb24uaXNOdW1iZXIob3JpZ2luYWwuYikpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3BhY2U6ICdSR0InLFxuICAgICAgICAgICAgcjogb3JpZ2luYWwucixcbiAgICAgICAgICAgIGc6IG9yaWdpbmFsLmcsXG4gICAgICAgICAgICBiOiBvcmlnaW5hbC5iXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9LFxuICAgICAgd3JpdGU6IGZ1bmN0aW9uIHdyaXRlKGNvbG9yKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcjogY29sb3IucixcbiAgICAgICAgICBnOiBjb2xvci5nLFxuICAgICAgICAgIGI6IGNvbG9yLmJcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9LFxuICAgIEhTVkFfT0JKOiB7XG4gICAgICByZWFkOiBmdW5jdGlvbiByZWFkKG9yaWdpbmFsKSB7XG4gICAgICAgIGlmIChDb21tb24uaXNOdW1iZXIob3JpZ2luYWwuaCkgJiYgQ29tbW9uLmlzTnVtYmVyKG9yaWdpbmFsLnMpICYmIENvbW1vbi5pc051bWJlcihvcmlnaW5hbC52KSAmJiBDb21tb24uaXNOdW1iZXIob3JpZ2luYWwuYSkpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3BhY2U6ICdIU1YnLFxuICAgICAgICAgICAgaDogb3JpZ2luYWwuaCxcbiAgICAgICAgICAgIHM6IG9yaWdpbmFsLnMsXG4gICAgICAgICAgICB2OiBvcmlnaW5hbC52LFxuICAgICAgICAgICAgYTogb3JpZ2luYWwuYVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSxcbiAgICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZShjb2xvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGg6IGNvbG9yLmgsXG4gICAgICAgICAgczogY29sb3IucyxcbiAgICAgICAgICB2OiBjb2xvci52LFxuICAgICAgICAgIGE6IGNvbG9yLmFcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9LFxuICAgIEhTVl9PQko6IHtcbiAgICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQob3JpZ2luYWwpIHtcbiAgICAgICAgaWYgKENvbW1vbi5pc051bWJlcihvcmlnaW5hbC5oKSAmJiBDb21tb24uaXNOdW1iZXIob3JpZ2luYWwucykgJiYgQ29tbW9uLmlzTnVtYmVyKG9yaWdpbmFsLnYpKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNwYWNlOiAnSFNWJyxcbiAgICAgICAgICAgIGg6IG9yaWdpbmFsLmgsXG4gICAgICAgICAgICBzOiBvcmlnaW5hbC5zLFxuICAgICAgICAgICAgdjogb3JpZ2luYWwudlxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSxcbiAgICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZShjb2xvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGg6IGNvbG9yLmgsXG4gICAgICAgICAgczogY29sb3IucyxcbiAgICAgICAgICB2OiBjb2xvci52XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICB9XG59XTtcbnZhciByZXN1bHQgPSB2b2lkIDA7XG52YXIgdG9SZXR1cm4gPSB2b2lkIDA7XG52YXIgaW50ZXJwcmV0ID0gZnVuY3Rpb24gaW50ZXJwcmV0KCkge1xuICB0b1JldHVybiA9IGZhbHNlO1xuICB2YXIgb3JpZ2luYWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IENvbW1vbi50b0FycmF5KGFyZ3VtZW50cykgOiBhcmd1bWVudHNbMF07XG4gIENvbW1vbi5lYWNoKElOVEVSUFJFVEFUSU9OUywgZnVuY3Rpb24gKGZhbWlseSkge1xuICAgIGlmIChmYW1pbHkubGl0bXVzKG9yaWdpbmFsKSkge1xuICAgICAgQ29tbW9uLmVhY2goZmFtaWx5LmNvbnZlcnNpb25zLCBmdW5jdGlvbiAoY29udmVyc2lvbiwgY29udmVyc2lvbk5hbWUpIHtcbiAgICAgICAgcmVzdWx0ID0gY29udmVyc2lvbi5yZWFkKG9yaWdpbmFsKTtcbiAgICAgICAgaWYgKHRvUmV0dXJuID09PSBmYWxzZSAmJiByZXN1bHQgIT09IGZhbHNlKSB7XG4gICAgICAgICAgdG9SZXR1cm4gPSByZXN1bHQ7XG4gICAgICAgICAgcmVzdWx0LmNvbnZlcnNpb25OYW1lID0gY29udmVyc2lvbk5hbWU7XG4gICAgICAgICAgcmVzdWx0LmNvbnZlcnNpb24gPSBjb252ZXJzaW9uO1xuICAgICAgICAgIHJldHVybiBDb21tb24uQlJFQUs7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIENvbW1vbi5CUkVBSztcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gdG9SZXR1cm47XG59O1xuXG52YXIgdG1wQ29tcG9uZW50ID0gdm9pZCAwO1xudmFyIENvbG9yTWF0aCA9IHtcbiAgaHN2X3RvX3JnYjogZnVuY3Rpb24gaHN2X3RvX3JnYihoLCBzLCB2KSB7XG4gICAgdmFyIGhpID0gTWF0aC5mbG9vcihoIC8gNjApICUgNjtcbiAgICB2YXIgZiA9IGggLyA2MCAtIE1hdGguZmxvb3IoaCAvIDYwKTtcbiAgICB2YXIgcCA9IHYgKiAoMS4wIC0gcyk7XG4gICAgdmFyIHEgPSB2ICogKDEuMCAtIGYgKiBzKTtcbiAgICB2YXIgdCA9IHYgKiAoMS4wIC0gKDEuMCAtIGYpICogcyk7XG4gICAgdmFyIGMgPSBbW3YsIHQsIHBdLCBbcSwgdiwgcF0sIFtwLCB2LCB0XSwgW3AsIHEsIHZdLCBbdCwgcCwgdl0sIFt2LCBwLCBxXV1baGldO1xuICAgIHJldHVybiB7XG4gICAgICByOiBjWzBdICogMjU1LFxuICAgICAgZzogY1sxXSAqIDI1NSxcbiAgICAgIGI6IGNbMl0gKiAyNTVcbiAgICB9O1xuICB9LFxuICByZ2JfdG9faHN2OiBmdW5jdGlvbiByZ2JfdG9faHN2KHIsIGcsIGIpIHtcbiAgICB2YXIgbWluID0gTWF0aC5taW4ociwgZywgYik7XG4gICAgdmFyIG1heCA9IE1hdGgubWF4KHIsIGcsIGIpO1xuICAgIHZhciBkZWx0YSA9IG1heCAtIG1pbjtcbiAgICB2YXIgaCA9IHZvaWQgMDtcbiAgICB2YXIgcyA9IHZvaWQgMDtcbiAgICBpZiAobWF4ICE9PSAwKSB7XG4gICAgICBzID0gZGVsdGEgLyBtYXg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGg6IE5hTixcbiAgICAgICAgczogMCxcbiAgICAgICAgdjogMFxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHIgPT09IG1heCkge1xuICAgICAgaCA9IChnIC0gYikgLyBkZWx0YTtcbiAgICB9IGVsc2UgaWYgKGcgPT09IG1heCkge1xuICAgICAgaCA9IDIgKyAoYiAtIHIpIC8gZGVsdGE7XG4gICAgfSBlbHNlIHtcbiAgICAgIGggPSA0ICsgKHIgLSBnKSAvIGRlbHRhO1xuICAgIH1cbiAgICBoIC89IDY7XG4gICAgaWYgKGggPCAwKSB7XG4gICAgICBoICs9IDE7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBoOiBoICogMzYwLFxuICAgICAgczogcyxcbiAgICAgIHY6IG1heCAvIDI1NVxuICAgIH07XG4gIH0sXG4gIHJnYl90b19oZXg6IGZ1bmN0aW9uIHJnYl90b19oZXgociwgZywgYikge1xuICAgIHZhciBoZXggPSB0aGlzLmhleF93aXRoX2NvbXBvbmVudCgwLCAyLCByKTtcbiAgICBoZXggPSB0aGlzLmhleF93aXRoX2NvbXBvbmVudChoZXgsIDEsIGcpO1xuICAgIGhleCA9IHRoaXMuaGV4X3dpdGhfY29tcG9uZW50KGhleCwgMCwgYik7XG4gICAgcmV0dXJuIGhleDtcbiAgfSxcbiAgY29tcG9uZW50X2Zyb21faGV4OiBmdW5jdGlvbiBjb21wb25lbnRfZnJvbV9oZXgoaGV4LCBjb21wb25lbnRJbmRleCkge1xuICAgIHJldHVybiBoZXggPj4gY29tcG9uZW50SW5kZXggKiA4ICYgMHhGRjtcbiAgfSxcbiAgaGV4X3dpdGhfY29tcG9uZW50OiBmdW5jdGlvbiBoZXhfd2l0aF9jb21wb25lbnQoaGV4LCBjb21wb25lbnRJbmRleCwgdmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPDwgKHRtcENvbXBvbmVudCA9IGNvbXBvbmVudEluZGV4ICogOCkgfCBoZXggJiB+KDB4RkYgPDwgdG1wQ29tcG9uZW50KTtcbiAgfVxufTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIHR5cGVvZiBvYmo7XG59IDogZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajtcbn07XG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIGNsYXNzQ2FsbENoZWNrID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG4gIH1cbn07XG5cbnZhciBjcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTtcbiAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcbiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTtcbiAgICAgIGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHtcbiAgICBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuICAgIGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO1xuICAgIHJldHVybiBDb25zdHJ1Y3RvcjtcbiAgfTtcbn0oKTtcblxuXG5cblxuXG5cblxudmFyIGdldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikge1xuICBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7XG4gIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTtcblxuICBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpO1xuXG4gICAgaWYgKHBhcmVudCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7XG4gICAgfVxuICB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7XG4gICAgcmV0dXJuIGRlc2MudmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGdldHRlciA9IGRlc2MuZ2V0O1xuXG4gICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7XG4gIH1cbn07XG5cbnZhciBpbmhlcml0cyA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7XG4gIH1cblxuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHtcbiAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgdmFsdWU6IHN1YkNsYXNzLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH1cbiAgfSk7XG4gIGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzcztcbn07XG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gPSBmdW5jdGlvbiAoc2VsZiwgY2FsbCkge1xuICBpZiAoIXNlbGYpIHtcbiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7XG4gIH1cblxuICByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjtcbn07XG5cbnZhciBDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ29sb3IoKSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29sb3IpO1xuICAgIHRoaXMuX19zdGF0ZSA9IGludGVycHJldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmICh0aGlzLl9fc3RhdGUgPT09IGZhbHNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBpbnRlcnByZXQgY29sb3IgYXJndW1lbnRzJyk7XG4gICAgfVxuICAgIHRoaXMuX19zdGF0ZS5hID0gdGhpcy5fX3N0YXRlLmEgfHwgMTtcbiAgfVxuICBjcmVhdGVDbGFzcyhDb2xvciwgW3tcbiAgICBrZXk6ICd0b1N0cmluZycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgICAgcmV0dXJuIGNvbG9yVG9TdHJpbmcodGhpcyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAndG9IZXhTdHJpbmcnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0b0hleFN0cmluZygpIHtcbiAgICAgIHJldHVybiBjb2xvclRvU3RyaW5nKHRoaXMsIHRydWUpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3RvT3JpZ2luYWwnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0b09yaWdpbmFsKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX19zdGF0ZS5jb252ZXJzaW9uLndyaXRlKHRoaXMpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gQ29sb3I7XG59KCk7XG5mdW5jdGlvbiBkZWZpbmVSR0JDb21wb25lbnQodGFyZ2V0LCBjb21wb25lbnQsIGNvbXBvbmVudEhleEluZGV4KSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGNvbXBvbmVudCwge1xuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgaWYgKHRoaXMuX19zdGF0ZS5zcGFjZSA9PT0gJ1JHQicpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX19zdGF0ZVtjb21wb25lbnRdO1xuICAgICAgfVxuICAgICAgQ29sb3IucmVjYWxjdWxhdGVSR0IodGhpcywgY29tcG9uZW50LCBjb21wb25lbnRIZXhJbmRleCk7XG4gICAgICByZXR1cm4gdGhpcy5fX3N0YXRlW2NvbXBvbmVudF07XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldCQkMSh2KSB7XG4gICAgICBpZiAodGhpcy5fX3N0YXRlLnNwYWNlICE9PSAnUkdCJykge1xuICAgICAgICBDb2xvci5yZWNhbGN1bGF0ZVJHQih0aGlzLCBjb21wb25lbnQsIGNvbXBvbmVudEhleEluZGV4KTtcbiAgICAgICAgdGhpcy5fX3N0YXRlLnNwYWNlID0gJ1JHQic7XG4gICAgICB9XG4gICAgICB0aGlzLl9fc3RhdGVbY29tcG9uZW50XSA9IHY7XG4gICAgfVxuICB9KTtcbn1cbmZ1bmN0aW9uIGRlZmluZUhTVkNvbXBvbmVudCh0YXJnZXQsIGNvbXBvbmVudCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBjb21wb25lbnQsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIGlmICh0aGlzLl9fc3RhdGUuc3BhY2UgPT09ICdIU1YnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9fc3RhdGVbY29tcG9uZW50XTtcbiAgICAgIH1cbiAgICAgIENvbG9yLnJlY2FsY3VsYXRlSFNWKHRoaXMpO1xuICAgICAgcmV0dXJuIHRoaXMuX19zdGF0ZVtjb21wb25lbnRdO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEodikge1xuICAgICAgaWYgKHRoaXMuX19zdGF0ZS5zcGFjZSAhPT0gJ0hTVicpIHtcbiAgICAgICAgQ29sb3IucmVjYWxjdWxhdGVIU1YodGhpcyk7XG4gICAgICAgIHRoaXMuX19zdGF0ZS5zcGFjZSA9ICdIU1YnO1xuICAgICAgfVxuICAgICAgdGhpcy5fX3N0YXRlW2NvbXBvbmVudF0gPSB2O1xuICAgIH1cbiAgfSk7XG59XG5Db2xvci5yZWNhbGN1bGF0ZVJHQiA9IGZ1bmN0aW9uIChjb2xvciwgY29tcG9uZW50LCBjb21wb25lbnRIZXhJbmRleCkge1xuICBpZiAoY29sb3IuX19zdGF0ZS5zcGFjZSA9PT0gJ0hFWCcpIHtcbiAgICBjb2xvci5fX3N0YXRlW2NvbXBvbmVudF0gPSBDb2xvck1hdGguY29tcG9uZW50X2Zyb21faGV4KGNvbG9yLl9fc3RhdGUuaGV4LCBjb21wb25lbnRIZXhJbmRleCk7XG4gIH0gZWxzZSBpZiAoY29sb3IuX19zdGF0ZS5zcGFjZSA9PT0gJ0hTVicpIHtcbiAgICBDb21tb24uZXh0ZW5kKGNvbG9yLl9fc3RhdGUsIENvbG9yTWF0aC5oc3ZfdG9fcmdiKGNvbG9yLl9fc3RhdGUuaCwgY29sb3IuX19zdGF0ZS5zLCBjb2xvci5fX3N0YXRlLnYpKTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvcnJ1cHRlZCBjb2xvciBzdGF0ZScpO1xuICB9XG59O1xuQ29sb3IucmVjYWxjdWxhdGVIU1YgPSBmdW5jdGlvbiAoY29sb3IpIHtcbiAgdmFyIHJlc3VsdCA9IENvbG9yTWF0aC5yZ2JfdG9faHN2KGNvbG9yLnIsIGNvbG9yLmcsIGNvbG9yLmIpO1xuICBDb21tb24uZXh0ZW5kKGNvbG9yLl9fc3RhdGUsIHtcbiAgICBzOiByZXN1bHQucyxcbiAgICB2OiByZXN1bHQudlxuICB9KTtcbiAgaWYgKCFDb21tb24uaXNOYU4ocmVzdWx0LmgpKSB7XG4gICAgY29sb3IuX19zdGF0ZS5oID0gcmVzdWx0Lmg7XG4gIH0gZWxzZSBpZiAoQ29tbW9uLmlzVW5kZWZpbmVkKGNvbG9yLl9fc3RhdGUuaCkpIHtcbiAgICBjb2xvci5fX3N0YXRlLmggPSAwO1xuICB9XG59O1xuQ29sb3IuQ09NUE9ORU5UUyA9IFsncicsICdnJywgJ2InLCAnaCcsICdzJywgJ3YnLCAnaGV4JywgJ2EnXTtcbmRlZmluZVJHQkNvbXBvbmVudChDb2xvci5wcm90b3R5cGUsICdyJywgMik7XG5kZWZpbmVSR0JDb21wb25lbnQoQ29sb3IucHJvdG90eXBlLCAnZycsIDEpO1xuZGVmaW5lUkdCQ29tcG9uZW50KENvbG9yLnByb3RvdHlwZSwgJ2InLCAwKTtcbmRlZmluZUhTVkNvbXBvbmVudChDb2xvci5wcm90b3R5cGUsICdoJyk7XG5kZWZpbmVIU1ZDb21wb25lbnQoQ29sb3IucHJvdG90eXBlLCAncycpO1xuZGVmaW5lSFNWQ29tcG9uZW50KENvbG9yLnByb3RvdHlwZSwgJ3YnKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xvci5wcm90b3R5cGUsICdhJywge1xuICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICByZXR1cm4gdGhpcy5fX3N0YXRlLmE7XG4gIH0sXG4gIHNldDogZnVuY3Rpb24gc2V0JCQxKHYpIHtcbiAgICB0aGlzLl9fc3RhdGUuYSA9IHY7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgJ2hleCcsIHtcbiAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgaWYgKCF0aGlzLl9fc3RhdGUuc3BhY2UgIT09ICdIRVgnKSB7XG4gICAgICB0aGlzLl9fc3RhdGUuaGV4ID0gQ29sb3JNYXRoLnJnYl90b19oZXgodGhpcy5yLCB0aGlzLmcsIHRoaXMuYik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9fc3RhdGUuaGV4O1xuICB9LFxuICBzZXQ6IGZ1bmN0aW9uIHNldCQkMSh2KSB7XG4gICAgdGhpcy5fX3N0YXRlLnNwYWNlID0gJ0hFWCc7XG4gICAgdGhpcy5fX3N0YXRlLmhleCA9IHY7XG4gIH1cbn0pO1xuXG52YXIgQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ29udHJvbGxlcihvYmplY3QsIHByb3BlcnR5KSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29udHJvbGxlcik7XG4gICAgdGhpcy5pbml0aWFsVmFsdWUgPSBvYmplY3RbcHJvcGVydHldO1xuICAgIHRoaXMuZG9tRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMub2JqZWN0ID0gb2JqZWN0O1xuICAgIHRoaXMucHJvcGVydHkgPSBwcm9wZXJ0eTtcbiAgICB0aGlzLl9fb25DaGFuZ2UgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fX29uRmluaXNoQ2hhbmdlID0gdW5kZWZpbmVkO1xuICB9XG4gIGNyZWF0ZUNsYXNzKENvbnRyb2xsZXIsIFt7XG4gICAga2V5OiAnb25DaGFuZ2UnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShmbmMpIHtcbiAgICAgIHRoaXMuX19vbkNoYW5nZSA9IGZuYztcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ29uRmluaXNoQ2hhbmdlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gb25GaW5pc2hDaGFuZ2UoZm5jKSB7XG4gICAgICB0aGlzLl9fb25GaW5pc2hDaGFuZ2UgPSBmbmM7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdzZXRWYWx1ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgICB0aGlzLm9iamVjdFt0aGlzLnByb3BlcnR5XSA9IG5ld1ZhbHVlO1xuICAgICAgaWYgKHRoaXMuX19vbkNoYW5nZSkge1xuICAgICAgICB0aGlzLl9fb25DaGFuZ2UuY2FsbCh0aGlzLCBuZXdWYWx1ZSk7XG4gICAgICB9XG4gICAgICB0aGlzLnVwZGF0ZURpc3BsYXkoKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2dldFZhbHVlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VmFsdWUoKSB7XG4gICAgICByZXR1cm4gdGhpcy5vYmplY3RbdGhpcy5wcm9wZXJ0eV07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAndXBkYXRlRGlzcGxheScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZURpc3BsYXkoKSB7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdpc01vZGlmaWVkJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaXNNb2RpZmllZCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmluaXRpYWxWYWx1ZSAhPT0gdGhpcy5nZXRWYWx1ZSgpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gQ29udHJvbGxlcjtcbn0oKTtcblxudmFyIEVWRU5UX01BUCA9IHtcbiAgSFRNTEV2ZW50czogWydjaGFuZ2UnXSxcbiAgTW91c2VFdmVudHM6IFsnY2xpY2snLCAnbW91c2Vtb3ZlJywgJ21vdXNlZG93bicsICdtb3VzZXVwJywgJ21vdXNlb3ZlciddLFxuICBLZXlib2FyZEV2ZW50czogWydrZXlkb3duJ11cbn07XG52YXIgRVZFTlRfTUFQX0lOViA9IHt9O1xuQ29tbW9uLmVhY2goRVZFTlRfTUFQLCBmdW5jdGlvbiAodiwgaykge1xuICBDb21tb24uZWFjaCh2LCBmdW5jdGlvbiAoZSkge1xuICAgIEVWRU5UX01BUF9JTlZbZV0gPSBrO1xuICB9KTtcbn0pO1xudmFyIENTU19WQUxVRV9QSVhFTFMgPSAvKFxcZCsoXFwuXFxkKyk/KXB4LztcbmZ1bmN0aW9uIGNzc1ZhbHVlVG9QaXhlbHModmFsKSB7XG4gIGlmICh2YWwgPT09ICcwJyB8fCBDb21tb24uaXNVbmRlZmluZWQodmFsKSkge1xuICAgIHJldHVybiAwO1xuICB9XG4gIHZhciBtYXRjaCA9IHZhbC5tYXRjaChDU1NfVkFMVUVfUElYRUxTKTtcbiAgaWYgKCFDb21tb24uaXNOdWxsKG1hdGNoKSkge1xuICAgIHJldHVybiBwYXJzZUZsb2F0KG1hdGNoWzFdKTtcbiAgfVxuICByZXR1cm4gMDtcbn1cbnZhciBkb20gPSB7XG4gIG1ha2VTZWxlY3RhYmxlOiBmdW5jdGlvbiBtYWtlU2VsZWN0YWJsZShlbGVtLCBzZWxlY3RhYmxlKSB7XG4gICAgaWYgKGVsZW0gPT09IHVuZGVmaW5lZCB8fCBlbGVtLnN0eWxlID09PSB1bmRlZmluZWQpIHJldHVybjtcbiAgICBlbGVtLm9uc2VsZWN0c3RhcnQgPSBzZWxlY3RhYmxlID8gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gOiBmdW5jdGlvbiAoKSB7fTtcbiAgICBlbGVtLnN0eWxlLk1velVzZXJTZWxlY3QgPSBzZWxlY3RhYmxlID8gJ2F1dG8nIDogJ25vbmUnO1xuICAgIGVsZW0uc3R5bGUuS2h0bWxVc2VyU2VsZWN0ID0gc2VsZWN0YWJsZSA/ICdhdXRvJyA6ICdub25lJztcbiAgICBlbGVtLnVuc2VsZWN0YWJsZSA9IHNlbGVjdGFibGUgPyAnb24nIDogJ29mZic7XG4gIH0sXG4gIG1ha2VGdWxsc2NyZWVuOiBmdW5jdGlvbiBtYWtlRnVsbHNjcmVlbihlbGVtLCBob3IsIHZlcnQpIHtcbiAgICB2YXIgdmVydGljYWwgPSB2ZXJ0O1xuICAgIHZhciBob3Jpem9udGFsID0gaG9yO1xuICAgIGlmIChDb21tb24uaXNVbmRlZmluZWQoaG9yaXpvbnRhbCkpIHtcbiAgICAgIGhvcml6b250YWwgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoQ29tbW9uLmlzVW5kZWZpbmVkKHZlcnRpY2FsKSkge1xuICAgICAgdmVydGljYWwgPSB0cnVlO1xuICAgIH1cbiAgICBlbGVtLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBpZiAoaG9yaXpvbnRhbCkge1xuICAgICAgZWxlbS5zdHlsZS5sZWZ0ID0gMDtcbiAgICAgIGVsZW0uc3R5bGUucmlnaHQgPSAwO1xuICAgIH1cbiAgICBpZiAodmVydGljYWwpIHtcbiAgICAgIGVsZW0uc3R5bGUudG9wID0gMDtcbiAgICAgIGVsZW0uc3R5bGUuYm90dG9tID0gMDtcbiAgICB9XG4gIH0sXG4gIGZha2VFdmVudDogZnVuY3Rpb24gZmFrZUV2ZW50KGVsZW0sIGV2ZW50VHlwZSwgcGFycywgYXV4KSB7XG4gICAgdmFyIHBhcmFtcyA9IHBhcnMgfHwge307XG4gICAgdmFyIGNsYXNzTmFtZSA9IEVWRU5UX01BUF9JTlZbZXZlbnRUeXBlXTtcbiAgICBpZiAoIWNsYXNzTmFtZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdFdmVudCB0eXBlICcgKyBldmVudFR5cGUgKyAnIG5vdCBzdXBwb3J0ZWQuJyk7XG4gICAgfVxuICAgIHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudChjbGFzc05hbWUpO1xuICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG4gICAgICBjYXNlICdNb3VzZUV2ZW50cyc6XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgY2xpZW50WCA9IHBhcmFtcy54IHx8IHBhcmFtcy5jbGllbnRYIHx8IDA7XG4gICAgICAgICAgdmFyIGNsaWVudFkgPSBwYXJhbXMueSB8fCBwYXJhbXMuY2xpZW50WSB8fCAwO1xuICAgICAgICAgIGV2dC5pbml0TW91c2VFdmVudChldmVudFR5cGUsIHBhcmFtcy5idWJibGVzIHx8IGZhbHNlLCBwYXJhbXMuY2FuY2VsYWJsZSB8fCB0cnVlLCB3aW5kb3csIHBhcmFtcy5jbGlja0NvdW50IHx8IDEsIDAsXG4gICAgICAgICAgMCxcbiAgICAgICAgICBjbGllbnRYLFxuICAgICAgICAgIGNsaWVudFksXG4gICAgICAgICAgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDAsIG51bGwpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICBjYXNlICdLZXlib2FyZEV2ZW50cyc6XG4gICAgICAgIHtcbiAgICAgICAgICB2YXIgaW5pdCA9IGV2dC5pbml0S2V5Ym9hcmRFdmVudCB8fCBldnQuaW5pdEtleUV2ZW50O1xuICAgICAgICAgIENvbW1vbi5kZWZhdWx0cyhwYXJhbXMsIHtcbiAgICAgICAgICAgIGNhbmNlbGFibGU6IHRydWUsXG4gICAgICAgICAgICBjdHJsS2V5OiBmYWxzZSxcbiAgICAgICAgICAgIGFsdEtleTogZmFsc2UsXG4gICAgICAgICAgICBzaGlmdEtleTogZmFsc2UsXG4gICAgICAgICAgICBtZXRhS2V5OiBmYWxzZSxcbiAgICAgICAgICAgIGtleUNvZGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGNoYXJDb2RlOiB1bmRlZmluZWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpbml0KGV2ZW50VHlwZSwgcGFyYW1zLmJ1YmJsZXMgfHwgZmFsc2UsIHBhcmFtcy5jYW5jZWxhYmxlLCB3aW5kb3csIHBhcmFtcy5jdHJsS2V5LCBwYXJhbXMuYWx0S2V5LCBwYXJhbXMuc2hpZnRLZXksIHBhcmFtcy5tZXRhS2V5LCBwYXJhbXMua2V5Q29kZSwgcGFyYW1zLmNoYXJDb2RlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgZGVmYXVsdDpcbiAgICAgICAge1xuICAgICAgICAgIGV2dC5pbml0RXZlbnQoZXZlbnRUeXBlLCBwYXJhbXMuYnViYmxlcyB8fCBmYWxzZSwgcGFyYW1zLmNhbmNlbGFibGUgfHwgdHJ1ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgQ29tbW9uLmRlZmF1bHRzKGV2dCwgYXV4KTtcbiAgICBlbGVtLmRpc3BhdGNoRXZlbnQoZXZ0KTtcbiAgfSxcbiAgYmluZDogZnVuY3Rpb24gYmluZChlbGVtLCBldmVudCwgZnVuYywgbmV3Qm9vbCkge1xuICAgIHZhciBib29sID0gbmV3Qm9vbCB8fCBmYWxzZTtcbiAgICBpZiAoZWxlbS5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZ1bmMsIGJvb2wpO1xuICAgIH0gZWxzZSBpZiAoZWxlbS5hdHRhY2hFdmVudCkge1xuICAgICAgZWxlbS5hdHRhY2hFdmVudCgnb24nICsgZXZlbnQsIGZ1bmMpO1xuICAgIH1cbiAgICByZXR1cm4gZG9tO1xuICB9LFxuICB1bmJpbmQ6IGZ1bmN0aW9uIHVuYmluZChlbGVtLCBldmVudCwgZnVuYywgbmV3Qm9vbCkge1xuICAgIHZhciBib29sID0gbmV3Qm9vbCB8fCBmYWxzZTtcbiAgICBpZiAoZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKSB7XG4gICAgICBlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGZ1bmMsIGJvb2wpO1xuICAgIH0gZWxzZSBpZiAoZWxlbS5kZXRhY2hFdmVudCkge1xuICAgICAgZWxlbS5kZXRhY2hFdmVudCgnb24nICsgZXZlbnQsIGZ1bmMpO1xuICAgIH1cbiAgICByZXR1cm4gZG9tO1xuICB9LFxuICBhZGRDbGFzczogZnVuY3Rpb24gYWRkQ2xhc3MoZWxlbSwgY2xhc3NOYW1lKSB7XG4gICAgaWYgKGVsZW0uY2xhc3NOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGVsZW0uY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xuICAgIH0gZWxzZSBpZiAoZWxlbS5jbGFzc05hbWUgIT09IGNsYXNzTmFtZSkge1xuICAgICAgdmFyIGNsYXNzZXMgPSBlbGVtLmNsYXNzTmFtZS5zcGxpdCgvICsvKTtcbiAgICAgIGlmIChjbGFzc2VzLmluZGV4T2YoY2xhc3NOYW1lKSA9PT0gLTEpIHtcbiAgICAgICAgY2xhc3Nlcy5wdXNoKGNsYXNzTmFtZSk7XG4gICAgICAgIGVsZW0uY2xhc3NOYW1lID0gY2xhc3Nlcy5qb2luKCcgJykucmVwbGFjZSgvXlxccysvLCAnJykucmVwbGFjZSgvXFxzKyQvLCAnJyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkb207XG4gIH0sXG4gIHJlbW92ZUNsYXNzOiBmdW5jdGlvbiByZW1vdmVDbGFzcyhlbGVtLCBjbGFzc05hbWUpIHtcbiAgICBpZiAoY2xhc3NOYW1lKSB7XG4gICAgICBpZiAoZWxlbS5jbGFzc05hbWUgPT09IGNsYXNzTmFtZSkge1xuICAgICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBjbGFzc2VzID0gZWxlbS5jbGFzc05hbWUuc3BsaXQoLyArLyk7XG4gICAgICAgIHZhciBpbmRleCA9IGNsYXNzZXMuaW5kZXhPZihjbGFzc05hbWUpO1xuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgY2xhc3Nlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgIGVsZW0uY2xhc3NOYW1lID0gY2xhc3Nlcy5qb2luKCcgJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZWxlbS5jbGFzc05hbWUgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiBkb207XG4gIH0sXG4gIGhhc0NsYXNzOiBmdW5jdGlvbiBoYXNDbGFzcyhlbGVtLCBjbGFzc05hbWUpIHtcbiAgICByZXR1cm4gbmV3IFJlZ0V4cCgnKD86XnxcXFxccyspJyArIGNsYXNzTmFtZSArICcoPzpcXFxccyt8JCknKS50ZXN0KGVsZW0uY2xhc3NOYW1lKSB8fCBmYWxzZTtcbiAgfSxcbiAgZ2V0V2lkdGg6IGZ1bmN0aW9uIGdldFdpZHRoKGVsZW0pIHtcbiAgICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW0pO1xuICAgIHJldHVybiBjc3NWYWx1ZVRvUGl4ZWxzKHN0eWxlWydib3JkZXItbGVmdC13aWR0aCddKSArIGNzc1ZhbHVlVG9QaXhlbHMoc3R5bGVbJ2JvcmRlci1yaWdodC13aWR0aCddKSArIGNzc1ZhbHVlVG9QaXhlbHMoc3R5bGVbJ3BhZGRpbmctbGVmdCddKSArIGNzc1ZhbHVlVG9QaXhlbHMoc3R5bGVbJ3BhZGRpbmctcmlnaHQnXSkgKyBjc3NWYWx1ZVRvUGl4ZWxzKHN0eWxlLndpZHRoKTtcbiAgfSxcbiAgZ2V0SGVpZ2h0OiBmdW5jdGlvbiBnZXRIZWlnaHQoZWxlbSkge1xuICAgIHZhciBzdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbSk7XG4gICAgcmV0dXJuIGNzc1ZhbHVlVG9QaXhlbHMoc3R5bGVbJ2JvcmRlci10b3Atd2lkdGgnXSkgKyBjc3NWYWx1ZVRvUGl4ZWxzKHN0eWxlWydib3JkZXItYm90dG9tLXdpZHRoJ10pICsgY3NzVmFsdWVUb1BpeGVscyhzdHlsZVsncGFkZGluZy10b3AnXSkgKyBjc3NWYWx1ZVRvUGl4ZWxzKHN0eWxlWydwYWRkaW5nLWJvdHRvbSddKSArIGNzc1ZhbHVlVG9QaXhlbHMoc3R5bGUuaGVpZ2h0KTtcbiAgfSxcbiAgZ2V0T2Zmc2V0OiBmdW5jdGlvbiBnZXRPZmZzZXQoZWwpIHtcbiAgICB2YXIgZWxlbSA9IGVsO1xuICAgIHZhciBvZmZzZXQgPSB7IGxlZnQ6IDAsIHRvcDogMCB9O1xuICAgIGlmIChlbGVtLm9mZnNldFBhcmVudCkge1xuICAgICAgZG8ge1xuICAgICAgICBvZmZzZXQubGVmdCArPSBlbGVtLm9mZnNldExlZnQ7XG4gICAgICAgIG9mZnNldC50b3AgKz0gZWxlbS5vZmZzZXRUb3A7XG4gICAgICAgIGVsZW0gPSBlbGVtLm9mZnNldFBhcmVudDtcbiAgICAgIH0gd2hpbGUgKGVsZW0pO1xuICAgIH1cbiAgICByZXR1cm4gb2Zmc2V0O1xuICB9LFxuICBpc0FjdGl2ZTogZnVuY3Rpb24gaXNBY3RpdmUoZWxlbSkge1xuICAgIHJldHVybiBlbGVtID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmIChlbGVtLnR5cGUgfHwgZWxlbS5ocmVmKTtcbiAgfVxufTtcblxudmFyIEJvb2xlYW5Db250cm9sbGVyID0gZnVuY3Rpb24gKF9Db250cm9sbGVyKSB7XG4gIGluaGVyaXRzKEJvb2xlYW5Db250cm9sbGVyLCBfQ29udHJvbGxlcik7XG4gIGZ1bmN0aW9uIEJvb2xlYW5Db250cm9sbGVyKG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBCb29sZWFuQ29udHJvbGxlcik7XG4gICAgdmFyIF90aGlzMiA9IHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKEJvb2xlYW5Db250cm9sbGVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoQm9vbGVhbkNvbnRyb2xsZXIpKS5jYWxsKHRoaXMsIG9iamVjdCwgcHJvcGVydHkpKTtcbiAgICB2YXIgX3RoaXMgPSBfdGhpczI7XG4gICAgX3RoaXMyLl9fcHJldiA9IF90aGlzMi5nZXRWYWx1ZSgpO1xuICAgIF90aGlzMi5fX2NoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICBfdGhpczIuX19jaGVja2JveC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnY2hlY2tib3gnKTtcbiAgICBmdW5jdGlvbiBvbkNoYW5nZSgpIHtcbiAgICAgIF90aGlzLnNldFZhbHVlKCFfdGhpcy5fX3ByZXYpO1xuICAgIH1cbiAgICBkb20uYmluZChfdGhpczIuX19jaGVja2JveCwgJ2NoYW5nZScsIG9uQ2hhbmdlLCBmYWxzZSk7XG4gICAgX3RoaXMyLmRvbUVsZW1lbnQuYXBwZW5kQ2hpbGQoX3RoaXMyLl9fY2hlY2tib3gpO1xuICAgIF90aGlzMi51cGRhdGVEaXNwbGF5KCk7XG4gICAgcmV0dXJuIF90aGlzMjtcbiAgfVxuICBjcmVhdGVDbGFzcyhCb29sZWFuQ29udHJvbGxlciwgW3tcbiAgICBrZXk6ICdzZXRWYWx1ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldFZhbHVlKHYpIHtcbiAgICAgIHZhciB0b1JldHVybiA9IGdldChCb29sZWFuQ29udHJvbGxlci5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihCb29sZWFuQ29udHJvbGxlci5wcm90b3R5cGUpLCAnc2V0VmFsdWUnLCB0aGlzKS5jYWxsKHRoaXMsIHYpO1xuICAgICAgaWYgKHRoaXMuX19vbkZpbmlzaENoYW5nZSkge1xuICAgICAgICB0aGlzLl9fb25GaW5pc2hDaGFuZ2UuY2FsbCh0aGlzLCB0aGlzLmdldFZhbHVlKCkpO1xuICAgICAgfVxuICAgICAgdGhpcy5fX3ByZXYgPSB0aGlzLmdldFZhbHVlKCk7XG4gICAgICByZXR1cm4gdG9SZXR1cm47XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAndXBkYXRlRGlzcGxheScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZURpc3BsYXkoKSB7XG4gICAgICBpZiAodGhpcy5nZXRWYWx1ZSgpID09PSB0cnVlKSB7XG4gICAgICAgIHRoaXMuX19jaGVja2JveC5zZXRBdHRyaWJ1dGUoJ2NoZWNrZWQnLCAnY2hlY2tlZCcpO1xuICAgICAgICB0aGlzLl9fY2hlY2tib3guY2hlY2tlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuX19wcmV2ID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX19jaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX19wcmV2ID0gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gZ2V0KEJvb2xlYW5Db250cm9sbGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKEJvb2xlYW5Db250cm9sbGVyLnByb3RvdHlwZSksICd1cGRhdGVEaXNwbGF5JywgdGhpcykuY2FsbCh0aGlzKTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIEJvb2xlYW5Db250cm9sbGVyO1xufShDb250cm9sbGVyKTtcblxudmFyIE9wdGlvbkNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoX0NvbnRyb2xsZXIpIHtcbiAgaW5oZXJpdHMoT3B0aW9uQ29udHJvbGxlciwgX0NvbnRyb2xsZXIpO1xuICBmdW5jdGlvbiBPcHRpb25Db250cm9sbGVyKG9iamVjdCwgcHJvcGVydHksIG9wdHMpIHtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBPcHRpb25Db250cm9sbGVyKTtcbiAgICB2YXIgX3RoaXMyID0gcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoT3B0aW9uQ29udHJvbGxlci5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE9wdGlvbkNvbnRyb2xsZXIpKS5jYWxsKHRoaXMsIG9iamVjdCwgcHJvcGVydHkpKTtcbiAgICB2YXIgb3B0aW9ucyA9IG9wdHM7XG4gICAgdmFyIF90aGlzID0gX3RoaXMyO1xuICAgIF90aGlzMi5fX3NlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpO1xuICAgIGlmIChDb21tb24uaXNBcnJheShvcHRpb25zKSkge1xuICAgICAgdmFyIG1hcCA9IHt9O1xuICAgICAgQ29tbW9uLmVhY2gob3B0aW9ucywgZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgbWFwW2VsZW1lbnRdID0gZWxlbWVudDtcbiAgICAgIH0pO1xuICAgICAgb3B0aW9ucyA9IG1hcDtcbiAgICB9XG4gICAgQ29tbW9uLmVhY2gob3B0aW9ucywgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgIHZhciBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgIG9wdC5pbm5lckhUTUwgPSBrZXk7XG4gICAgICBvcHQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIHZhbHVlKTtcbiAgICAgIF90aGlzLl9fc2VsZWN0LmFwcGVuZENoaWxkKG9wdCk7XG4gICAgfSk7XG4gICAgX3RoaXMyLnVwZGF0ZURpc3BsYXkoKTtcbiAgICBkb20uYmluZChfdGhpczIuX19zZWxlY3QsICdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZGVzaXJlZFZhbHVlID0gdGhpcy5vcHRpb25zW3RoaXMuc2VsZWN0ZWRJbmRleF0udmFsdWU7XG4gICAgICBfdGhpcy5zZXRWYWx1ZShkZXNpcmVkVmFsdWUpO1xuICAgIH0pO1xuICAgIF90aGlzMi5kb21FbGVtZW50LmFwcGVuZENoaWxkKF90aGlzMi5fX3NlbGVjdCk7XG4gICAgcmV0dXJuIF90aGlzMjtcbiAgfVxuICBjcmVhdGVDbGFzcyhPcHRpb25Db250cm9sbGVyLCBbe1xuICAgIGtleTogJ3NldFZhbHVlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VmFsdWUodikge1xuICAgICAgdmFyIHRvUmV0dXJuID0gZ2V0KE9wdGlvbkNvbnRyb2xsZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoT3B0aW9uQ29udHJvbGxlci5wcm90b3R5cGUpLCAnc2V0VmFsdWUnLCB0aGlzKS5jYWxsKHRoaXMsIHYpO1xuICAgICAgaWYgKHRoaXMuX19vbkZpbmlzaENoYW5nZSkge1xuICAgICAgICB0aGlzLl9fb25GaW5pc2hDaGFuZ2UuY2FsbCh0aGlzLCB0aGlzLmdldFZhbHVlKCkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRvUmV0dXJuO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3VwZGF0ZURpc3BsYXknLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVEaXNwbGF5KCkge1xuICAgICAgaWYgKGRvbS5pc0FjdGl2ZSh0aGlzLl9fc2VsZWN0KSkgcmV0dXJuIHRoaXM7XG4gICAgICB0aGlzLl9fc2VsZWN0LnZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpO1xuICAgICAgcmV0dXJuIGdldChPcHRpb25Db250cm9sbGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE9wdGlvbkNvbnRyb2xsZXIucHJvdG90eXBlKSwgJ3VwZGF0ZURpc3BsYXknLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gT3B0aW9uQ29udHJvbGxlcjtcbn0oQ29udHJvbGxlcik7XG5cbnZhciBTdHJpbmdDb250cm9sbGVyID0gZnVuY3Rpb24gKF9Db250cm9sbGVyKSB7XG4gIGluaGVyaXRzKFN0cmluZ0NvbnRyb2xsZXIsIF9Db250cm9sbGVyKTtcbiAgZnVuY3Rpb24gU3RyaW5nQ29udHJvbGxlcihvYmplY3QsIHByb3BlcnR5KSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgU3RyaW5nQ29udHJvbGxlcik7XG4gICAgdmFyIF90aGlzMiA9IHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFN0cmluZ0NvbnRyb2xsZXIuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTdHJpbmdDb250cm9sbGVyKSkuY2FsbCh0aGlzLCBvYmplY3QsIHByb3BlcnR5KSk7XG4gICAgdmFyIF90aGlzID0gX3RoaXMyO1xuICAgIGZ1bmN0aW9uIG9uQ2hhbmdlKCkge1xuICAgICAgX3RoaXMuc2V0VmFsdWUoX3RoaXMuX19pbnB1dC52YWx1ZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uQmx1cigpIHtcbiAgICAgIGlmIChfdGhpcy5fX29uRmluaXNoQ2hhbmdlKSB7XG4gICAgICAgIF90aGlzLl9fb25GaW5pc2hDaGFuZ2UuY2FsbChfdGhpcywgX3RoaXMuZ2V0VmFsdWUoKSk7XG4gICAgICB9XG4gICAgfVxuICAgIF90aGlzMi5fX2lucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICBfdGhpczIuX19pbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpO1xuICAgIGRvbS5iaW5kKF90aGlzMi5fX2lucHV0LCAna2V5dXAnLCBvbkNoYW5nZSk7XG4gICAgZG9tLmJpbmQoX3RoaXMyLl9faW5wdXQsICdjaGFuZ2UnLCBvbkNoYW5nZSk7XG4gICAgZG9tLmJpbmQoX3RoaXMyLl9faW5wdXQsICdibHVyJywgb25CbHVyKTtcbiAgICBkb20uYmluZChfdGhpczIuX19pbnB1dCwgJ2tleWRvd24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgdGhpcy5ibHVyKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgX3RoaXMyLnVwZGF0ZURpc3BsYXkoKTtcbiAgICBfdGhpczIuZG9tRWxlbWVudC5hcHBlbmRDaGlsZChfdGhpczIuX19pbnB1dCk7XG4gICAgcmV0dXJuIF90aGlzMjtcbiAgfVxuICBjcmVhdGVDbGFzcyhTdHJpbmdDb250cm9sbGVyLCBbe1xuICAgIGtleTogJ3VwZGF0ZURpc3BsYXknLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVEaXNwbGF5KCkge1xuICAgICAgaWYgKCFkb20uaXNBY3RpdmUodGhpcy5fX2lucHV0KSkge1xuICAgICAgICB0aGlzLl9faW5wdXQudmFsdWUgPSB0aGlzLmdldFZhbHVlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZ2V0KFN0cmluZ0NvbnRyb2xsZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3RyaW5nQ29udHJvbGxlci5wcm90b3R5cGUpLCAndXBkYXRlRGlzcGxheScsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBTdHJpbmdDb250cm9sbGVyO1xufShDb250cm9sbGVyKTtcblxuZnVuY3Rpb24gbnVtRGVjaW1hbHMoeCkge1xuICB2YXIgX3ggPSB4LnRvU3RyaW5nKCk7XG4gIGlmIChfeC5pbmRleE9mKCcuJykgPiAtMSkge1xuICAgIHJldHVybiBfeC5sZW5ndGggLSBfeC5pbmRleE9mKCcuJykgLSAxO1xuICB9XG4gIHJldHVybiAwO1xufVxudmFyIE51bWJlckNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoX0NvbnRyb2xsZXIpIHtcbiAgaW5oZXJpdHMoTnVtYmVyQ29udHJvbGxlciwgX0NvbnRyb2xsZXIpO1xuICBmdW5jdGlvbiBOdW1iZXJDb250cm9sbGVyKG9iamVjdCwgcHJvcGVydHksIHBhcmFtcykge1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIE51bWJlckNvbnRyb2xsZXIpO1xuICAgIHZhciBfdGhpcyA9IHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE51bWJlckNvbnRyb2xsZXIuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihOdW1iZXJDb250cm9sbGVyKSkuY2FsbCh0aGlzLCBvYmplY3QsIHByb3BlcnR5KSk7XG4gICAgdmFyIF9wYXJhbXMgPSBwYXJhbXMgfHwge307XG4gICAgX3RoaXMuX19taW4gPSBfcGFyYW1zLm1pbjtcbiAgICBfdGhpcy5fX21heCA9IF9wYXJhbXMubWF4O1xuICAgIF90aGlzLl9fc3RlcCA9IF9wYXJhbXMuc3RlcDtcbiAgICBpZiAoQ29tbW9uLmlzVW5kZWZpbmVkKF90aGlzLl9fc3RlcCkpIHtcbiAgICAgIGlmIChfdGhpcy5pbml0aWFsVmFsdWUgPT09IDApIHtcbiAgICAgICAgX3RoaXMuX19pbXBsaWVkU3RlcCA9IDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpcy5fX2ltcGxpZWRTdGVwID0gTWF0aC5wb3coMTAsIE1hdGguZmxvb3IoTWF0aC5sb2coTWF0aC5hYnMoX3RoaXMuaW5pdGlhbFZhbHVlKSkgLyBNYXRoLkxOMTApKSAvIDEwO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBfdGhpcy5fX2ltcGxpZWRTdGVwID0gX3RoaXMuX19zdGVwO1xuICAgIH1cbiAgICBfdGhpcy5fX3ByZWNpc2lvbiA9IG51bURlY2ltYWxzKF90aGlzLl9faW1wbGllZFN0ZXApO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuICBjcmVhdGVDbGFzcyhOdW1iZXJDb250cm9sbGVyLCBbe1xuICAgIGtleTogJ3NldFZhbHVlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VmFsdWUodikge1xuICAgICAgdmFyIF92ID0gdjtcbiAgICAgIGlmICh0aGlzLl9fbWluICE9PSB1bmRlZmluZWQgJiYgX3YgPCB0aGlzLl9fbWluKSB7XG4gICAgICAgIF92ID0gdGhpcy5fX21pbjtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fX21heCAhPT0gdW5kZWZpbmVkICYmIF92ID4gdGhpcy5fX21heCkge1xuICAgICAgICBfdiA9IHRoaXMuX19tYXg7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5fX3N0ZXAgIT09IHVuZGVmaW5lZCAmJiBfdiAlIHRoaXMuX19zdGVwICE9PSAwKSB7XG4gICAgICAgIF92ID0gTWF0aC5yb3VuZChfdiAvIHRoaXMuX19zdGVwKSAqIHRoaXMuX19zdGVwO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGdldChOdW1iZXJDb250cm9sbGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE51bWJlckNvbnRyb2xsZXIucHJvdG90eXBlKSwgJ3NldFZhbHVlJywgdGhpcykuY2FsbCh0aGlzLCBfdik7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnbWluJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbWluKG1pblZhbHVlKSB7XG4gICAgICB0aGlzLl9fbWluID0gbWluVmFsdWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdtYXgnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBtYXgobWF4VmFsdWUpIHtcbiAgICAgIHRoaXMuX19tYXggPSBtYXhWYWx1ZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3N0ZXAnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzdGVwKHN0ZXBWYWx1ZSkge1xuICAgICAgdGhpcy5fX3N0ZXAgPSBzdGVwVmFsdWU7XG4gICAgICB0aGlzLl9faW1wbGllZFN0ZXAgPSBzdGVwVmFsdWU7XG4gICAgICB0aGlzLl9fcHJlY2lzaW9uID0gbnVtRGVjaW1hbHMoc3RlcFZhbHVlKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gTnVtYmVyQ29udHJvbGxlcjtcbn0oQ29udHJvbGxlcik7XG5cbmZ1bmN0aW9uIHJvdW5kVG9EZWNpbWFsKHZhbHVlLCBkZWNpbWFscykge1xuICB2YXIgdGVuVG8gPSBNYXRoLnBvdygxMCwgZGVjaW1hbHMpO1xuICByZXR1cm4gTWF0aC5yb3VuZCh2YWx1ZSAqIHRlblRvKSAvIHRlblRvO1xufVxudmFyIE51bWJlckNvbnRyb2xsZXJCb3ggPSBmdW5jdGlvbiAoX051bWJlckNvbnRyb2xsZXIpIHtcbiAgaW5oZXJpdHMoTnVtYmVyQ29udHJvbGxlckJveCwgX051bWJlckNvbnRyb2xsZXIpO1xuICBmdW5jdGlvbiBOdW1iZXJDb250cm9sbGVyQm94KG9iamVjdCwgcHJvcGVydHksIHBhcmFtcykge1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIE51bWJlckNvbnRyb2xsZXJCb3gpO1xuICAgIHZhciBfdGhpczIgPSBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChOdW1iZXJDb250cm9sbGVyQm94Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTnVtYmVyQ29udHJvbGxlckJveCkpLmNhbGwodGhpcywgb2JqZWN0LCBwcm9wZXJ0eSwgcGFyYW1zKSk7XG4gICAgX3RoaXMyLl9fdHJ1bmNhdGlvblN1c3BlbmRlZCA9IGZhbHNlO1xuICAgIHZhciBfdGhpcyA9IF90aGlzMjtcbiAgICB2YXIgcHJldlkgPSB2b2lkIDA7XG4gICAgZnVuY3Rpb24gb25DaGFuZ2UoKSB7XG4gICAgICB2YXIgYXR0ZW1wdGVkID0gcGFyc2VGbG9hdChfdGhpcy5fX2lucHV0LnZhbHVlKTtcbiAgICAgIGlmICghQ29tbW9uLmlzTmFOKGF0dGVtcHRlZCkpIHtcbiAgICAgICAgX3RoaXMuc2V0VmFsdWUoYXR0ZW1wdGVkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gb25GaW5pc2goKSB7XG4gICAgICBpZiAoX3RoaXMuX19vbkZpbmlzaENoYW5nZSkge1xuICAgICAgICBfdGhpcy5fX29uRmluaXNoQ2hhbmdlLmNhbGwoX3RoaXMsIF90aGlzLmdldFZhbHVlKCkpO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBvbkJsdXIoKSB7XG4gICAgICBvbkZpbmlzaCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbk1vdXNlRHJhZyhlKSB7XG4gICAgICB2YXIgZGlmZiA9IHByZXZZIC0gZS5jbGllbnRZO1xuICAgICAgX3RoaXMuc2V0VmFsdWUoX3RoaXMuZ2V0VmFsdWUoKSArIGRpZmYgKiBfdGhpcy5fX2ltcGxpZWRTdGVwKTtcbiAgICAgIHByZXZZID0gZS5jbGllbnRZO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbk1vdXNlVXAoKSB7XG4gICAgICBkb20udW5iaW5kKHdpbmRvdywgJ21vdXNlbW92ZScsIG9uTW91c2VEcmFnKTtcbiAgICAgIGRvbS51bmJpbmQod2luZG93LCAnbW91c2V1cCcsIG9uTW91c2VVcCk7XG4gICAgICBvbkZpbmlzaCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbk1vdXNlRG93bihlKSB7XG4gICAgICBkb20uYmluZCh3aW5kb3csICdtb3VzZW1vdmUnLCBvbk1vdXNlRHJhZyk7XG4gICAgICBkb20uYmluZCh3aW5kb3csICdtb3VzZXVwJywgb25Nb3VzZVVwKTtcbiAgICAgIHByZXZZID0gZS5jbGllbnRZO1xuICAgIH1cbiAgICBfdGhpczIuX19pbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgX3RoaXMyLl9faW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKTtcbiAgICBkb20uYmluZChfdGhpczIuX19pbnB1dCwgJ2NoYW5nZScsIG9uQ2hhbmdlKTtcbiAgICBkb20uYmluZChfdGhpczIuX19pbnB1dCwgJ2JsdXInLCBvbkJsdXIpO1xuICAgIGRvbS5iaW5kKF90aGlzMi5fX2lucHV0LCAnbW91c2Vkb3duJywgb25Nb3VzZURvd24pO1xuICAgIGRvbS5iaW5kKF90aGlzMi5fX2lucHV0LCAna2V5ZG93bicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAoZS5rZXlDb2RlID09PSAxMykge1xuICAgICAgICBfdGhpcy5fX3RydW5jYXRpb25TdXNwZW5kZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmJsdXIoKTtcbiAgICAgICAgX3RoaXMuX190cnVuY2F0aW9uU3VzcGVuZGVkID0gZmFsc2U7XG4gICAgICAgIG9uRmluaXNoKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgX3RoaXMyLnVwZGF0ZURpc3BsYXkoKTtcbiAgICBfdGhpczIuZG9tRWxlbWVudC5hcHBlbmRDaGlsZChfdGhpczIuX19pbnB1dCk7XG4gICAgcmV0dXJuIF90aGlzMjtcbiAgfVxuICBjcmVhdGVDbGFzcyhOdW1iZXJDb250cm9sbGVyQm94LCBbe1xuICAgIGtleTogJ3VwZGF0ZURpc3BsYXknLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVEaXNwbGF5KCkge1xuICAgICAgdGhpcy5fX2lucHV0LnZhbHVlID0gdGhpcy5fX3RydW5jYXRpb25TdXNwZW5kZWQgPyB0aGlzLmdldFZhbHVlKCkgOiByb3VuZFRvRGVjaW1hbCh0aGlzLmdldFZhbHVlKCksIHRoaXMuX19wcmVjaXNpb24pO1xuICAgICAgcmV0dXJuIGdldChOdW1iZXJDb250cm9sbGVyQm94LnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE51bWJlckNvbnRyb2xsZXJCb3gucHJvdG90eXBlKSwgJ3VwZGF0ZURpc3BsYXknLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gTnVtYmVyQ29udHJvbGxlckJveDtcbn0oTnVtYmVyQ29udHJvbGxlcik7XG5cbmZ1bmN0aW9uIG1hcCh2LCBpMSwgaTIsIG8xLCBvMikge1xuICByZXR1cm4gbzEgKyAobzIgLSBvMSkgKiAoKHYgLSBpMSkgLyAoaTIgLSBpMSkpO1xufVxudmFyIE51bWJlckNvbnRyb2xsZXJTbGlkZXIgPSBmdW5jdGlvbiAoX051bWJlckNvbnRyb2xsZXIpIHtcbiAgaW5oZXJpdHMoTnVtYmVyQ29udHJvbGxlclNsaWRlciwgX051bWJlckNvbnRyb2xsZXIpO1xuICBmdW5jdGlvbiBOdW1iZXJDb250cm9sbGVyU2xpZGVyKG9iamVjdCwgcHJvcGVydHksIG1pbiwgbWF4LCBzdGVwKSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgTnVtYmVyQ29udHJvbGxlclNsaWRlcik7XG4gICAgdmFyIF90aGlzMiA9IHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE51bWJlckNvbnRyb2xsZXJTbGlkZXIuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihOdW1iZXJDb250cm9sbGVyU2xpZGVyKSkuY2FsbCh0aGlzLCBvYmplY3QsIHByb3BlcnR5LCB7IG1pbjogbWluLCBtYXg6IG1heCwgc3RlcDogc3RlcCB9KSk7XG4gICAgdmFyIF90aGlzID0gX3RoaXMyO1xuICAgIF90aGlzMi5fX2JhY2tncm91bmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBfdGhpczIuX19mb3JlZ3JvdW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZG9tLmJpbmQoX3RoaXMyLl9fYmFja2dyb3VuZCwgJ21vdXNlZG93bicsIG9uTW91c2VEb3duKTtcbiAgICBkb20uYmluZChfdGhpczIuX19iYWNrZ3JvdW5kLCAndG91Y2hzdGFydCcsIG9uVG91Y2hTdGFydCk7XG4gICAgZG9tLmFkZENsYXNzKF90aGlzMi5fX2JhY2tncm91bmQsICdzbGlkZXInKTtcbiAgICBkb20uYWRkQ2xhc3MoX3RoaXMyLl9fZm9yZWdyb3VuZCwgJ3NsaWRlci1mZycpO1xuICAgIGZ1bmN0aW9uIG9uTW91c2VEb3duKGUpIHtcbiAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO1xuICAgICAgZG9tLmJpbmQod2luZG93LCAnbW91c2Vtb3ZlJywgb25Nb3VzZURyYWcpO1xuICAgICAgZG9tLmJpbmQod2luZG93LCAnbW91c2V1cCcsIG9uTW91c2VVcCk7XG4gICAgICBvbk1vdXNlRHJhZyhlKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25Nb3VzZURyYWcoZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdmFyIGJnUmVjdCA9IF90aGlzLl9fYmFja2dyb3VuZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIF90aGlzLnNldFZhbHVlKG1hcChlLmNsaWVudFgsIGJnUmVjdC5sZWZ0LCBiZ1JlY3QucmlnaHQsIF90aGlzLl9fbWluLCBfdGhpcy5fX21heCkpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbk1vdXNlVXAoKSB7XG4gICAgICBkb20udW5iaW5kKHdpbmRvdywgJ21vdXNlbW92ZScsIG9uTW91c2VEcmFnKTtcbiAgICAgIGRvbS51bmJpbmQod2luZG93LCAnbW91c2V1cCcsIG9uTW91c2VVcCk7XG4gICAgICBpZiAoX3RoaXMuX19vbkZpbmlzaENoYW5nZSkge1xuICAgICAgICBfdGhpcy5fX29uRmluaXNoQ2hhbmdlLmNhbGwoX3RoaXMsIF90aGlzLmdldFZhbHVlKCkpO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBvblRvdWNoU3RhcnQoZSkge1xuICAgICAgaWYgKGUudG91Y2hlcy5sZW5ndGggIT09IDEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZG9tLmJpbmQod2luZG93LCAndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgICAgZG9tLmJpbmQod2luZG93LCAndG91Y2hlbmQnLCBvblRvdWNoRW5kKTtcbiAgICAgIG9uVG91Y2hNb3ZlKGUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvblRvdWNoTW92ZShlKSB7XG4gICAgICB2YXIgY2xpZW50WCA9IGUudG91Y2hlc1swXS5jbGllbnRYO1xuICAgICAgdmFyIGJnUmVjdCA9IF90aGlzLl9fYmFja2dyb3VuZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIF90aGlzLnNldFZhbHVlKG1hcChjbGllbnRYLCBiZ1JlY3QubGVmdCwgYmdSZWN0LnJpZ2h0LCBfdGhpcy5fX21pbiwgX3RoaXMuX19tYXgpKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25Ub3VjaEVuZCgpIHtcbiAgICAgIGRvbS51bmJpbmQod2luZG93LCAndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgICAgZG9tLnVuYmluZCh3aW5kb3csICd0b3VjaGVuZCcsIG9uVG91Y2hFbmQpO1xuICAgICAgaWYgKF90aGlzLl9fb25GaW5pc2hDaGFuZ2UpIHtcbiAgICAgICAgX3RoaXMuX19vbkZpbmlzaENoYW5nZS5jYWxsKF90aGlzLCBfdGhpcy5nZXRWYWx1ZSgpKTtcbiAgICAgIH1cbiAgICB9XG4gICAgX3RoaXMyLnVwZGF0ZURpc3BsYXkoKTtcbiAgICBfdGhpczIuX19iYWNrZ3JvdW5kLmFwcGVuZENoaWxkKF90aGlzMi5fX2ZvcmVncm91bmQpO1xuICAgIF90aGlzMi5kb21FbGVtZW50LmFwcGVuZENoaWxkKF90aGlzMi5fX2JhY2tncm91bmQpO1xuICAgIHJldHVybiBfdGhpczI7XG4gIH1cbiAgY3JlYXRlQ2xhc3MoTnVtYmVyQ29udHJvbGxlclNsaWRlciwgW3tcbiAgICBrZXk6ICd1cGRhdGVEaXNwbGF5JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlRGlzcGxheSgpIHtcbiAgICAgIHZhciBwY3QgPSAodGhpcy5nZXRWYWx1ZSgpIC0gdGhpcy5fX21pbikgLyAodGhpcy5fX21heCAtIHRoaXMuX19taW4pO1xuICAgICAgdGhpcy5fX2ZvcmVncm91bmQuc3R5bGUud2lkdGggPSBwY3QgKiAxMDAgKyAnJSc7XG4gICAgICByZXR1cm4gZ2V0KE51bWJlckNvbnRyb2xsZXJTbGlkZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTnVtYmVyQ29udHJvbGxlclNsaWRlci5wcm90b3R5cGUpLCAndXBkYXRlRGlzcGxheScsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBOdW1iZXJDb250cm9sbGVyU2xpZGVyO1xufShOdW1iZXJDb250cm9sbGVyKTtcblxudmFyIEZ1bmN0aW9uQ29udHJvbGxlciA9IGZ1bmN0aW9uIChfQ29udHJvbGxlcikge1xuICBpbmhlcml0cyhGdW5jdGlvbkNvbnRyb2xsZXIsIF9Db250cm9sbGVyKTtcbiAgZnVuY3Rpb24gRnVuY3Rpb25Db250cm9sbGVyKG9iamVjdCwgcHJvcGVydHksIHRleHQpIHtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBGdW5jdGlvbkNvbnRyb2xsZXIpO1xuICAgIHZhciBfdGhpczIgPSBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChGdW5jdGlvbkNvbnRyb2xsZXIuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihGdW5jdGlvbkNvbnRyb2xsZXIpKS5jYWxsKHRoaXMsIG9iamVjdCwgcHJvcGVydHkpKTtcbiAgICB2YXIgX3RoaXMgPSBfdGhpczI7XG4gICAgX3RoaXMyLl9fYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgX3RoaXMyLl9fYnV0dG9uLmlubmVySFRNTCA9IHRleHQgPT09IHVuZGVmaW5lZCA/ICdGaXJlJyA6IHRleHQ7XG4gICAgZG9tLmJpbmQoX3RoaXMyLl9fYnV0dG9uLCAnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgX3RoaXMuZmlyZSgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICAgIGRvbS5hZGRDbGFzcyhfdGhpczIuX19idXR0b24sICdidXR0b24nKTtcbiAgICBfdGhpczIuZG9tRWxlbWVudC5hcHBlbmRDaGlsZChfdGhpczIuX19idXR0b24pO1xuICAgIHJldHVybiBfdGhpczI7XG4gIH1cbiAgY3JlYXRlQ2xhc3MoRnVuY3Rpb25Db250cm9sbGVyLCBbe1xuICAgIGtleTogJ2ZpcmUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBmaXJlKCkge1xuICAgICAgaWYgKHRoaXMuX19vbkNoYW5nZSkge1xuICAgICAgICB0aGlzLl9fb25DaGFuZ2UuY2FsbCh0aGlzKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZ2V0VmFsdWUoKS5jYWxsKHRoaXMub2JqZWN0KTtcbiAgICAgIGlmICh0aGlzLl9fb25GaW5pc2hDaGFuZ2UpIHtcbiAgICAgICAgdGhpcy5fX29uRmluaXNoQ2hhbmdlLmNhbGwodGhpcywgdGhpcy5nZXRWYWx1ZSgpKTtcbiAgICAgIH1cbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIEZ1bmN0aW9uQ29udHJvbGxlcjtcbn0oQ29udHJvbGxlcik7XG5cbnZhciBDb2xvckNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoX0NvbnRyb2xsZXIpIHtcbiAgaW5oZXJpdHMoQ29sb3JDb250cm9sbGVyLCBfQ29udHJvbGxlcik7XG4gIGZ1bmN0aW9uIENvbG9yQ29udHJvbGxlcihvYmplY3QsIHByb3BlcnR5KSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29sb3JDb250cm9sbGVyKTtcbiAgICB2YXIgX3RoaXMyID0gcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoQ29sb3JDb250cm9sbGVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoQ29sb3JDb250cm9sbGVyKSkuY2FsbCh0aGlzLCBvYmplY3QsIHByb3BlcnR5KSk7XG4gICAgX3RoaXMyLl9fY29sb3IgPSBuZXcgQ29sb3IoX3RoaXMyLmdldFZhbHVlKCkpO1xuICAgIF90aGlzMi5fX3RlbXAgPSBuZXcgQ29sb3IoMCk7XG4gICAgdmFyIF90aGlzID0gX3RoaXMyO1xuICAgIF90aGlzMi5kb21FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZG9tLm1ha2VTZWxlY3RhYmxlKF90aGlzMi5kb21FbGVtZW50LCBmYWxzZSk7XG4gICAgX3RoaXMyLl9fc2VsZWN0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBfdGhpczIuX19zZWxlY3Rvci5jbGFzc05hbWUgPSAnc2VsZWN0b3InO1xuICAgIF90aGlzMi5fX3NhdHVyYXRpb25fZmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBfdGhpczIuX19zYXR1cmF0aW9uX2ZpZWxkLmNsYXNzTmFtZSA9ICdzYXR1cmF0aW9uLWZpZWxkJztcbiAgICBfdGhpczIuX19maWVsZF9rbm9iID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgX3RoaXMyLl9fZmllbGRfa25vYi5jbGFzc05hbWUgPSAnZmllbGQta25vYic7XG4gICAgX3RoaXMyLl9fZmllbGRfa25vYl9ib3JkZXIgPSAnMnB4IHNvbGlkICc7XG4gICAgX3RoaXMyLl9faHVlX2tub2IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBfdGhpczIuX19odWVfa25vYi5jbGFzc05hbWUgPSAnaHVlLWtub2InO1xuICAgIF90aGlzMi5fX2h1ZV9maWVsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIF90aGlzMi5fX2h1ZV9maWVsZC5jbGFzc05hbWUgPSAnaHVlLWZpZWxkJztcbiAgICBfdGhpczIuX19pbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgX3RoaXMyLl9faW5wdXQudHlwZSA9ICd0ZXh0JztcbiAgICBfdGhpczIuX19pbnB1dF90ZXh0U2hhZG93ID0gJzAgMXB4IDFweCAnO1xuICAgIGRvbS5iaW5kKF90aGlzMi5fX2lucHV0LCAna2V5ZG93bicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAoZS5rZXlDb2RlID09PSAxMykge1xuICAgICAgICBvbkJsdXIuY2FsbCh0aGlzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBkb20uYmluZChfdGhpczIuX19pbnB1dCwgJ2JsdXInLCBvbkJsdXIpO1xuICAgIGRvbS5iaW5kKF90aGlzMi5fX3NlbGVjdG9yLCAnbW91c2Vkb3duJywgZnVuY3Rpb24gKCkgICAgICAgIHtcbiAgICAgIGRvbS5hZGRDbGFzcyh0aGlzLCAnZHJhZycpLmJpbmQod2luZG93LCAnbW91c2V1cCcsIGZ1bmN0aW9uICgpICAgICAgICB7XG4gICAgICAgIGRvbS5yZW1vdmVDbGFzcyhfdGhpcy5fX3NlbGVjdG9yLCAnZHJhZycpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgZG9tLmJpbmQoX3RoaXMyLl9fc2VsZWN0b3IsICd0b3VjaHN0YXJ0JywgZnVuY3Rpb24gKCkgICAgICAgIHtcbiAgICAgIGRvbS5hZGRDbGFzcyh0aGlzLCAnZHJhZycpLmJpbmQod2luZG93LCAndG91Y2hlbmQnLCBmdW5jdGlvbiAoKSAgICAgICAge1xuICAgICAgICBkb20ucmVtb3ZlQ2xhc3MoX3RoaXMuX19zZWxlY3RvciwgJ2RyYWcnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHZhciB2YWx1ZUZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgQ29tbW9uLmV4dGVuZChfdGhpczIuX19zZWxlY3Rvci5zdHlsZSwge1xuICAgICAgd2lkdGg6ICcxMjJweCcsXG4gICAgICBoZWlnaHQ6ICcxMDJweCcsXG4gICAgICBwYWRkaW5nOiAnM3B4JyxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogJyMyMjInLFxuICAgICAgYm94U2hhZG93OiAnMHB4IDFweCAzcHggcmdiYSgwLDAsMCwwLjMpJ1xuICAgIH0pO1xuICAgIENvbW1vbi5leHRlbmQoX3RoaXMyLl9fZmllbGRfa25vYi5zdHlsZSwge1xuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICB3aWR0aDogJzEycHgnLFxuICAgICAgaGVpZ2h0OiAnMTJweCcsXG4gICAgICBib3JkZXI6IF90aGlzMi5fX2ZpZWxkX2tub2JfYm9yZGVyICsgKF90aGlzMi5fX2NvbG9yLnYgPCAwLjUgPyAnI2ZmZicgOiAnIzAwMCcpLFxuICAgICAgYm94U2hhZG93OiAnMHB4IDFweCAzcHggcmdiYSgwLDAsMCwwLjUpJyxcbiAgICAgIGJvcmRlclJhZGl1czogJzEycHgnLFxuICAgICAgekluZGV4OiAxXG4gICAgfSk7XG4gICAgQ29tbW9uLmV4dGVuZChfdGhpczIuX19odWVfa25vYi5zdHlsZSwge1xuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICB3aWR0aDogJzE1cHgnLFxuICAgICAgaGVpZ2h0OiAnMnB4JyxcbiAgICAgIGJvcmRlclJpZ2h0OiAnNHB4IHNvbGlkICNmZmYnLFxuICAgICAgekluZGV4OiAxXG4gICAgfSk7XG4gICAgQ29tbW9uLmV4dGVuZChfdGhpczIuX19zYXR1cmF0aW9uX2ZpZWxkLnN0eWxlLCB7XG4gICAgICB3aWR0aDogJzEwMHB4JyxcbiAgICAgIGhlaWdodDogJzEwMHB4JyxcbiAgICAgIGJvcmRlcjogJzFweCBzb2xpZCAjNTU1JyxcbiAgICAgIG1hcmdpblJpZ2h0OiAnM3B4JyxcbiAgICAgIGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snLFxuICAgICAgY3Vyc29yOiAncG9pbnRlcidcbiAgICB9KTtcbiAgICBDb21tb24uZXh0ZW5kKHZhbHVlRmllbGQuc3R5bGUsIHtcbiAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgICBoZWlnaHQ6ICcxMDAlJyxcbiAgICAgIGJhY2tncm91bmQ6ICdub25lJ1xuICAgIH0pO1xuICAgIGxpbmVhckdyYWRpZW50KHZhbHVlRmllbGQsICd0b3AnLCAncmdiYSgwLDAsMCwwKScsICcjMDAwJyk7XG4gICAgQ29tbW9uLmV4dGVuZChfdGhpczIuX19odWVfZmllbGQuc3R5bGUsIHtcbiAgICAgIHdpZHRoOiAnMTVweCcsXG4gICAgICBoZWlnaHQ6ICcxMDBweCcsXG4gICAgICBib3JkZXI6ICcxcHggc29saWQgIzU1NScsXG4gICAgICBjdXJzb3I6ICducy1yZXNpemUnLFxuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICB0b3A6ICczcHgnLFxuICAgICAgcmlnaHQ6ICczcHgnXG4gICAgfSk7XG4gICAgaHVlR3JhZGllbnQoX3RoaXMyLl9faHVlX2ZpZWxkKTtcbiAgICBDb21tb24uZXh0ZW5kKF90aGlzMi5fX2lucHV0LnN0eWxlLCB7XG4gICAgICBvdXRsaW5lOiAnbm9uZScsXG4gICAgICB0ZXh0QWxpZ246ICdjZW50ZXInLFxuICAgICAgY29sb3I6ICcjZmZmJyxcbiAgICAgIGJvcmRlcjogMCxcbiAgICAgIGZvbnRXZWlnaHQ6ICdib2xkJyxcbiAgICAgIHRleHRTaGFkb3c6IF90aGlzMi5fX2lucHV0X3RleHRTaGFkb3cgKyAncmdiYSgwLDAsMCwwLjcpJ1xuICAgIH0pO1xuICAgIGRvbS5iaW5kKF90aGlzMi5fX3NhdHVyYXRpb25fZmllbGQsICdtb3VzZWRvd24nLCBmaWVsZERvd24pO1xuICAgIGRvbS5iaW5kKF90aGlzMi5fX3NhdHVyYXRpb25fZmllbGQsICd0b3VjaHN0YXJ0JywgZmllbGREb3duKTtcbiAgICBkb20uYmluZChfdGhpczIuX19maWVsZF9rbm9iLCAnbW91c2Vkb3duJywgZmllbGREb3duKTtcbiAgICBkb20uYmluZChfdGhpczIuX19maWVsZF9rbm9iLCAndG91Y2hzdGFydCcsIGZpZWxkRG93bik7XG4gICAgZG9tLmJpbmQoX3RoaXMyLl9faHVlX2ZpZWxkLCAnbW91c2Vkb3duJywgZmllbGREb3duSCk7XG4gICAgZG9tLmJpbmQoX3RoaXMyLl9faHVlX2ZpZWxkLCAndG91Y2hzdGFydCcsIGZpZWxkRG93bkgpO1xuICAgIGZ1bmN0aW9uIGZpZWxkRG93bihlKSB7XG4gICAgICBzZXRTVihlKTtcbiAgICAgIGRvbS5iaW5kKHdpbmRvdywgJ21vdXNlbW92ZScsIHNldFNWKTtcbiAgICAgIGRvbS5iaW5kKHdpbmRvdywgJ3RvdWNobW92ZScsIHNldFNWKTtcbiAgICAgIGRvbS5iaW5kKHdpbmRvdywgJ21vdXNldXAnLCBmaWVsZFVwU1YpO1xuICAgICAgZG9tLmJpbmQod2luZG93LCAndG91Y2hlbmQnLCBmaWVsZFVwU1YpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBmaWVsZERvd25IKGUpIHtcbiAgICAgIHNldEgoZSk7XG4gICAgICBkb20uYmluZCh3aW5kb3csICdtb3VzZW1vdmUnLCBzZXRIKTtcbiAgICAgIGRvbS5iaW5kKHdpbmRvdywgJ3RvdWNobW92ZScsIHNldEgpO1xuICAgICAgZG9tLmJpbmQod2luZG93LCAnbW91c2V1cCcsIGZpZWxkVXBIKTtcbiAgICAgIGRvbS5iaW5kKHdpbmRvdywgJ3RvdWNoZW5kJywgZmllbGRVcEgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBmaWVsZFVwU1YoKSB7XG4gICAgICBkb20udW5iaW5kKHdpbmRvdywgJ21vdXNlbW92ZScsIHNldFNWKTtcbiAgICAgIGRvbS51bmJpbmQod2luZG93LCAndG91Y2htb3ZlJywgc2V0U1YpO1xuICAgICAgZG9tLnVuYmluZCh3aW5kb3csICdtb3VzZXVwJywgZmllbGRVcFNWKTtcbiAgICAgIGRvbS51bmJpbmQod2luZG93LCAndG91Y2hlbmQnLCBmaWVsZFVwU1YpO1xuICAgICAgb25GaW5pc2goKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZmllbGRVcEgoKSB7XG4gICAgICBkb20udW5iaW5kKHdpbmRvdywgJ21vdXNlbW92ZScsIHNldEgpO1xuICAgICAgZG9tLnVuYmluZCh3aW5kb3csICd0b3VjaG1vdmUnLCBzZXRIKTtcbiAgICAgIGRvbS51bmJpbmQod2luZG93LCAnbW91c2V1cCcsIGZpZWxkVXBIKTtcbiAgICAgIGRvbS51bmJpbmQod2luZG93LCAndG91Y2hlbmQnLCBmaWVsZFVwSCk7XG4gICAgICBvbkZpbmlzaCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbkJsdXIoKSB7XG4gICAgICB2YXIgaSA9IGludGVycHJldCh0aGlzLnZhbHVlKTtcbiAgICAgIGlmIChpICE9PSBmYWxzZSkge1xuICAgICAgICBfdGhpcy5fX2NvbG9yLl9fc3RhdGUgPSBpO1xuICAgICAgICBfdGhpcy5zZXRWYWx1ZShfdGhpcy5fX2NvbG9yLnRvT3JpZ2luYWwoKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnZhbHVlID0gX3RoaXMuX19jb2xvci50b1N0cmluZygpO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBvbkZpbmlzaCgpIHtcbiAgICAgIGlmIChfdGhpcy5fX29uRmluaXNoQ2hhbmdlKSB7XG4gICAgICAgIF90aGlzLl9fb25GaW5pc2hDaGFuZ2UuY2FsbChfdGhpcywgX3RoaXMuX19jb2xvci50b09yaWdpbmFsKCkpO1xuICAgICAgfVxuICAgIH1cbiAgICBfdGhpczIuX19zYXR1cmF0aW9uX2ZpZWxkLmFwcGVuZENoaWxkKHZhbHVlRmllbGQpO1xuICAgIF90aGlzMi5fX3NlbGVjdG9yLmFwcGVuZENoaWxkKF90aGlzMi5fX2ZpZWxkX2tub2IpO1xuICAgIF90aGlzMi5fX3NlbGVjdG9yLmFwcGVuZENoaWxkKF90aGlzMi5fX3NhdHVyYXRpb25fZmllbGQpO1xuICAgIF90aGlzMi5fX3NlbGVjdG9yLmFwcGVuZENoaWxkKF90aGlzMi5fX2h1ZV9maWVsZCk7XG4gICAgX3RoaXMyLl9faHVlX2ZpZWxkLmFwcGVuZENoaWxkKF90aGlzMi5fX2h1ZV9rbm9iKTtcbiAgICBfdGhpczIuZG9tRWxlbWVudC5hcHBlbmRDaGlsZChfdGhpczIuX19pbnB1dCk7XG4gICAgX3RoaXMyLmRvbUVsZW1lbnQuYXBwZW5kQ2hpbGQoX3RoaXMyLl9fc2VsZWN0b3IpO1xuICAgIF90aGlzMi51cGRhdGVEaXNwbGF5KCk7XG4gICAgZnVuY3Rpb24gc2V0U1YoZSkge1xuICAgICAgaWYgKGUudHlwZS5pbmRleE9mKCd0b3VjaCcpID09PSAtMSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgICB2YXIgZmllbGRSZWN0ID0gX3RoaXMuX19zYXR1cmF0aW9uX2ZpZWxkLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgdmFyIF9yZWYgPSBlLnRvdWNoZXMgJiYgZS50b3VjaGVzWzBdIHx8IGUsXG4gICAgICAgICAgY2xpZW50WCA9IF9yZWYuY2xpZW50WCxcbiAgICAgICAgICBjbGllbnRZID0gX3JlZi5jbGllbnRZO1xuICAgICAgdmFyIHMgPSAoY2xpZW50WCAtIGZpZWxkUmVjdC5sZWZ0KSAvIChmaWVsZFJlY3QucmlnaHQgLSBmaWVsZFJlY3QubGVmdCk7XG4gICAgICB2YXIgdiA9IDEgLSAoY2xpZW50WSAtIGZpZWxkUmVjdC50b3ApIC8gKGZpZWxkUmVjdC5ib3R0b20gLSBmaWVsZFJlY3QudG9wKTtcbiAgICAgIGlmICh2ID4gMSkge1xuICAgICAgICB2ID0gMTtcbiAgICAgIH0gZWxzZSBpZiAodiA8IDApIHtcbiAgICAgICAgdiA9IDA7XG4gICAgICB9XG4gICAgICBpZiAocyA+IDEpIHtcbiAgICAgICAgcyA9IDE7XG4gICAgICB9IGVsc2UgaWYgKHMgPCAwKSB7XG4gICAgICAgIHMgPSAwO1xuICAgICAgfVxuICAgICAgX3RoaXMuX19jb2xvci52ID0gdjtcbiAgICAgIF90aGlzLl9fY29sb3IucyA9IHM7XG4gICAgICBfdGhpcy5zZXRWYWx1ZShfdGhpcy5fX2NvbG9yLnRvT3JpZ2luYWwoKSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldEgoZSkge1xuICAgICAgaWYgKGUudHlwZS5pbmRleE9mKCd0b3VjaCcpID09PSAtMSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgICB2YXIgZmllbGRSZWN0ID0gX3RoaXMuX19odWVfZmllbGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICB2YXIgX3JlZjIgPSBlLnRvdWNoZXMgJiYgZS50b3VjaGVzWzBdIHx8IGUsXG4gICAgICAgICAgY2xpZW50WSA9IF9yZWYyLmNsaWVudFk7XG4gICAgICB2YXIgaCA9IDEgLSAoY2xpZW50WSAtIGZpZWxkUmVjdC50b3ApIC8gKGZpZWxkUmVjdC5ib3R0b20gLSBmaWVsZFJlY3QudG9wKTtcbiAgICAgIGlmIChoID4gMSkge1xuICAgICAgICBoID0gMTtcbiAgICAgIH0gZWxzZSBpZiAoaCA8IDApIHtcbiAgICAgICAgaCA9IDA7XG4gICAgICB9XG4gICAgICBfdGhpcy5fX2NvbG9yLmggPSBoICogMzYwO1xuICAgICAgX3RoaXMuc2V0VmFsdWUoX3RoaXMuX19jb2xvci50b09yaWdpbmFsKCkpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gX3RoaXMyO1xuICB9XG4gIGNyZWF0ZUNsYXNzKENvbG9yQ29udHJvbGxlciwgW3tcbiAgICBrZXk6ICd1cGRhdGVEaXNwbGF5JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlRGlzcGxheSgpIHtcbiAgICAgIHZhciBpID0gaW50ZXJwcmV0KHRoaXMuZ2V0VmFsdWUoKSk7XG4gICAgICBpZiAoaSAhPT0gZmFsc2UpIHtcbiAgICAgICAgdmFyIG1pc21hdGNoID0gZmFsc2U7XG4gICAgICAgIENvbW1vbi5lYWNoKENvbG9yLkNPTVBPTkVOVFMsIGZ1bmN0aW9uIChjb21wb25lbnQpIHtcbiAgICAgICAgICBpZiAoIUNvbW1vbi5pc1VuZGVmaW5lZChpW2NvbXBvbmVudF0pICYmICFDb21tb24uaXNVbmRlZmluZWQodGhpcy5fX2NvbG9yLl9fc3RhdGVbY29tcG9uZW50XSkgJiYgaVtjb21wb25lbnRdICE9PSB0aGlzLl9fY29sb3IuX19zdGF0ZVtjb21wb25lbnRdKSB7XG4gICAgICAgICAgICBtaXNtYXRjaCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgaWYgKG1pc21hdGNoKSB7XG4gICAgICAgICAgQ29tbW9uLmV4dGVuZCh0aGlzLl9fY29sb3IuX19zdGF0ZSwgaSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIENvbW1vbi5leHRlbmQodGhpcy5fX3RlbXAuX19zdGF0ZSwgdGhpcy5fX2NvbG9yLl9fc3RhdGUpO1xuICAgICAgdGhpcy5fX3RlbXAuYSA9IDE7XG4gICAgICB2YXIgZmxpcCA9IHRoaXMuX19jb2xvci52IDwgMC41IHx8IHRoaXMuX19jb2xvci5zID4gMC41ID8gMjU1IDogMDtcbiAgICAgIHZhciBfZmxpcCA9IDI1NSAtIGZsaXA7XG4gICAgICBDb21tb24uZXh0ZW5kKHRoaXMuX19maWVsZF9rbm9iLnN0eWxlLCB7XG4gICAgICAgIG1hcmdpbkxlZnQ6IDEwMCAqIHRoaXMuX19jb2xvci5zIC0gNyArICdweCcsXG4gICAgICAgIG1hcmdpblRvcDogMTAwICogKDEgLSB0aGlzLl9fY29sb3IudikgLSA3ICsgJ3B4JyxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLl9fdGVtcC50b0hleFN0cmluZygpLFxuICAgICAgICBib3JkZXI6IHRoaXMuX19maWVsZF9rbm9iX2JvcmRlciArICdyZ2IoJyArIGZsaXAgKyAnLCcgKyBmbGlwICsgJywnICsgZmxpcCArICcpJ1xuICAgICAgfSk7XG4gICAgICB0aGlzLl9faHVlX2tub2Iuc3R5bGUubWFyZ2luVG9wID0gKDEgLSB0aGlzLl9fY29sb3IuaCAvIDM2MCkgKiAxMDAgKyAncHgnO1xuICAgICAgdGhpcy5fX3RlbXAucyA9IDE7XG4gICAgICB0aGlzLl9fdGVtcC52ID0gMTtcbiAgICAgIGxpbmVhckdyYWRpZW50KHRoaXMuX19zYXR1cmF0aW9uX2ZpZWxkLCAnbGVmdCcsICcjZmZmJywgdGhpcy5fX3RlbXAudG9IZXhTdHJpbmcoKSk7XG4gICAgICB0aGlzLl9faW5wdXQudmFsdWUgPSB0aGlzLl9fY29sb3IudG9TdHJpbmcoKTtcbiAgICAgIENvbW1vbi5leHRlbmQodGhpcy5fX2lucHV0LnN0eWxlLCB7XG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5fX2NvbG9yLnRvSGV4U3RyaW5nKCksXG4gICAgICAgIGNvbG9yOiAncmdiKCcgKyBmbGlwICsgJywnICsgZmxpcCArICcsJyArIGZsaXAgKyAnKScsXG4gICAgICAgIHRleHRTaGFkb3c6IHRoaXMuX19pbnB1dF90ZXh0U2hhZG93ICsgJ3JnYmEoJyArIF9mbGlwICsgJywnICsgX2ZsaXAgKyAnLCcgKyBfZmxpcCArICcsLjcpJ1xuICAgICAgfSk7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBDb2xvckNvbnRyb2xsZXI7XG59KENvbnRyb2xsZXIpO1xudmFyIHZlbmRvcnMgPSBbJy1tb3otJywgJy1vLScsICctd2Via2l0LScsICctbXMtJywgJyddO1xuZnVuY3Rpb24gbGluZWFyR3JhZGllbnQoZWxlbSwgeCwgYSwgYikge1xuICBlbGVtLnN0eWxlLmJhY2tncm91bmQgPSAnJztcbiAgQ29tbW9uLmVhY2godmVuZG9ycywgZnVuY3Rpb24gKHZlbmRvcikge1xuICAgIGVsZW0uc3R5bGUuY3NzVGV4dCArPSAnYmFja2dyb3VuZDogJyArIHZlbmRvciArICdsaW5lYXItZ3JhZGllbnQoJyArIHggKyAnLCAnICsgYSArICcgMCUsICcgKyBiICsgJyAxMDAlKTsgJztcbiAgfSk7XG59XG5mdW5jdGlvbiBodWVHcmFkaWVudChlbGVtKSB7XG4gIGVsZW0uc3R5bGUuYmFja2dyb3VuZCA9ICcnO1xuICBlbGVtLnN0eWxlLmNzc1RleHQgKz0gJ2JhY2tncm91bmQ6IC1tb3otbGluZWFyLWdyYWRpZW50KHRvcCwgICNmZjAwMDAgMCUsICNmZjAwZmYgMTclLCAjMDAwMGZmIDM0JSwgIzAwZmZmZiA1MCUsICMwMGZmMDAgNjclLCAjZmZmZjAwIDg0JSwgI2ZmMDAwMCAxMDAlKTsnO1xuICBlbGVtLnN0eWxlLmNzc1RleHQgKz0gJ2JhY2tncm91bmQ6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgICNmZjAwMDAgMCUsI2ZmMDBmZiAxNyUsIzAwMDBmZiAzNCUsIzAwZmZmZiA1MCUsIzAwZmYwMCA2NyUsI2ZmZmYwMCA4NCUsI2ZmMDAwMCAxMDAlKTsnO1xuICBlbGVtLnN0eWxlLmNzc1RleHQgKz0gJ2JhY2tncm91bmQ6IC1vLWxpbmVhci1ncmFkaWVudCh0b3AsICAjZmYwMDAwIDAlLCNmZjAwZmYgMTclLCMwMDAwZmYgMzQlLCMwMGZmZmYgNTAlLCMwMGZmMDAgNjclLCNmZmZmMDAgODQlLCNmZjAwMDAgMTAwJSk7JztcbiAgZWxlbS5zdHlsZS5jc3NUZXh0ICs9ICdiYWNrZ3JvdW5kOiAtbXMtbGluZWFyLWdyYWRpZW50KHRvcCwgICNmZjAwMDAgMCUsI2ZmMDBmZiAxNyUsIzAwMDBmZiAzNCUsIzAwZmZmZiA1MCUsIzAwZmYwMCA2NyUsI2ZmZmYwMCA4NCUsI2ZmMDAwMCAxMDAlKTsnO1xuICBlbGVtLnN0eWxlLmNzc1RleHQgKz0gJ2JhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0b3AsICAjZmYwMDAwIDAlLCNmZjAwZmYgMTclLCMwMDAwZmYgMzQlLCMwMGZmZmYgNTAlLCMwMGZmMDAgNjclLCNmZmZmMDAgODQlLCNmZjAwMDAgMTAwJSk7Jztcbn1cblxudmFyIGNzcyA9IHtcbiAgbG9hZDogZnVuY3Rpb24gbG9hZCh1cmwsIGluZG9jKSB7XG4gICAgdmFyIGRvYyA9IGluZG9jIHx8IGRvY3VtZW50O1xuICAgIHZhciBsaW5rID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICBsaW5rLnR5cGUgPSAndGV4dC9jc3MnO1xuICAgIGxpbmsucmVsID0gJ3N0eWxlc2hlZXQnO1xuICAgIGxpbmsuaHJlZiA9IHVybDtcbiAgICBkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXS5hcHBlbmRDaGlsZChsaW5rKTtcbiAgfSxcbiAgaW5qZWN0OiBmdW5jdGlvbiBpbmplY3QoY3NzQ29udGVudCwgaW5kb2MpIHtcbiAgICB2YXIgZG9jID0gaW5kb2MgfHwgZG9jdW1lbnQ7XG4gICAgdmFyIGluamVjdGVkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICBpbmplY3RlZC50eXBlID0gJ3RleHQvY3NzJztcbiAgICBpbmplY3RlZC5pbm5lckhUTUwgPSBjc3NDb250ZW50O1xuICAgIHZhciBoZWFkID0gZG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07XG4gICAgdHJ5IHtcbiAgICAgIGhlYWQuYXBwZW5kQ2hpbGQoaW5qZWN0ZWQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICB9XG4gIH1cbn07XG5cbnZhciBzYXZlRGlhbG9nQ29udGVudHMgPSBcIjxkaXYgaWQ9XFxcImRnLXNhdmVcXFwiIGNsYXNzPVxcXCJkZyBkaWFsb2d1ZVxcXCI+XFxuXFxuICBIZXJlJ3MgdGhlIG5ldyBsb2FkIHBhcmFtZXRlciBmb3IgeW91ciA8Y29kZT5HVUk8L2NvZGU+J3MgY29uc3RydWN0b3I6XFxuXFxuICA8dGV4dGFyZWEgaWQ9XFxcImRnLW5ldy1jb25zdHJ1Y3RvclxcXCI+PC90ZXh0YXJlYT5cXG5cXG4gIDxkaXYgaWQ9XFxcImRnLXNhdmUtbG9jYWxseVxcXCI+XFxuXFxuICAgIDxpbnB1dCBpZD1cXFwiZGctbG9jYWwtc3RvcmFnZVxcXCIgdHlwZT1cXFwiY2hlY2tib3hcXFwiLz4gQXV0b21hdGljYWxseSBzYXZlXFxuICAgIHZhbHVlcyB0byA8Y29kZT5sb2NhbFN0b3JhZ2U8L2NvZGU+IG9uIGV4aXQuXFxuXFxuICAgIDxkaXYgaWQ9XFxcImRnLWxvY2FsLWV4cGxhaW5cXFwiPlRoZSB2YWx1ZXMgc2F2ZWQgdG8gPGNvZGU+bG9jYWxTdG9yYWdlPC9jb2RlPiB3aWxsXFxuICAgICAgb3ZlcnJpZGUgdGhvc2UgcGFzc2VkIHRvIDxjb2RlPmRhdC5HVUk8L2NvZGU+J3MgY29uc3RydWN0b3IuIFRoaXMgbWFrZXMgaXRcXG4gICAgICBlYXNpZXIgdG8gd29yayBpbmNyZW1lbnRhbGx5LCBidXQgPGNvZGU+bG9jYWxTdG9yYWdlPC9jb2RlPiBpcyBmcmFnaWxlLFxcbiAgICAgIGFuZCB5b3VyIGZyaWVuZHMgbWF5IG5vdCBzZWUgdGhlIHNhbWUgdmFsdWVzIHlvdSBkby5cXG5cXG4gICAgPC9kaXY+XFxuXFxuICA8L2Rpdj5cXG5cXG48L2Rpdj5cIjtcblxudmFyIENvbnRyb2xsZXJGYWN0b3J5ID0gZnVuY3Rpb24gQ29udHJvbGxlckZhY3Rvcnkob2JqZWN0LCBwcm9wZXJ0eSkge1xuICB2YXIgaW5pdGlhbFZhbHVlID0gb2JqZWN0W3Byb3BlcnR5XTtcbiAgaWYgKENvbW1vbi5pc0FycmF5KGFyZ3VtZW50c1syXSkgfHwgQ29tbW9uLmlzT2JqZWN0KGFyZ3VtZW50c1syXSkpIHtcbiAgICByZXR1cm4gbmV3IE9wdGlvbkNvbnRyb2xsZXIob2JqZWN0LCBwcm9wZXJ0eSwgYXJndW1lbnRzWzJdKTtcbiAgfVxuICBpZiAoQ29tbW9uLmlzTnVtYmVyKGluaXRpYWxWYWx1ZSkpIHtcbiAgICBpZiAoQ29tbW9uLmlzTnVtYmVyKGFyZ3VtZW50c1syXSkgJiYgQ29tbW9uLmlzTnVtYmVyKGFyZ3VtZW50c1szXSkpIHtcbiAgICAgIGlmIChDb21tb24uaXNOdW1iZXIoYXJndW1lbnRzWzRdKSkge1xuICAgICAgICByZXR1cm4gbmV3IE51bWJlckNvbnRyb2xsZXJTbGlkZXIob2JqZWN0LCBwcm9wZXJ0eSwgYXJndW1lbnRzWzJdLCBhcmd1bWVudHNbM10sIGFyZ3VtZW50c1s0XSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3IE51bWJlckNvbnRyb2xsZXJTbGlkZXIob2JqZWN0LCBwcm9wZXJ0eSwgYXJndW1lbnRzWzJdLCBhcmd1bWVudHNbM10pO1xuICAgIH1cbiAgICBpZiAoQ29tbW9uLmlzTnVtYmVyKGFyZ3VtZW50c1s0XSkpIHtcbiAgICAgIHJldHVybiBuZXcgTnVtYmVyQ29udHJvbGxlckJveChvYmplY3QsIHByb3BlcnR5LCB7IG1pbjogYXJndW1lbnRzWzJdLCBtYXg6IGFyZ3VtZW50c1szXSwgc3RlcDogYXJndW1lbnRzWzRdIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IE51bWJlckNvbnRyb2xsZXJCb3gob2JqZWN0LCBwcm9wZXJ0eSwgeyBtaW46IGFyZ3VtZW50c1syXSwgbWF4OiBhcmd1bWVudHNbM10gfSk7XG4gIH1cbiAgaWYgKENvbW1vbi5pc1N0cmluZyhpbml0aWFsVmFsdWUpKSB7XG4gICAgcmV0dXJuIG5ldyBTdHJpbmdDb250cm9sbGVyKG9iamVjdCwgcHJvcGVydHkpO1xuICB9XG4gIGlmIChDb21tb24uaXNGdW5jdGlvbihpbml0aWFsVmFsdWUpKSB7XG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbkNvbnRyb2xsZXIob2JqZWN0LCBwcm9wZXJ0eSwgJycpO1xuICB9XG4gIGlmIChDb21tb24uaXNCb29sZWFuKGluaXRpYWxWYWx1ZSkpIHtcbiAgICByZXR1cm4gbmV3IEJvb2xlYW5Db250cm9sbGVyKG9iamVjdCwgcHJvcGVydHkpO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcblxuZnVuY3Rpb24gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNhbGxiYWNrKSB7XG4gIHNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDAgLyA2MCk7XG59XG52YXIgcmVxdWVzdEFuaW1hdGlvbkZyYW1lJDEgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXG52YXIgQ2VudGVyZWREaXYgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENlbnRlcmVkRGl2KCkge1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIENlbnRlcmVkRGl2KTtcbiAgICB0aGlzLmJhY2tncm91bmRFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgQ29tbW9uLmV4dGVuZCh0aGlzLmJhY2tncm91bmRFbGVtZW50LnN0eWxlLCB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDAsMCwwLDAuOCknLFxuICAgICAgdG9wOiAwLFxuICAgICAgbGVmdDogMCxcbiAgICAgIGRpc3BsYXk6ICdub25lJyxcbiAgICAgIHpJbmRleDogJzEwMDAnLFxuICAgICAgb3BhY2l0eTogMCxcbiAgICAgIFdlYmtpdFRyYW5zaXRpb246ICdvcGFjaXR5IDAuMnMgbGluZWFyJyxcbiAgICAgIHRyYW5zaXRpb246ICdvcGFjaXR5IDAuMnMgbGluZWFyJ1xuICAgIH0pO1xuICAgIGRvbS5tYWtlRnVsbHNjcmVlbih0aGlzLmJhY2tncm91bmRFbGVtZW50KTtcbiAgICB0aGlzLmJhY2tncm91bmRFbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICB0aGlzLmRvbUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBDb21tb24uZXh0ZW5kKHRoaXMuZG9tRWxlbWVudC5zdHlsZSwge1xuICAgICAgcG9zaXRpb246ICdmaXhlZCcsXG4gICAgICBkaXNwbGF5OiAnbm9uZScsXG4gICAgICB6SW5kZXg6ICcxMDAxJyxcbiAgICAgIG9wYWNpdHk6IDAsXG4gICAgICBXZWJraXRUcmFuc2l0aW9uOiAnLXdlYmtpdC10cmFuc2Zvcm0gMC4ycyBlYXNlLW91dCwgb3BhY2l0eSAwLjJzIGxpbmVhcicsXG4gICAgICB0cmFuc2l0aW9uOiAndHJhbnNmb3JtIDAuMnMgZWFzZS1vdXQsIG9wYWNpdHkgMC4ycyBsaW5lYXInXG4gICAgfSk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmJhY2tncm91bmRFbGVtZW50KTtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZG9tRWxlbWVudCk7XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICBkb20uYmluZCh0aGlzLmJhY2tncm91bmRFbGVtZW50LCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5oaWRlKCk7XG4gICAgfSk7XG4gIH1cbiAgY3JlYXRlQ2xhc3MoQ2VudGVyZWREaXYsIFt7XG4gICAga2V5OiAnc2hvdycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNob3coKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSAnc2NhbGUoMS4xKSc7XG4gICAgICB0aGlzLmxheW91dCgpO1xuICAgICAgQ29tbW9uLmRlZmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMuYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICAgIF90aGlzLmRvbUVsZW1lbnQuc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICAgIF90aGlzLmRvbUVsZW1lbnQuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gJ3NjYWxlKDEpJztcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2hpZGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBoaWRlKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgIHZhciBoaWRlID0gZnVuY3Rpb24gaGlkZSgpIHtcbiAgICAgICAgX3RoaXMuZG9tRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBfdGhpcy5iYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBkb20udW5iaW5kKF90aGlzLmRvbUVsZW1lbnQsICd3ZWJraXRUcmFuc2l0aW9uRW5kJywgaGlkZSk7XG4gICAgICAgIGRvbS51bmJpbmQoX3RoaXMuZG9tRWxlbWVudCwgJ3RyYW5zaXRpb25lbmQnLCBoaWRlKTtcbiAgICAgICAgZG9tLnVuYmluZChfdGhpcy5kb21FbGVtZW50LCAnb1RyYW5zaXRpb25FbmQnLCBoaWRlKTtcbiAgICAgIH07XG4gICAgICBkb20uYmluZCh0aGlzLmRvbUVsZW1lbnQsICd3ZWJraXRUcmFuc2l0aW9uRW5kJywgaGlkZSk7XG4gICAgICBkb20uYmluZCh0aGlzLmRvbUVsZW1lbnQsICd0cmFuc2l0aW9uZW5kJywgaGlkZSk7XG4gICAgICBkb20uYmluZCh0aGlzLmRvbUVsZW1lbnQsICdvVHJhbnNpdGlvbkVuZCcsIGhpZGUpO1xuICAgICAgdGhpcy5iYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSAnc2NhbGUoMS4xKSc7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnbGF5b3V0JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbGF5b3V0KCkge1xuICAgICAgdGhpcy5kb21FbGVtZW50LnN0eWxlLmxlZnQgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIDIgLSBkb20uZ2V0V2lkdGgodGhpcy5kb21FbGVtZW50KSAvIDIgKyAncHgnO1xuICAgICAgdGhpcy5kb21FbGVtZW50LnN0eWxlLnRvcCA9IHdpbmRvdy5pbm5lckhlaWdodCAvIDIgLSBkb20uZ2V0SGVpZ2h0KHRoaXMuZG9tRWxlbWVudCkgLyAyICsgJ3B4JztcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIENlbnRlcmVkRGl2O1xufSgpO1xuXG52YXIgc3R5bGVTaGVldCA9IF9fXyRpbnNlcnRTdHlsZShcIi5kZyB1bHtsaXN0LXN0eWxlOm5vbmU7bWFyZ2luOjA7cGFkZGluZzowO3dpZHRoOjEwMCU7Y2xlYXI6Ym90aH0uZGcuYWN7cG9zaXRpb246Zml4ZWQ7dG9wOjA7bGVmdDowO3JpZ2h0OjA7aGVpZ2h0OjA7ei1pbmRleDowfS5kZzpub3QoLmFjKSAubWFpbntvdmVyZmxvdzpoaWRkZW59LmRnLm1haW57LXdlYmtpdC10cmFuc2l0aW9uOm9wYWNpdHkgLjFzIGxpbmVhcjstby10cmFuc2l0aW9uOm9wYWNpdHkgLjFzIGxpbmVhcjstbW96LXRyYW5zaXRpb246b3BhY2l0eSAuMXMgbGluZWFyO3RyYW5zaXRpb246b3BhY2l0eSAuMXMgbGluZWFyfS5kZy5tYWluLnRhbGxlci10aGFuLXdpbmRvd3tvdmVyZmxvdy15OmF1dG99LmRnLm1haW4udGFsbGVyLXRoYW4td2luZG93IC5jbG9zZS1idXR0b257b3BhY2l0eToxO21hcmdpbi10b3A6LTFweDtib3JkZXItdG9wOjFweCBzb2xpZCAjMmMyYzJjfS5kZy5tYWluIHVsLmNsb3NlZCAuY2xvc2UtYnV0dG9ue29wYWNpdHk6MSAhaW1wb3J0YW50fS5kZy5tYWluOmhvdmVyIC5jbG9zZS1idXR0b24sLmRnLm1haW4gLmNsb3NlLWJ1dHRvbi5kcmFne29wYWNpdHk6MX0uZGcubWFpbiAuY2xvc2UtYnV0dG9uey13ZWJraXQtdHJhbnNpdGlvbjpvcGFjaXR5IC4xcyBsaW5lYXI7LW8tdHJhbnNpdGlvbjpvcGFjaXR5IC4xcyBsaW5lYXI7LW1vei10cmFuc2l0aW9uOm9wYWNpdHkgLjFzIGxpbmVhcjt0cmFuc2l0aW9uOm9wYWNpdHkgLjFzIGxpbmVhcjtib3JkZXI6MDtsaW5lLWhlaWdodDoxOXB4O2hlaWdodDoyMHB4O2N1cnNvcjpwb2ludGVyO3RleHQtYWxpZ246Y2VudGVyO2JhY2tncm91bmQtY29sb3I6IzAwMH0uZGcubWFpbiAuY2xvc2UtYnV0dG9uLmNsb3NlLXRvcHtwb3NpdGlvbjpyZWxhdGl2ZX0uZGcubWFpbiAuY2xvc2UtYnV0dG9uLmNsb3NlLWJvdHRvbXtwb3NpdGlvbjphYnNvbHV0ZX0uZGcubWFpbiAuY2xvc2UtYnV0dG9uOmhvdmVye2JhY2tncm91bmQtY29sb3I6IzExMX0uZGcuYXtmbG9hdDpyaWdodDttYXJnaW4tcmlnaHQ6MTVweDtvdmVyZmxvdy15OnZpc2libGV9LmRnLmEuaGFzLXNhdmU+dWwuY2xvc2UtdG9we21hcmdpbi10b3A6MH0uZGcuYS5oYXMtc2F2ZT51bC5jbG9zZS1ib3R0b217bWFyZ2luLXRvcDoyN3B4fS5kZy5hLmhhcy1zYXZlPnVsLmNsb3NlZHttYXJnaW4tdG9wOjB9LmRnLmEgLnNhdmUtcm93e3RvcDowO3otaW5kZXg6MTAwMn0uZGcuYSAuc2F2ZS1yb3cuY2xvc2UtdG9we3Bvc2l0aW9uOnJlbGF0aXZlfS5kZy5hIC5zYXZlLXJvdy5jbG9zZS1ib3R0b217cG9zaXRpb246Zml4ZWR9LmRnIGxpey13ZWJraXQtdHJhbnNpdGlvbjpoZWlnaHQgLjFzIGVhc2Utb3V0Oy1vLXRyYW5zaXRpb246aGVpZ2h0IC4xcyBlYXNlLW91dDstbW96LXRyYW5zaXRpb246aGVpZ2h0IC4xcyBlYXNlLW91dDt0cmFuc2l0aW9uOmhlaWdodCAuMXMgZWFzZS1vdXQ7LXdlYmtpdC10cmFuc2l0aW9uOm92ZXJmbG93IC4xcyBsaW5lYXI7LW8tdHJhbnNpdGlvbjpvdmVyZmxvdyAuMXMgbGluZWFyOy1tb3otdHJhbnNpdGlvbjpvdmVyZmxvdyAuMXMgbGluZWFyO3RyYW5zaXRpb246b3ZlcmZsb3cgLjFzIGxpbmVhcn0uZGcgbGk6bm90KC5mb2xkZXIpe2N1cnNvcjphdXRvO2hlaWdodDoyN3B4O2xpbmUtaGVpZ2h0OjI3cHg7cGFkZGluZzowIDRweCAwIDVweH0uZGcgbGkuZm9sZGVye3BhZGRpbmc6MDtib3JkZXItbGVmdDo0cHggc29saWQgdHJhbnNwYXJlbnR9LmRnIGxpLnRpdGxle2N1cnNvcjpwb2ludGVyO21hcmdpbi1sZWZ0Oi00cHh9LmRnIC5jbG9zZWQgbGk6bm90KC50aXRsZSksLmRnIC5jbG9zZWQgdWwgbGksLmRnIC5jbG9zZWQgdWwgbGk+KntoZWlnaHQ6MDtvdmVyZmxvdzpoaWRkZW47Ym9yZGVyOjB9LmRnIC5jcntjbGVhcjpib3RoO3BhZGRpbmctbGVmdDozcHg7aGVpZ2h0OjI3cHg7b3ZlcmZsb3c6aGlkZGVufS5kZyAucHJvcGVydHktbmFtZXtjdXJzb3I6ZGVmYXVsdDtmbG9hdDpsZWZ0O2NsZWFyOmxlZnQ7d2lkdGg6NDAlO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzfS5kZyAuY3tmbG9hdDpsZWZ0O3dpZHRoOjYwJTtwb3NpdGlvbjpyZWxhdGl2ZX0uZGcgLmMgaW5wdXRbdHlwZT10ZXh0XXtib3JkZXI6MDttYXJnaW4tdG9wOjRweDtwYWRkaW5nOjNweDt3aWR0aDoxMDAlO2Zsb2F0OnJpZ2h0fS5kZyAuaGFzLXNsaWRlciBpbnB1dFt0eXBlPXRleHRde3dpZHRoOjMwJTttYXJnaW4tbGVmdDowfS5kZyAuc2xpZGVye2Zsb2F0OmxlZnQ7d2lkdGg6NjYlO21hcmdpbi1sZWZ0Oi01cHg7bWFyZ2luLXJpZ2h0OjA7aGVpZ2h0OjE5cHg7bWFyZ2luLXRvcDo0cHh9LmRnIC5zbGlkZXItZmd7aGVpZ2h0OjEwMCV9LmRnIC5jIGlucHV0W3R5cGU9Y2hlY2tib3hde21hcmdpbi10b3A6N3B4fS5kZyAuYyBzZWxlY3R7bWFyZ2luLXRvcDo1cHh9LmRnIC5jci5mdW5jdGlvbiwuZGcgLmNyLmZ1bmN0aW9uIC5wcm9wZXJ0eS1uYW1lLC5kZyAuY3IuZnVuY3Rpb24gKiwuZGcgLmNyLmJvb2xlYW4sLmRnIC5jci5ib29sZWFuICp7Y3Vyc29yOnBvaW50ZXJ9LmRnIC5jci5jb2xvcntvdmVyZmxvdzp2aXNpYmxlfS5kZyAuc2VsZWN0b3J7ZGlzcGxheTpub25lO3Bvc2l0aW9uOmFic29sdXRlO21hcmdpbi1sZWZ0Oi05cHg7bWFyZ2luLXRvcDoyM3B4O3otaW5kZXg6MTB9LmRnIC5jOmhvdmVyIC5zZWxlY3RvciwuZGcgLnNlbGVjdG9yLmRyYWd7ZGlzcGxheTpibG9ja30uZGcgbGkuc2F2ZS1yb3d7cGFkZGluZzowfS5kZyBsaS5zYXZlLXJvdyAuYnV0dG9ue2Rpc3BsYXk6aW5saW5lLWJsb2NrO3BhZGRpbmc6MHB4IDZweH0uZGcuZGlhbG9ndWV7YmFja2dyb3VuZC1jb2xvcjojMjIyO3dpZHRoOjQ2MHB4O3BhZGRpbmc6MTVweDtmb250LXNpemU6MTNweDtsaW5lLWhlaWdodDoxNXB4fSNkZy1uZXctY29uc3RydWN0b3J7cGFkZGluZzoxMHB4O2NvbG9yOiMyMjI7Zm9udC1mYW1pbHk6TW9uYWNvLCBtb25vc3BhY2U7Zm9udC1zaXplOjEwcHg7Ym9yZGVyOjA7cmVzaXplOm5vbmU7Ym94LXNoYWRvdzppbnNldCAxcHggMXB4IDFweCAjODg4O3dvcmQtd3JhcDpicmVhay13b3JkO21hcmdpbjoxMnB4IDA7ZGlzcGxheTpibG9jazt3aWR0aDo0NDBweDtvdmVyZmxvdy15OnNjcm9sbDtoZWlnaHQ6MTAwcHg7cG9zaXRpb246cmVsYXRpdmV9I2RnLWxvY2FsLWV4cGxhaW57ZGlzcGxheTpub25lO2ZvbnQtc2l6ZToxMXB4O2xpbmUtaGVpZ2h0OjE3cHg7Ym9yZGVyLXJhZGl1czozcHg7YmFja2dyb3VuZC1jb2xvcjojMzMzO3BhZGRpbmc6OHB4O21hcmdpbi10b3A6MTBweH0jZGctbG9jYWwtZXhwbGFpbiBjb2Rle2ZvbnQtc2l6ZToxMHB4fSNkYXQtZ3VpLXNhdmUtbG9jYWxseXtkaXNwbGF5Om5vbmV9LmRne2NvbG9yOiNlZWU7Zm9udDoxMXB4ICdMdWNpZGEgR3JhbmRlJywgc2Fucy1zZXJpZjt0ZXh0LXNoYWRvdzowIC0xcHggMCAjMTExfS5kZy5tYWluOjotd2Via2l0LXNjcm9sbGJhcnt3aWR0aDo1cHg7YmFja2dyb3VuZDojMWExYTFhfS5kZy5tYWluOjotd2Via2l0LXNjcm9sbGJhci1jb3JuZXJ7aGVpZ2h0OjA7ZGlzcGxheTpub25lfS5kZy5tYWluOjotd2Via2l0LXNjcm9sbGJhci10aHVtYntib3JkZXItcmFkaXVzOjVweDtiYWNrZ3JvdW5kOiM2NzY3Njd9LmRnIGxpOm5vdCguZm9sZGVyKXtiYWNrZ3JvdW5kOiMxYTFhMWE7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgIzJjMmMyY30uZGcgbGkuc2F2ZS1yb3d7bGluZS1oZWlnaHQ6MjVweDtiYWNrZ3JvdW5kOiNkYWQ1Y2I7Ym9yZGVyOjB9LmRnIGxpLnNhdmUtcm93IHNlbGVjdHttYXJnaW4tbGVmdDo1cHg7d2lkdGg6MTA4cHh9LmRnIGxpLnNhdmUtcm93IC5idXR0b257bWFyZ2luLWxlZnQ6NXB4O21hcmdpbi10b3A6MXB4O2JvcmRlci1yYWRpdXM6MnB4O2ZvbnQtc2l6ZTo5cHg7bGluZS1oZWlnaHQ6N3B4O3BhZGRpbmc6NHB4IDRweCA1cHggNHB4O2JhY2tncm91bmQ6I2M1YmRhZDtjb2xvcjojZmZmO3RleHQtc2hhZG93OjAgMXB4IDAgI2IwYTU4Zjtib3gtc2hhZG93OjAgLTFweCAwICNiMGE1OGY7Y3Vyc29yOnBvaW50ZXJ9LmRnIGxpLnNhdmUtcm93IC5idXR0b24uZ2VhcnN7YmFja2dyb3VuZDojYzViZGFkIHVybChkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFzQUFBQU5DQVlBQUFCLzlaUTdBQUFBR1hSRldIUlRiMlowZDJGeVpRQkJaRzlpWlNCSmJXRm5aVkpsWVdSNWNjbGxQQUFBQVFKSlJFRlVlTnBpWUtBVS9QLy9Qd0dJQy9BcENBQmlCU0FXK0k4QUNsQWNnS3hRNFQ5aG9NQUVVcnh4MlFTR042K2VnRFgrL3ZXVDRlN044MkFNWW9QQXgvZXZ3V29Zb1NZYkFDWDJzN0t4Q3h6Y3NlekRoM2V2Rm9ERUJZVEVFcXljZ2dXQXpBOUF1VVNRUWdlWVBhOWZQdjYvWVdtL0FjeDVJUGI3dHkvZncrUVpibHc2N3ZEczhSMFlIeVFoZ09ieCt5QUprQnFtRzVkUFBEaDFhUE9HUi9ldWdXMEc0dmxJb1RJZnlGY0ErUWVraGhISmhQZFF4YmlBSWd1TUJUUVpyUEQ3MTA4TTZyb1dZREZRaUlBQXY2QW93LzFiRndYZ2lzK2YyTFVBeW53b0lhTmN6OFhOeDNEbDdNRUpVREdRcHg5Z3RROFlDdWVCK0QyNk9FQ0FBUURhZHQ3ZTQ2RDQyUUFBQUFCSlJVNUVya0pnZ2c9PSkgMnB4IDFweCBuby1yZXBlYXQ7aGVpZ2h0OjdweDt3aWR0aDo4cHh9LmRnIGxpLnNhdmUtcm93IC5idXR0b246aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjojYmFiMTllO2JveC1zaGFkb3c6MCAtMXB4IDAgI2IwYTU4Zn0uZGcgbGkuZm9sZGVye2JvcmRlci1ib3R0b206MH0uZGcgbGkudGl0bGV7cGFkZGluZy1sZWZ0OjE2cHg7YmFja2dyb3VuZDojMDAwIHVybChkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhCUUFGQUpFQUFQLy8vL1B6OC8vLy8vLy8veUg1QkFFQUFBSUFMQUFBQUFBRkFBVUFBQUlJbEkraEtnRnhvQ2dBT3c9PSkgNnB4IDEwcHggbm8tcmVwZWF0O2N1cnNvcjpwb2ludGVyO2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4yKX0uZGcgLmNsb3NlZCBsaS50aXRsZXtiYWNrZ3JvdW5kLWltYWdlOnVybChkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhCUUFGQUpFQUFQLy8vL1B6OC8vLy8vLy8veUg1QkFFQUFBSUFMQUFBQUFBRkFBVUFBQUlJbEdJV3FNQ2JXQUVBT3c9PSl9LmRnIC5jci5ib29sZWFue2JvcmRlci1sZWZ0OjNweCBzb2xpZCAjODA2Nzg3fS5kZyAuY3IuY29sb3J7Ym9yZGVyLWxlZnQ6M3B4IHNvbGlkfS5kZyAuY3IuZnVuY3Rpb257Ym9yZGVyLWxlZnQ6M3B4IHNvbGlkICNlNjFkNWZ9LmRnIC5jci5udW1iZXJ7Ym9yZGVyLWxlZnQ6M3B4IHNvbGlkICMyRkExRDZ9LmRnIC5jci5udW1iZXIgaW5wdXRbdHlwZT10ZXh0XXtjb2xvcjojMkZBMUQ2fS5kZyAuY3Iuc3RyaW5ne2JvcmRlci1sZWZ0OjNweCBzb2xpZCAjMWVkMzZmfS5kZyAuY3Iuc3RyaW5nIGlucHV0W3R5cGU9dGV4dF17Y29sb3I6IzFlZDM2Zn0uZGcgLmNyLmZ1bmN0aW9uOmhvdmVyLC5kZyAuY3IuYm9vbGVhbjpob3ZlcntiYWNrZ3JvdW5kOiMxMTF9LmRnIC5jIGlucHV0W3R5cGU9dGV4dF17YmFja2dyb3VuZDojMzAzMDMwO291dGxpbmU6bm9uZX0uZGcgLmMgaW5wdXRbdHlwZT10ZXh0XTpob3ZlcntiYWNrZ3JvdW5kOiMzYzNjM2N9LmRnIC5jIGlucHV0W3R5cGU9dGV4dF06Zm9jdXN7YmFja2dyb3VuZDojNDk0OTQ5O2NvbG9yOiNmZmZ9LmRnIC5jIC5zbGlkZXJ7YmFja2dyb3VuZDojMzAzMDMwO2N1cnNvcjpldy1yZXNpemV9LmRnIC5jIC5zbGlkZXItZmd7YmFja2dyb3VuZDojMkZBMUQ2O21heC13aWR0aDoxMDAlfS5kZyAuYyAuc2xpZGVyOmhvdmVye2JhY2tncm91bmQ6IzNjM2MzY30uZGcgLmMgLnNsaWRlcjpob3ZlciAuc2xpZGVyLWZne2JhY2tncm91bmQ6IzQ0YWJkYX1cXG5cIik7XG5cbmNzcy5pbmplY3Qoc3R5bGVTaGVldCk7XG52YXIgQ1NTX05BTUVTUEFDRSA9ICdkZyc7XG52YXIgSElERV9LRVlfQ09ERSA9IDcyO1xudmFyIENMT1NFX0JVVFRPTl9IRUlHSFQgPSAyMDtcbnZhciBERUZBVUxUX0RFRkFVTFRfUFJFU0VUX05BTUUgPSAnRGVmYXVsdCc7XG52YXIgU1VQUE9SVFNfTE9DQUxfU1RPUkFHRSA9IGZ1bmN0aW9uICgpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gJ2xvY2FsU3RvcmFnZScgaW4gd2luZG93ICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UgIT09IG51bGw7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn0oKTtcbnZhciBTQVZFX0RJQUxPR1VFID0gdm9pZCAwO1xudmFyIGF1dG9QbGFjZVZpcmdpbiA9IHRydWU7XG52YXIgYXV0b1BsYWNlQ29udGFpbmVyID0gdm9pZCAwO1xudmFyIGhpZGUgPSBmYWxzZTtcbnZhciBoaWRlYWJsZUd1aXMgPSBbXTtcbnZhciBHVUkgPSBmdW5jdGlvbiBHVUkocGFycykge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuICB2YXIgcGFyYW1zID0gcGFycyB8fCB7fTtcbiAgdGhpcy5kb21FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHRoaXMuX191bCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gIHRoaXMuZG9tRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLl9fdWwpO1xuICBkb20uYWRkQ2xhc3ModGhpcy5kb21FbGVtZW50LCBDU1NfTkFNRVNQQUNFKTtcbiAgdGhpcy5fX2ZvbGRlcnMgPSB7fTtcbiAgdGhpcy5fX2NvbnRyb2xsZXJzID0gW107XG4gIHRoaXMuX19yZW1lbWJlcmVkT2JqZWN0cyA9IFtdO1xuICB0aGlzLl9fcmVtZW1iZXJlZE9iamVjdEluZGVjZXNUb0NvbnRyb2xsZXJzID0gW107XG4gIHRoaXMuX19saXN0ZW5pbmcgPSBbXTtcbiAgcGFyYW1zID0gQ29tbW9uLmRlZmF1bHRzKHBhcmFtcywge1xuICAgIGNsb3NlT25Ub3A6IGZhbHNlLFxuICAgIGF1dG9QbGFjZTogdHJ1ZSxcbiAgICB3aWR0aDogR1VJLkRFRkFVTFRfV0lEVEhcbiAgfSk7XG4gIHBhcmFtcyA9IENvbW1vbi5kZWZhdWx0cyhwYXJhbXMsIHtcbiAgICByZXNpemFibGU6IHBhcmFtcy5hdXRvUGxhY2UsXG4gICAgaGlkZWFibGU6IHBhcmFtcy5hdXRvUGxhY2VcbiAgfSk7XG4gIGlmICghQ29tbW9uLmlzVW5kZWZpbmVkKHBhcmFtcy5sb2FkKSkge1xuICAgIGlmIChwYXJhbXMucHJlc2V0KSB7XG4gICAgICBwYXJhbXMubG9hZC5wcmVzZXQgPSBwYXJhbXMucHJlc2V0O1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBwYXJhbXMubG9hZCA9IHsgcHJlc2V0OiBERUZBVUxUX0RFRkFVTFRfUFJFU0VUX05BTUUgfTtcbiAgfVxuICBpZiAoQ29tbW9uLmlzVW5kZWZpbmVkKHBhcmFtcy5wYXJlbnQpICYmIHBhcmFtcy5oaWRlYWJsZSkge1xuICAgIGhpZGVhYmxlR3Vpcy5wdXNoKHRoaXMpO1xuICB9XG4gIHBhcmFtcy5yZXNpemFibGUgPSBDb21tb24uaXNVbmRlZmluZWQocGFyYW1zLnBhcmVudCkgJiYgcGFyYW1zLnJlc2l6YWJsZTtcbiAgaWYgKHBhcmFtcy5hdXRvUGxhY2UgJiYgQ29tbW9uLmlzVW5kZWZpbmVkKHBhcmFtcy5zY3JvbGxhYmxlKSkge1xuICAgIHBhcmFtcy5zY3JvbGxhYmxlID0gdHJ1ZTtcbiAgfVxuICB2YXIgdXNlTG9jYWxTdG9yYWdlID0gU1VQUE9SVFNfTE9DQUxfU1RPUkFHRSAmJiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShnZXRMb2NhbFN0b3JhZ2VIYXNoKHRoaXMsICdpc0xvY2FsJykpID09PSAndHJ1ZSc7XG4gIHZhciBzYXZlVG9Mb2NhbFN0b3JhZ2UgPSB2b2lkIDA7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsXG4gIHtcbiAgICBwYXJlbnQ6IHtcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgICByZXR1cm4gcGFyYW1zLnBhcmVudDtcbiAgICAgIH1cbiAgICB9LFxuICAgIHNjcm9sbGFibGU6IHtcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgICByZXR1cm4gcGFyYW1zLnNjcm9sbGFibGU7XG4gICAgICB9XG4gICAgfSxcbiAgICBhdXRvUGxhY2U6IHtcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgICByZXR1cm4gcGFyYW1zLmF1dG9QbGFjZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNsb3NlT25Ub3A6IHtcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgICByZXR1cm4gcGFyYW1zLmNsb3NlT25Ub3A7XG4gICAgICB9XG4gICAgfSxcbiAgICBwcmVzZXQ6IHtcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgICBpZiAoX3RoaXMucGFyZW50KSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzLmdldFJvb3QoKS5wcmVzZXQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtcy5sb2FkLnByZXNldDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uIHNldCQkMSh2KSB7XG4gICAgICAgIGlmIChfdGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICBfdGhpcy5nZXRSb290KCkucHJlc2V0ID0gdjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwYXJhbXMubG9hZC5wcmVzZXQgPSB2O1xuICAgICAgICB9XG4gICAgICAgIHNldFByZXNldFNlbGVjdEluZGV4KHRoaXMpO1xuICAgICAgICBfdGhpcy5yZXZlcnQoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHdpZHRoOiB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgICAgcmV0dXJuIHBhcmFtcy53aWR0aDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uIHNldCQkMSh2KSB7XG4gICAgICAgIHBhcmFtcy53aWR0aCA9IHY7XG4gICAgICAgIHNldFdpZHRoKF90aGlzLCB2KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIG5hbWU6IHtcbiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgICByZXR1cm4gcGFyYW1zLm5hbWU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEodikge1xuICAgICAgICBwYXJhbXMubmFtZSA9IHY7XG4gICAgICAgIGlmICh0aXRsZVJvd05hbWUpIHtcbiAgICAgICAgICB0aXRsZVJvd05hbWUuaW5uZXJIVE1MID0gcGFyYW1zLm5hbWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGNsb3NlZDoge1xuICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICAgIHJldHVybiBwYXJhbXMuY2xvc2VkO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gc2V0JCQxKHYpIHtcbiAgICAgICAgcGFyYW1zLmNsb3NlZCA9IHY7XG4gICAgICAgIGlmIChwYXJhbXMuY2xvc2VkKSB7XG4gICAgICAgICAgZG9tLmFkZENsYXNzKF90aGlzLl9fdWwsIEdVSS5DTEFTU19DTE9TRUQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRvbS5yZW1vdmVDbGFzcyhfdGhpcy5fX3VsLCBHVUkuQ0xBU1NfQ0xPU0VEKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uUmVzaXplKCk7XG4gICAgICAgIGlmIChfdGhpcy5fX2Nsb3NlQnV0dG9uKSB7XG4gICAgICAgICAgX3RoaXMuX19jbG9zZUJ1dHRvbi5pbm5lckhUTUwgPSB2ID8gR1VJLlRFWFRfT1BFTiA6IEdVSS5URVhUX0NMT1NFRDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgbG9hZDoge1xuICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICAgIHJldHVybiBwYXJhbXMubG9hZDtcbiAgICAgIH1cbiAgICB9LFxuICAgIHVzZUxvY2FsU3RvcmFnZToge1xuICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICAgIHJldHVybiB1c2VMb2NhbFN0b3JhZ2U7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEoYm9vbCkge1xuICAgICAgICBpZiAoU1VQUE9SVFNfTE9DQUxfU1RPUkFHRSkge1xuICAgICAgICAgIHVzZUxvY2FsU3RvcmFnZSA9IGJvb2w7XG4gICAgICAgICAgaWYgKGJvb2wpIHtcbiAgICAgICAgICAgIGRvbS5iaW5kKHdpbmRvdywgJ3VubG9hZCcsIHNhdmVUb0xvY2FsU3RvcmFnZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvbS51bmJpbmQod2luZG93LCAndW5sb2FkJywgc2F2ZVRvTG9jYWxTdG9yYWdlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oZ2V0TG9jYWxTdG9yYWdlSGFzaChfdGhpcywgJ2lzTG9jYWwnKSwgYm9vbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBpZiAoQ29tbW9uLmlzVW5kZWZpbmVkKHBhcmFtcy5wYXJlbnQpKSB7XG4gICAgcGFyYW1zLmNsb3NlZCA9IGZhbHNlO1xuICAgIGRvbS5hZGRDbGFzcyh0aGlzLmRvbUVsZW1lbnQsIEdVSS5DTEFTU19NQUlOKTtcbiAgICBkb20ubWFrZVNlbGVjdGFibGUodGhpcy5kb21FbGVtZW50LCBmYWxzZSk7XG4gICAgaWYgKFNVUFBPUlRTX0xPQ0FMX1NUT1JBR0UpIHtcbiAgICAgIGlmICh1c2VMb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgX3RoaXMudXNlTG9jYWxTdG9yYWdlID0gdHJ1ZTtcbiAgICAgICAgdmFyIHNhdmVkR3VpID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oZ2V0TG9jYWxTdG9yYWdlSGFzaCh0aGlzLCAnZ3VpJykpO1xuICAgICAgICBpZiAoc2F2ZWRHdWkpIHtcbiAgICAgICAgICBwYXJhbXMubG9hZCA9IEpTT04ucGFyc2Uoc2F2ZWRHdWkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX19jbG9zZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMuX19jbG9zZUJ1dHRvbi5pbm5lckhUTUwgPSBHVUkuVEVYVF9DTE9TRUQ7XG4gICAgZG9tLmFkZENsYXNzKHRoaXMuX19jbG9zZUJ1dHRvbiwgR1VJLkNMQVNTX0NMT1NFX0JVVFRPTik7XG4gICAgaWYgKHBhcmFtcy5jbG9zZU9uVG9wKSB7XG4gICAgICBkb20uYWRkQ2xhc3ModGhpcy5fX2Nsb3NlQnV0dG9uLCBHVUkuQ0xBU1NfQ0xPU0VfVE9QKTtcbiAgICAgIHRoaXMuZG9tRWxlbWVudC5pbnNlcnRCZWZvcmUodGhpcy5fX2Nsb3NlQnV0dG9uLCB0aGlzLmRvbUVsZW1lbnQuY2hpbGROb2Rlc1swXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRvbS5hZGRDbGFzcyh0aGlzLl9fY2xvc2VCdXR0b24sIEdVSS5DTEFTU19DTE9TRV9CT1RUT00pO1xuICAgICAgdGhpcy5kb21FbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuX19jbG9zZUJ1dHRvbik7XG4gICAgfVxuICAgIGRvbS5iaW5kKHRoaXMuX19jbG9zZUJ1dHRvbiwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuY2xvc2VkID0gIV90aGlzLmNsb3NlZDtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBpZiAocGFyYW1zLmNsb3NlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBwYXJhbXMuY2xvc2VkID0gdHJ1ZTtcbiAgICB9XG4gICAgdmFyIF90aXRsZVJvd05hbWUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShwYXJhbXMubmFtZSk7XG4gICAgZG9tLmFkZENsYXNzKF90aXRsZVJvd05hbWUsICdjb250cm9sbGVyLW5hbWUnKTtcbiAgICB2YXIgdGl0bGVSb3cgPSBhZGRSb3coX3RoaXMsIF90aXRsZVJvd05hbWUpO1xuICAgIHZhciBvbkNsaWNrVGl0bGUgPSBmdW5jdGlvbiBvbkNsaWNrVGl0bGUoZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgX3RoaXMuY2xvc2VkID0gIV90aGlzLmNsb3NlZDtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIGRvbS5hZGRDbGFzcyh0aGlzLl9fdWwsIEdVSS5DTEFTU19DTE9TRUQpO1xuICAgIGRvbS5hZGRDbGFzcyh0aXRsZVJvdywgJ3RpdGxlJyk7XG4gICAgZG9tLmJpbmQodGl0bGVSb3csICdjbGljaycsIG9uQ2xpY2tUaXRsZSk7XG4gICAgaWYgKCFwYXJhbXMuY2xvc2VkKSB7XG4gICAgICB0aGlzLmNsb3NlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICBpZiAocGFyYW1zLmF1dG9QbGFjZSkge1xuICAgIGlmIChDb21tb24uaXNVbmRlZmluZWQocGFyYW1zLnBhcmVudCkpIHtcbiAgICAgIGlmIChhdXRvUGxhY2VWaXJnaW4pIHtcbiAgICAgICAgYXV0b1BsYWNlQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRvbS5hZGRDbGFzcyhhdXRvUGxhY2VDb250YWluZXIsIENTU19OQU1FU1BBQ0UpO1xuICAgICAgICBkb20uYWRkQ2xhc3MoYXV0b1BsYWNlQ29udGFpbmVyLCBHVUkuQ0xBU1NfQVVUT19QTEFDRV9DT05UQUlORVIpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGF1dG9QbGFjZUNvbnRhaW5lcik7XG4gICAgICAgIGF1dG9QbGFjZVZpcmdpbiA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgYXV0b1BsYWNlQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZG9tRWxlbWVudCk7XG4gICAgICBkb20uYWRkQ2xhc3ModGhpcy5kb21FbGVtZW50LCBHVUkuQ0xBU1NfQVVUT19QTEFDRSk7XG4gICAgfVxuICAgIGlmICghdGhpcy5wYXJlbnQpIHtcbiAgICAgIHNldFdpZHRoKF90aGlzLCBwYXJhbXMud2lkdGgpO1xuICAgIH1cbiAgfVxuICB0aGlzLl9fcmVzaXplSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBfdGhpcy5vblJlc2l6ZURlYm91bmNlZCgpO1xuICB9O1xuICBkb20uYmluZCh3aW5kb3csICdyZXNpemUnLCB0aGlzLl9fcmVzaXplSGFuZGxlcik7XG4gIGRvbS5iaW5kKHRoaXMuX191bCwgJ3dlYmtpdFRyYW5zaXRpb25FbmQnLCB0aGlzLl9fcmVzaXplSGFuZGxlcik7XG4gIGRvbS5iaW5kKHRoaXMuX191bCwgJ3RyYW5zaXRpb25lbmQnLCB0aGlzLl9fcmVzaXplSGFuZGxlcik7XG4gIGRvbS5iaW5kKHRoaXMuX191bCwgJ29UcmFuc2l0aW9uRW5kJywgdGhpcy5fX3Jlc2l6ZUhhbmRsZXIpO1xuICB0aGlzLm9uUmVzaXplKCk7XG4gIGlmIChwYXJhbXMucmVzaXphYmxlKSB7XG4gICAgYWRkUmVzaXplSGFuZGxlKHRoaXMpO1xuICB9XG4gIHNhdmVUb0xvY2FsU3RvcmFnZSA9IGZ1bmN0aW9uIHNhdmVUb0xvY2FsU3RvcmFnZSgpIHtcbiAgICBpZiAoU1VQUE9SVFNfTE9DQUxfU1RPUkFHRSAmJiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShnZXRMb2NhbFN0b3JhZ2VIYXNoKF90aGlzLCAnaXNMb2NhbCcpKSA9PT0gJ3RydWUnKSB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShnZXRMb2NhbFN0b3JhZ2VIYXNoKF90aGlzLCAnZ3VpJyksIEpTT04uc3RyaW5naWZ5KF90aGlzLmdldFNhdmVPYmplY3QoKSkpO1xuICAgIH1cbiAgfTtcbiAgdGhpcy5zYXZlVG9Mb2NhbFN0b3JhZ2VJZlBvc3NpYmxlID0gc2F2ZVRvTG9jYWxTdG9yYWdlO1xuICBmdW5jdGlvbiByZXNldFdpZHRoKCkge1xuICAgIHZhciByb290ID0gX3RoaXMuZ2V0Um9vdCgpO1xuICAgIHJvb3Qud2lkdGggKz0gMTtcbiAgICBDb21tb24uZGVmZXIoZnVuY3Rpb24gKCkge1xuICAgICAgcm9vdC53aWR0aCAtPSAxO1xuICAgIH0pO1xuICB9XG4gIGlmICghcGFyYW1zLnBhcmVudCkge1xuICAgIHJlc2V0V2lkdGgoKTtcbiAgfVxufTtcbkdVSS50b2dnbGVIaWRlID0gZnVuY3Rpb24gKCkge1xuICBoaWRlID0gIWhpZGU7XG4gIENvbW1vbi5lYWNoKGhpZGVhYmxlR3VpcywgZnVuY3Rpb24gKGd1aSkge1xuICAgIGd1aS5kb21FbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBoaWRlID8gJ25vbmUnIDogJyc7XG4gIH0pO1xufTtcbkdVSS5DTEFTU19BVVRPX1BMQUNFID0gJ2EnO1xuR1VJLkNMQVNTX0FVVE9fUExBQ0VfQ09OVEFJTkVSID0gJ2FjJztcbkdVSS5DTEFTU19NQUlOID0gJ21haW4nO1xuR1VJLkNMQVNTX0NPTlRST0xMRVJfUk9XID0gJ2NyJztcbkdVSS5DTEFTU19UT09fVEFMTCA9ICd0YWxsZXItdGhhbi13aW5kb3cnO1xuR1VJLkNMQVNTX0NMT1NFRCA9ICdjbG9zZWQnO1xuR1VJLkNMQVNTX0NMT1NFX0JVVFRPTiA9ICdjbG9zZS1idXR0b24nO1xuR1VJLkNMQVNTX0NMT1NFX1RPUCA9ICdjbG9zZS10b3AnO1xuR1VJLkNMQVNTX0NMT1NFX0JPVFRPTSA9ICdjbG9zZS1ib3R0b20nO1xuR1VJLkNMQVNTX0RSQUcgPSAnZHJhZyc7XG5HVUkuREVGQVVMVF9XSURUSCA9IDI0NTtcbkdVSS5URVhUX0NMT1NFRCA9ICdDbG9zZSBDb250cm9scyc7XG5HVUkuVEVYVF9PUEVOID0gJ09wZW4gQ29udHJvbHMnO1xuR1VJLl9rZXlkb3duSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50LnR5cGUgIT09ICd0ZXh0JyAmJiAoZS53aGljaCA9PT0gSElERV9LRVlfQ09ERSB8fCBlLmtleUNvZGUgPT09IEhJREVfS0VZX0NPREUpKSB7XG4gICAgR1VJLnRvZ2dsZUhpZGUoKTtcbiAgfVxufTtcbmRvbS5iaW5kKHdpbmRvdywgJ2tleWRvd24nLCBHVUkuX2tleWRvd25IYW5kbGVyLCBmYWxzZSk7XG5Db21tb24uZXh0ZW5kKEdVSS5wcm90b3R5cGUsXG57XG4gIGFkZDogZnVuY3Rpb24gYWRkKG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICByZXR1cm4gX2FkZCh0aGlzLCBvYmplY3QsIHByb3BlcnR5LCB7XG4gICAgICBmYWN0b3J5QXJnczogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKVxuICAgIH0pO1xuICB9LFxuICBhZGRDb2xvcjogZnVuY3Rpb24gYWRkQ29sb3Iob2JqZWN0LCBwcm9wZXJ0eSkge1xuICAgIHJldHVybiBfYWRkKHRoaXMsIG9iamVjdCwgcHJvcGVydHksIHtcbiAgICAgIGNvbG9yOiB0cnVlXG4gICAgfSk7XG4gIH0sXG4gIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKGNvbnRyb2xsZXIpIHtcbiAgICB0aGlzLl9fdWwucmVtb3ZlQ2hpbGQoY29udHJvbGxlci5fX2xpKTtcbiAgICB0aGlzLl9fY29udHJvbGxlcnMuc3BsaWNlKHRoaXMuX19jb250cm9sbGVycy5pbmRleE9mKGNvbnRyb2xsZXIpLCAxKTtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIENvbW1vbi5kZWZlcihmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5vblJlc2l6ZSgpO1xuICAgIH0pO1xuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdPbmx5IHRoZSByb290IEdVSSBzaG91bGQgYmUgcmVtb3ZlZCB3aXRoIC5kZXN0cm95KCkuICcgKyAnRm9yIHN1YmZvbGRlcnMsIHVzZSBndWkucmVtb3ZlRm9sZGVyKGZvbGRlcikgaW5zdGVhZC4nKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuYXV0b1BsYWNlKSB7XG4gICAgICBhdXRvUGxhY2VDb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5kb21FbGVtZW50KTtcbiAgICB9XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICBDb21tb24uZWFjaCh0aGlzLl9fZm9sZGVycywgZnVuY3Rpb24gKHN1YmZvbGRlcikge1xuICAgICAgX3RoaXMucmVtb3ZlRm9sZGVyKHN1YmZvbGRlcik7XG4gICAgfSk7XG4gICAgZG9tLnVuYmluZCh3aW5kb3csICdrZXlkb3duJywgR1VJLl9rZXlkb3duSGFuZGxlciwgZmFsc2UpO1xuICAgIHJlbW92ZUxpc3RlbmVycyh0aGlzKTtcbiAgfSxcbiAgYWRkRm9sZGVyOiBmdW5jdGlvbiBhZGRGb2xkZXIobmFtZSkge1xuICAgIGlmICh0aGlzLl9fZm9sZGVyc1tuYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBhbHJlYWR5IGhhdmUgYSBmb2xkZXIgaW4gdGhpcyBHVUkgYnkgdGhlJyArICcgbmFtZSBcIicgKyBuYW1lICsgJ1wiJyk7XG4gICAgfVxuICAgIHZhciBuZXdHdWlQYXJhbXMgPSB7IG5hbWU6IG5hbWUsIHBhcmVudDogdGhpcyB9O1xuICAgIG5ld0d1aVBhcmFtcy5hdXRvUGxhY2UgPSB0aGlzLmF1dG9QbGFjZTtcbiAgICBpZiAodGhpcy5sb2FkICYmXG4gICAgdGhpcy5sb2FkLmZvbGRlcnMgJiZcbiAgICB0aGlzLmxvYWQuZm9sZGVyc1tuYW1lXSkge1xuICAgICAgbmV3R3VpUGFyYW1zLmNsb3NlZCA9IHRoaXMubG9hZC5mb2xkZXJzW25hbWVdLmNsb3NlZDtcbiAgICAgIG5ld0d1aVBhcmFtcy5sb2FkID0gdGhpcy5sb2FkLmZvbGRlcnNbbmFtZV07XG4gICAgfVxuICAgIHZhciBndWkgPSBuZXcgR1VJKG5ld0d1aVBhcmFtcyk7XG4gICAgdGhpcy5fX2ZvbGRlcnNbbmFtZV0gPSBndWk7XG4gICAgdmFyIGxpID0gYWRkUm93KHRoaXMsIGd1aS5kb21FbGVtZW50KTtcbiAgICBkb20uYWRkQ2xhc3MobGksICdmb2xkZXInKTtcbiAgICByZXR1cm4gZ3VpO1xuICB9LFxuICByZW1vdmVGb2xkZXI6IGZ1bmN0aW9uIHJlbW92ZUZvbGRlcihmb2xkZXIpIHtcbiAgICB0aGlzLl9fdWwucmVtb3ZlQ2hpbGQoZm9sZGVyLmRvbUVsZW1lbnQucGFyZW50RWxlbWVudCk7XG4gICAgZGVsZXRlIHRoaXMuX19mb2xkZXJzW2ZvbGRlci5uYW1lXTtcbiAgICBpZiAodGhpcy5sb2FkICYmXG4gICAgdGhpcy5sb2FkLmZvbGRlcnMgJiZcbiAgICB0aGlzLmxvYWQuZm9sZGVyc1tmb2xkZXIubmFtZV0pIHtcbiAgICAgIGRlbGV0ZSB0aGlzLmxvYWQuZm9sZGVyc1tmb2xkZXIubmFtZV07XG4gICAgfVxuICAgIHJlbW92ZUxpc3RlbmVycyhmb2xkZXIpO1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgQ29tbW9uLmVhY2goZm9sZGVyLl9fZm9sZGVycywgZnVuY3Rpb24gKHN1YmZvbGRlcikge1xuICAgICAgZm9sZGVyLnJlbW92ZUZvbGRlcihzdWJmb2xkZXIpO1xuICAgIH0pO1xuICAgIENvbW1vbi5kZWZlcihmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5vblJlc2l6ZSgpO1xuICAgIH0pO1xuICB9LFxuICBvcGVuOiBmdW5jdGlvbiBvcGVuKCkge1xuICAgIHRoaXMuY2xvc2VkID0gZmFsc2U7XG4gIH0sXG4gIGNsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICB0aGlzLmNsb3NlZCA9IHRydWU7XG4gIH0sXG4gIG9uUmVzaXplOiBmdW5jdGlvbiBvblJlc2l6ZSgpIHtcbiAgICB2YXIgcm9vdCA9IHRoaXMuZ2V0Um9vdCgpO1xuICAgIGlmIChyb290LnNjcm9sbGFibGUpIHtcbiAgICAgIHZhciB0b3AgPSBkb20uZ2V0T2Zmc2V0KHJvb3QuX191bCkudG9wO1xuICAgICAgdmFyIGggPSAwO1xuICAgICAgQ29tbW9uLmVhY2gocm9vdC5fX3VsLmNoaWxkTm9kZXMsIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIGlmICghKHJvb3QuYXV0b1BsYWNlICYmIG5vZGUgPT09IHJvb3QuX19zYXZlX3JvdykpIHtcbiAgICAgICAgICBoICs9IGRvbS5nZXRIZWlnaHQobm9kZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKHdpbmRvdy5pbm5lckhlaWdodCAtIHRvcCAtIENMT1NFX0JVVFRPTl9IRUlHSFQgPCBoKSB7XG4gICAgICAgIGRvbS5hZGRDbGFzcyhyb290LmRvbUVsZW1lbnQsIEdVSS5DTEFTU19UT09fVEFMTCk7XG4gICAgICAgIHJvb3QuX191bC5zdHlsZS5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSB0b3AgLSBDTE9TRV9CVVRUT05fSEVJR0hUICsgJ3B4JztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRvbS5yZW1vdmVDbGFzcyhyb290LmRvbUVsZW1lbnQsIEdVSS5DTEFTU19UT09fVEFMTCk7XG4gICAgICAgIHJvb3QuX191bC5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChyb290Ll9fcmVzaXplX2hhbmRsZSkge1xuICAgICAgQ29tbW9uLmRlZmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcm9vdC5fX3Jlc2l6ZV9oYW5kbGUuc3R5bGUuaGVpZ2h0ID0gcm9vdC5fX3VsLm9mZnNldEhlaWdodCArICdweCc7XG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHJvb3QuX19jbG9zZUJ1dHRvbikge1xuICAgICAgcm9vdC5fX2Nsb3NlQnV0dG9uLnN0eWxlLndpZHRoID0gcm9vdC53aWR0aCArICdweCc7XG4gICAgfVxuICB9LFxuICBvblJlc2l6ZURlYm91bmNlZDogQ29tbW9uLmRlYm91bmNlKGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLm9uUmVzaXplKCk7XG4gIH0sIDUwKSxcbiAgcmVtZW1iZXI6IGZ1bmN0aW9uIHJlbWVtYmVyKCkge1xuICAgIGlmIChDb21tb24uaXNVbmRlZmluZWQoU0FWRV9ESUFMT0dVRSkpIHtcbiAgICAgIFNBVkVfRElBTE9HVUUgPSBuZXcgQ2VudGVyZWREaXYoKTtcbiAgICAgIFNBVkVfRElBTE9HVUUuZG9tRWxlbWVudC5pbm5lckhUTUwgPSBzYXZlRGlhbG9nQ29udGVudHM7XG4gICAgfVxuICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgY2FuIG9ubHkgY2FsbCByZW1lbWJlciBvbiBhIHRvcCBsZXZlbCBHVUkuJyk7XG4gICAgfVxuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgQ29tbW9uLmVhY2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSwgZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgaWYgKF90aGlzLl9fcmVtZW1iZXJlZE9iamVjdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGFkZFNhdmVNZW51KF90aGlzKTtcbiAgICAgIH1cbiAgICAgIGlmIChfdGhpcy5fX3JlbWVtYmVyZWRPYmplY3RzLmluZGV4T2Yob2JqZWN0KSA9PT0gLTEpIHtcbiAgICAgICAgX3RoaXMuX19yZW1lbWJlcmVkT2JqZWN0cy5wdXNoKG9iamVjdCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHRoaXMuYXV0b1BsYWNlKSB7XG4gICAgICBzZXRXaWR0aCh0aGlzLCB0aGlzLndpZHRoKTtcbiAgICB9XG4gIH0sXG4gIGdldFJvb3Q6IGZ1bmN0aW9uIGdldFJvb3QoKSB7XG4gICAgdmFyIGd1aSA9IHRoaXM7XG4gICAgd2hpbGUgKGd1aS5wYXJlbnQpIHtcbiAgICAgIGd1aSA9IGd1aS5wYXJlbnQ7XG4gICAgfVxuICAgIHJldHVybiBndWk7XG4gIH0sXG4gIGdldFNhdmVPYmplY3Q6IGZ1bmN0aW9uIGdldFNhdmVPYmplY3QoKSB7XG4gICAgdmFyIHRvUmV0dXJuID0gdGhpcy5sb2FkO1xuICAgIHRvUmV0dXJuLmNsb3NlZCA9IHRoaXMuY2xvc2VkO1xuICAgIGlmICh0aGlzLl9fcmVtZW1iZXJlZE9iamVjdHMubGVuZ3RoID4gMCkge1xuICAgICAgdG9SZXR1cm4ucHJlc2V0ID0gdGhpcy5wcmVzZXQ7XG4gICAgICBpZiAoIXRvUmV0dXJuLnJlbWVtYmVyZWQpIHtcbiAgICAgICAgdG9SZXR1cm4ucmVtZW1iZXJlZCA9IHt9O1xuICAgICAgfVxuICAgICAgdG9SZXR1cm4ucmVtZW1iZXJlZFt0aGlzLnByZXNldF0gPSBnZXRDdXJyZW50UHJlc2V0KHRoaXMpO1xuICAgIH1cbiAgICB0b1JldHVybi5mb2xkZXJzID0ge307XG4gICAgQ29tbW9uLmVhY2godGhpcy5fX2ZvbGRlcnMsIGZ1bmN0aW9uIChlbGVtZW50LCBrZXkpIHtcbiAgICAgIHRvUmV0dXJuLmZvbGRlcnNba2V5XSA9IGVsZW1lbnQuZ2V0U2F2ZU9iamVjdCgpO1xuICAgIH0pO1xuICAgIHJldHVybiB0b1JldHVybjtcbiAgfSxcbiAgc2F2ZTogZnVuY3Rpb24gc2F2ZSgpIHtcbiAgICBpZiAoIXRoaXMubG9hZC5yZW1lbWJlcmVkKSB7XG4gICAgICB0aGlzLmxvYWQucmVtZW1iZXJlZCA9IHt9O1xuICAgIH1cbiAgICB0aGlzLmxvYWQucmVtZW1iZXJlZFt0aGlzLnByZXNldF0gPSBnZXRDdXJyZW50UHJlc2V0KHRoaXMpO1xuICAgIG1hcmtQcmVzZXRNb2RpZmllZCh0aGlzLCBmYWxzZSk7XG4gICAgdGhpcy5zYXZlVG9Mb2NhbFN0b3JhZ2VJZlBvc3NpYmxlKCk7XG4gIH0sXG4gIHNhdmVBczogZnVuY3Rpb24gc2F2ZUFzKHByZXNldE5hbWUpIHtcbiAgICBpZiAoIXRoaXMubG9hZC5yZW1lbWJlcmVkKSB7XG4gICAgICB0aGlzLmxvYWQucmVtZW1iZXJlZCA9IHt9O1xuICAgICAgdGhpcy5sb2FkLnJlbWVtYmVyZWRbREVGQVVMVF9ERUZBVUxUX1BSRVNFVF9OQU1FXSA9IGdldEN1cnJlbnRQcmVzZXQodGhpcywgdHJ1ZSk7XG4gICAgfVxuICAgIHRoaXMubG9hZC5yZW1lbWJlcmVkW3ByZXNldE5hbWVdID0gZ2V0Q3VycmVudFByZXNldCh0aGlzKTtcbiAgICB0aGlzLnByZXNldCA9IHByZXNldE5hbWU7XG4gICAgYWRkUHJlc2V0T3B0aW9uKHRoaXMsIHByZXNldE5hbWUsIHRydWUpO1xuICAgIHRoaXMuc2F2ZVRvTG9jYWxTdG9yYWdlSWZQb3NzaWJsZSgpO1xuICB9LFxuICByZXZlcnQ6IGZ1bmN0aW9uIHJldmVydChndWkpIHtcbiAgICBDb21tb24uZWFjaCh0aGlzLl9fY29udHJvbGxlcnMsIGZ1bmN0aW9uIChjb250cm9sbGVyKSB7XG4gICAgICBpZiAoIXRoaXMuZ2V0Um9vdCgpLmxvYWQucmVtZW1iZXJlZCkge1xuICAgICAgICBjb250cm9sbGVyLnNldFZhbHVlKGNvbnRyb2xsZXIuaW5pdGlhbFZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlY2FsbFNhdmVkVmFsdWUoZ3VpIHx8IHRoaXMuZ2V0Um9vdCgpLCBjb250cm9sbGVyKTtcbiAgICAgIH1cbiAgICAgIGlmIChjb250cm9sbGVyLl9fb25GaW5pc2hDaGFuZ2UpIHtcbiAgICAgICAgY29udHJvbGxlci5fX29uRmluaXNoQ2hhbmdlLmNhbGwoY29udHJvbGxlciwgY29udHJvbGxlci5nZXRWYWx1ZSgpKTtcbiAgICAgIH1cbiAgICB9LCB0aGlzKTtcbiAgICBDb21tb24uZWFjaCh0aGlzLl9fZm9sZGVycywgZnVuY3Rpb24gKGZvbGRlcikge1xuICAgICAgZm9sZGVyLnJldmVydChmb2xkZXIpO1xuICAgIH0pO1xuICAgIGlmICghZ3VpKSB7XG4gICAgICBtYXJrUHJlc2V0TW9kaWZpZWQodGhpcy5nZXRSb290KCksIGZhbHNlKTtcbiAgICB9XG4gIH0sXG4gIGxpc3RlbjogZnVuY3Rpb24gbGlzdGVuKGNvbnRyb2xsZXIpIHtcbiAgICB2YXIgaW5pdCA9IHRoaXMuX19saXN0ZW5pbmcubGVuZ3RoID09PSAwO1xuICAgIHRoaXMuX19saXN0ZW5pbmcucHVzaChjb250cm9sbGVyKTtcbiAgICBpZiAoaW5pdCkge1xuICAgICAgdXBkYXRlRGlzcGxheXModGhpcy5fX2xpc3RlbmluZyk7XG4gICAgfVxuICB9LFxuICB1cGRhdGVEaXNwbGF5OiBmdW5jdGlvbiB1cGRhdGVEaXNwbGF5KCkge1xuICAgIENvbW1vbi5lYWNoKHRoaXMuX19jb250cm9sbGVycywgZnVuY3Rpb24gKGNvbnRyb2xsZXIpIHtcbiAgICAgIGNvbnRyb2xsZXIudXBkYXRlRGlzcGxheSgpO1xuICAgIH0pO1xuICAgIENvbW1vbi5lYWNoKHRoaXMuX19mb2xkZXJzLCBmdW5jdGlvbiAoZm9sZGVyKSB7XG4gICAgICBmb2xkZXIudXBkYXRlRGlzcGxheSgpO1xuICAgIH0pO1xuICB9XG59KTtcbmZ1bmN0aW9uIGFkZFJvdyhndWksIG5ld0RvbSwgbGlCZWZvcmUpIHtcbiAgdmFyIGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgaWYgKG5ld0RvbSkge1xuICAgIGxpLmFwcGVuZENoaWxkKG5ld0RvbSk7XG4gIH1cbiAgaWYgKGxpQmVmb3JlKSB7XG4gICAgZ3VpLl9fdWwuaW5zZXJ0QmVmb3JlKGxpLCBsaUJlZm9yZSk7XG4gIH0gZWxzZSB7XG4gICAgZ3VpLl9fdWwuYXBwZW5kQ2hpbGQobGkpO1xuICB9XG4gIGd1aS5vblJlc2l6ZSgpO1xuICByZXR1cm4gbGk7XG59XG5mdW5jdGlvbiByZW1vdmVMaXN0ZW5lcnMoZ3VpKSB7XG4gIGRvbS51bmJpbmQod2luZG93LCAncmVzaXplJywgZ3VpLl9fcmVzaXplSGFuZGxlcik7XG4gIGlmIChndWkuc2F2ZVRvTG9jYWxTdG9yYWdlSWZQb3NzaWJsZSkge1xuICAgIGRvbS51bmJpbmQod2luZG93LCAndW5sb2FkJywgZ3VpLnNhdmVUb0xvY2FsU3RvcmFnZUlmUG9zc2libGUpO1xuICB9XG59XG5mdW5jdGlvbiBtYXJrUHJlc2V0TW9kaWZpZWQoZ3VpLCBtb2RpZmllZCkge1xuICB2YXIgb3B0ID0gZ3VpLl9fcHJlc2V0X3NlbGVjdFtndWkuX19wcmVzZXRfc2VsZWN0LnNlbGVjdGVkSW5kZXhdO1xuICBpZiAobW9kaWZpZWQpIHtcbiAgICBvcHQuaW5uZXJIVE1MID0gb3B0LnZhbHVlICsgJyonO1xuICB9IGVsc2Uge1xuICAgIG9wdC5pbm5lckhUTUwgPSBvcHQudmFsdWU7XG4gIH1cbn1cbmZ1bmN0aW9uIGF1Z21lbnRDb250cm9sbGVyKGd1aSwgbGksIGNvbnRyb2xsZXIpIHtcbiAgY29udHJvbGxlci5fX2xpID0gbGk7XG4gIGNvbnRyb2xsZXIuX19ndWkgPSBndWk7XG4gIENvbW1vbi5leHRlbmQoY29udHJvbGxlciwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICBvcHRpb25zOiBmdW5jdGlvbiBvcHRpb25zKF9vcHRpb25zKSB7XG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdmFyIG5leHRTaWJsaW5nID0gY29udHJvbGxlci5fX2xpLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgY29udHJvbGxlci5yZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuIF9hZGQoZ3VpLCBjb250cm9sbGVyLm9iamVjdCwgY29udHJvbGxlci5wcm9wZXJ0eSwge1xuICAgICAgICAgIGJlZm9yZTogbmV4dFNpYmxpbmcsXG4gICAgICAgICAgZmFjdG9yeUFyZ3M6IFtDb21tb24udG9BcnJheShhcmd1bWVudHMpXVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChDb21tb24uaXNBcnJheShfb3B0aW9ucykgfHwgQ29tbW9uLmlzT2JqZWN0KF9vcHRpb25zKSkge1xuICAgICAgICB2YXIgX25leHRTaWJsaW5nID0gY29udHJvbGxlci5fX2xpLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgY29udHJvbGxlci5yZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuIF9hZGQoZ3VpLCBjb250cm9sbGVyLm9iamVjdCwgY29udHJvbGxlci5wcm9wZXJ0eSwge1xuICAgICAgICAgIGJlZm9yZTogX25leHRTaWJsaW5nLFxuICAgICAgICAgIGZhY3RvcnlBcmdzOiBbX29wdGlvbnNdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgbmFtZTogZnVuY3Rpb24gbmFtZShfbmFtZSkge1xuICAgICAgY29udHJvbGxlci5fX2xpLmZpcnN0RWxlbWVudENoaWxkLmZpcnN0RWxlbWVudENoaWxkLmlubmVySFRNTCA9IF9uYW1lO1xuICAgICAgcmV0dXJuIGNvbnRyb2xsZXI7XG4gICAgfSxcbiAgICBsaXN0ZW46IGZ1bmN0aW9uIGxpc3RlbigpIHtcbiAgICAgIGNvbnRyb2xsZXIuX19ndWkubGlzdGVuKGNvbnRyb2xsZXIpO1xuICAgICAgcmV0dXJuIGNvbnRyb2xsZXI7XG4gICAgfSxcbiAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgIGNvbnRyb2xsZXIuX19ndWkucmVtb3ZlKGNvbnRyb2xsZXIpO1xuICAgICAgcmV0dXJuIGNvbnRyb2xsZXI7XG4gICAgfVxuICB9KTtcbiAgaWYgKGNvbnRyb2xsZXIgaW5zdGFuY2VvZiBOdW1iZXJDb250cm9sbGVyU2xpZGVyKSB7XG4gICAgdmFyIGJveCA9IG5ldyBOdW1iZXJDb250cm9sbGVyQm94KGNvbnRyb2xsZXIub2JqZWN0LCBjb250cm9sbGVyLnByb3BlcnR5LCB7IG1pbjogY29udHJvbGxlci5fX21pbiwgbWF4OiBjb250cm9sbGVyLl9fbWF4LCBzdGVwOiBjb250cm9sbGVyLl9fc3RlcCB9KTtcbiAgICBDb21tb24uZWFjaChbJ3VwZGF0ZURpc3BsYXknLCAnb25DaGFuZ2UnLCAnb25GaW5pc2hDaGFuZ2UnLCAnc3RlcCddLCBmdW5jdGlvbiAobWV0aG9kKSB7XG4gICAgICB2YXIgcGMgPSBjb250cm9sbGVyW21ldGhvZF07XG4gICAgICB2YXIgcGIgPSBib3hbbWV0aG9kXTtcbiAgICAgIGNvbnRyb2xsZXJbbWV0aG9kXSA9IGJveFttZXRob2RdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gICAgICAgIHBiLmFwcGx5KGJveCwgYXJncyk7XG4gICAgICAgIHJldHVybiBwYy5hcHBseShjb250cm9sbGVyLCBhcmdzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gICAgZG9tLmFkZENsYXNzKGxpLCAnaGFzLXNsaWRlcicpO1xuICAgIGNvbnRyb2xsZXIuZG9tRWxlbWVudC5pbnNlcnRCZWZvcmUoYm94LmRvbUVsZW1lbnQsIGNvbnRyb2xsZXIuZG9tRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCk7XG4gIH0gZWxzZSBpZiAoY29udHJvbGxlciBpbnN0YW5jZW9mIE51bWJlckNvbnRyb2xsZXJCb3gpIHtcbiAgICB2YXIgciA9IGZ1bmN0aW9uIHIocmV0dXJuZWQpIHtcbiAgICAgIGlmIChDb21tb24uaXNOdW1iZXIoY29udHJvbGxlci5fX21pbikgJiYgQ29tbW9uLmlzTnVtYmVyKGNvbnRyb2xsZXIuX19tYXgpKSB7XG4gICAgICAgIHZhciBvbGROYW1lID0gY29udHJvbGxlci5fX2xpLmZpcnN0RWxlbWVudENoaWxkLmZpcnN0RWxlbWVudENoaWxkLmlubmVySFRNTDtcbiAgICAgICAgdmFyIHdhc0xpc3RlbmluZyA9IGNvbnRyb2xsZXIuX19ndWkuX19saXN0ZW5pbmcuaW5kZXhPZihjb250cm9sbGVyKSA+IC0xO1xuICAgICAgICBjb250cm9sbGVyLnJlbW92ZSgpO1xuICAgICAgICB2YXIgbmV3Q29udHJvbGxlciA9IF9hZGQoZ3VpLCBjb250cm9sbGVyLm9iamVjdCwgY29udHJvbGxlci5wcm9wZXJ0eSwge1xuICAgICAgICAgIGJlZm9yZTogY29udHJvbGxlci5fX2xpLm5leHRFbGVtZW50U2libGluZyxcbiAgICAgICAgICBmYWN0b3J5QXJnczogW2NvbnRyb2xsZXIuX19taW4sIGNvbnRyb2xsZXIuX19tYXgsIGNvbnRyb2xsZXIuX19zdGVwXVxuICAgICAgICB9KTtcbiAgICAgICAgbmV3Q29udHJvbGxlci5uYW1lKG9sZE5hbWUpO1xuICAgICAgICBpZiAod2FzTGlzdGVuaW5nKSBuZXdDb250cm9sbGVyLmxpc3RlbigpO1xuICAgICAgICByZXR1cm4gbmV3Q29udHJvbGxlcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXR1cm5lZDtcbiAgICB9O1xuICAgIGNvbnRyb2xsZXIubWluID0gQ29tbW9uLmNvbXBvc2UociwgY29udHJvbGxlci5taW4pO1xuICAgIGNvbnRyb2xsZXIubWF4ID0gQ29tbW9uLmNvbXBvc2UociwgY29udHJvbGxlci5tYXgpO1xuICB9IGVsc2UgaWYgKGNvbnRyb2xsZXIgaW5zdGFuY2VvZiBCb29sZWFuQ29udHJvbGxlcikge1xuICAgIGRvbS5iaW5kKGxpLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBkb20uZmFrZUV2ZW50KGNvbnRyb2xsZXIuX19jaGVja2JveCwgJ2NsaWNrJyk7XG4gICAgfSk7XG4gICAgZG9tLmJpbmQoY29udHJvbGxlci5fX2NoZWNrYm94LCAnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmIChjb250cm9sbGVyIGluc3RhbmNlb2YgRnVuY3Rpb25Db250cm9sbGVyKSB7XG4gICAgZG9tLmJpbmQobGksICdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGRvbS5mYWtlRXZlbnQoY29udHJvbGxlci5fX2J1dHRvbiwgJ2NsaWNrJyk7XG4gICAgfSk7XG4gICAgZG9tLmJpbmQobGksICdtb3VzZW92ZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICBkb20uYWRkQ2xhc3MoY29udHJvbGxlci5fX2J1dHRvbiwgJ2hvdmVyJyk7XG4gICAgfSk7XG4gICAgZG9tLmJpbmQobGksICdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGRvbS5yZW1vdmVDbGFzcyhjb250cm9sbGVyLl9fYnV0dG9uLCAnaG92ZXInKTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmIChjb250cm9sbGVyIGluc3RhbmNlb2YgQ29sb3JDb250cm9sbGVyKSB7XG4gICAgZG9tLmFkZENsYXNzKGxpLCAnY29sb3InKTtcbiAgICBjb250cm9sbGVyLnVwZGF0ZURpc3BsYXkgPSBDb21tb24uY29tcG9zZShmdW5jdGlvbiAodmFsKSB7XG4gICAgICBsaS5zdHlsZS5ib3JkZXJMZWZ0Q29sb3IgPSBjb250cm9sbGVyLl9fY29sb3IudG9TdHJpbmcoKTtcbiAgICAgIHJldHVybiB2YWw7XG4gICAgfSwgY29udHJvbGxlci51cGRhdGVEaXNwbGF5KTtcbiAgICBjb250cm9sbGVyLnVwZGF0ZURpc3BsYXkoKTtcbiAgfVxuICBjb250cm9sbGVyLnNldFZhbHVlID0gQ29tbW9uLmNvbXBvc2UoZnVuY3Rpb24gKHZhbCkge1xuICAgIGlmIChndWkuZ2V0Um9vdCgpLl9fcHJlc2V0X3NlbGVjdCAmJiBjb250cm9sbGVyLmlzTW9kaWZpZWQoKSkge1xuICAgICAgbWFya1ByZXNldE1vZGlmaWVkKGd1aS5nZXRSb290KCksIHRydWUpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsO1xuICB9LCBjb250cm9sbGVyLnNldFZhbHVlKTtcbn1cbmZ1bmN0aW9uIHJlY2FsbFNhdmVkVmFsdWUoZ3VpLCBjb250cm9sbGVyKSB7XG4gIHZhciByb290ID0gZ3VpLmdldFJvb3QoKTtcbiAgdmFyIG1hdGNoZWRJbmRleCA9IHJvb3QuX19yZW1lbWJlcmVkT2JqZWN0cy5pbmRleE9mKGNvbnRyb2xsZXIub2JqZWN0KTtcbiAgaWYgKG1hdGNoZWRJbmRleCAhPT0gLTEpIHtcbiAgICB2YXIgY29udHJvbGxlck1hcCA9IHJvb3QuX19yZW1lbWJlcmVkT2JqZWN0SW5kZWNlc1RvQ29udHJvbGxlcnNbbWF0Y2hlZEluZGV4XTtcbiAgICBpZiAoY29udHJvbGxlck1hcCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb250cm9sbGVyTWFwID0ge307XG4gICAgICByb290Ll9fcmVtZW1iZXJlZE9iamVjdEluZGVjZXNUb0NvbnRyb2xsZXJzW21hdGNoZWRJbmRleF0gPSBjb250cm9sbGVyTWFwO1xuICAgIH1cbiAgICBjb250cm9sbGVyTWFwW2NvbnRyb2xsZXIucHJvcGVydHldID0gY29udHJvbGxlcjtcbiAgICBpZiAocm9vdC5sb2FkICYmIHJvb3QubG9hZC5yZW1lbWJlcmVkKSB7XG4gICAgICB2YXIgcHJlc2V0TWFwID0gcm9vdC5sb2FkLnJlbWVtYmVyZWQ7XG4gICAgICB2YXIgcHJlc2V0ID0gdm9pZCAwO1xuICAgICAgaWYgKHByZXNldE1hcFtndWkucHJlc2V0XSkge1xuICAgICAgICBwcmVzZXQgPSBwcmVzZXRNYXBbZ3VpLnByZXNldF07XG4gICAgICB9IGVsc2UgaWYgKHByZXNldE1hcFtERUZBVUxUX0RFRkFVTFRfUFJFU0VUX05BTUVdKSB7XG4gICAgICAgIHByZXNldCA9IHByZXNldE1hcFtERUZBVUxUX0RFRkFVTFRfUFJFU0VUX05BTUVdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHByZXNldFttYXRjaGVkSW5kZXhdICYmIHByZXNldFttYXRjaGVkSW5kZXhdW2NvbnRyb2xsZXIucHJvcGVydHldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gcHJlc2V0W21hdGNoZWRJbmRleF1bY29udHJvbGxlci5wcm9wZXJ0eV07XG4gICAgICAgIGNvbnRyb2xsZXIuaW5pdGlhbFZhbHVlID0gdmFsdWU7XG4gICAgICAgIGNvbnRyb2xsZXIuc2V0VmFsdWUodmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gX2FkZChndWksIG9iamVjdCwgcHJvcGVydHksIHBhcmFtcykge1xuICBpZiAob2JqZWN0W3Byb3BlcnR5XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdPYmplY3QgXCInICsgb2JqZWN0ICsgJ1wiIGhhcyBubyBwcm9wZXJ0eSBcIicgKyBwcm9wZXJ0eSArICdcIicpO1xuICB9XG4gIHZhciBjb250cm9sbGVyID0gdm9pZCAwO1xuICBpZiAocGFyYW1zLmNvbG9yKSB7XG4gICAgY29udHJvbGxlciA9IG5ldyBDb2xvckNvbnRyb2xsZXIob2JqZWN0LCBwcm9wZXJ0eSk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGZhY3RvcnlBcmdzID0gW29iamVjdCwgcHJvcGVydHldLmNvbmNhdChwYXJhbXMuZmFjdG9yeUFyZ3MpO1xuICAgIGNvbnRyb2xsZXIgPSBDb250cm9sbGVyRmFjdG9yeS5hcHBseShndWksIGZhY3RvcnlBcmdzKTtcbiAgfVxuICBpZiAocGFyYW1zLmJlZm9yZSBpbnN0YW5jZW9mIENvbnRyb2xsZXIpIHtcbiAgICBwYXJhbXMuYmVmb3JlID0gcGFyYW1zLmJlZm9yZS5fX2xpO1xuICB9XG4gIHJlY2FsbFNhdmVkVmFsdWUoZ3VpLCBjb250cm9sbGVyKTtcbiAgZG9tLmFkZENsYXNzKGNvbnRyb2xsZXIuZG9tRWxlbWVudCwgJ2MnKTtcbiAgdmFyIG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gIGRvbS5hZGRDbGFzcyhuYW1lLCAncHJvcGVydHktbmFtZScpO1xuICBuYW1lLmlubmVySFRNTCA9IGNvbnRyb2xsZXIucHJvcGVydHk7XG4gIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKG5hbWUpO1xuICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY29udHJvbGxlci5kb21FbGVtZW50KTtcbiAgdmFyIGxpID0gYWRkUm93KGd1aSwgY29udGFpbmVyLCBwYXJhbXMuYmVmb3JlKTtcbiAgZG9tLmFkZENsYXNzKGxpLCBHVUkuQ0xBU1NfQ09OVFJPTExFUl9ST1cpO1xuICBpZiAoY29udHJvbGxlciBpbnN0YW5jZW9mIENvbG9yQ29udHJvbGxlcikge1xuICAgIGRvbS5hZGRDbGFzcyhsaSwgJ2NvbG9yJyk7XG4gIH0gZWxzZSB7XG4gICAgZG9tLmFkZENsYXNzKGxpLCBfdHlwZW9mKGNvbnRyb2xsZXIuZ2V0VmFsdWUoKSkpO1xuICB9XG4gIGF1Z21lbnRDb250cm9sbGVyKGd1aSwgbGksIGNvbnRyb2xsZXIpO1xuICBndWkuX19jb250cm9sbGVycy5wdXNoKGNvbnRyb2xsZXIpO1xuICByZXR1cm4gY29udHJvbGxlcjtcbn1cbmZ1bmN0aW9uIGdldExvY2FsU3RvcmFnZUhhc2goZ3VpLCBrZXkpIHtcbiAgcmV0dXJuIGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgKyAnLicgKyBrZXk7XG59XG5mdW5jdGlvbiBhZGRQcmVzZXRPcHRpb24oZ3VpLCBuYW1lLCBzZXRTZWxlY3RlZCkge1xuICB2YXIgb3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gIG9wdC5pbm5lckhUTUwgPSBuYW1lO1xuICBvcHQudmFsdWUgPSBuYW1lO1xuICBndWkuX19wcmVzZXRfc2VsZWN0LmFwcGVuZENoaWxkKG9wdCk7XG4gIGlmIChzZXRTZWxlY3RlZCkge1xuICAgIGd1aS5fX3ByZXNldF9zZWxlY3Quc2VsZWN0ZWRJbmRleCA9IGd1aS5fX3ByZXNldF9zZWxlY3QubGVuZ3RoIC0gMTtcbiAgfVxufVxuZnVuY3Rpb24gc2hvd0hpZGVFeHBsYWluKGd1aSwgZXhwbGFpbikge1xuICBleHBsYWluLnN0eWxlLmRpc3BsYXkgPSBndWkudXNlTG9jYWxTdG9yYWdlID8gJ2Jsb2NrJyA6ICdub25lJztcbn1cbmZ1bmN0aW9uIGFkZFNhdmVNZW51KGd1aSkge1xuICB2YXIgZGl2ID0gZ3VpLl9fc2F2ZV9yb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICBkb20uYWRkQ2xhc3MoZ3VpLmRvbUVsZW1lbnQsICdoYXMtc2F2ZScpO1xuICBndWkuX191bC5pbnNlcnRCZWZvcmUoZGl2LCBndWkuX191bC5maXJzdENoaWxkKTtcbiAgZG9tLmFkZENsYXNzKGRpdiwgJ3NhdmUtcm93Jyk7XG4gIHZhciBnZWFycyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgZ2VhcnMuaW5uZXJIVE1MID0gJyZuYnNwOyc7XG4gIGRvbS5hZGRDbGFzcyhnZWFycywgJ2J1dHRvbiBnZWFycycpO1xuICB2YXIgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICBidXR0b24uaW5uZXJIVE1MID0gJ1NhdmUnO1xuICBkb20uYWRkQ2xhc3MoYnV0dG9uLCAnYnV0dG9uJyk7XG4gIGRvbS5hZGRDbGFzcyhidXR0b24sICdzYXZlJyk7XG4gIHZhciBidXR0b24yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICBidXR0b24yLmlubmVySFRNTCA9ICdOZXcnO1xuICBkb20uYWRkQ2xhc3MoYnV0dG9uMiwgJ2J1dHRvbicpO1xuICBkb20uYWRkQ2xhc3MoYnV0dG9uMiwgJ3NhdmUtYXMnKTtcbiAgdmFyIGJ1dHRvbjMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gIGJ1dHRvbjMuaW5uZXJIVE1MID0gJ1JldmVydCc7XG4gIGRvbS5hZGRDbGFzcyhidXR0b24zLCAnYnV0dG9uJyk7XG4gIGRvbS5hZGRDbGFzcyhidXR0b24zLCAncmV2ZXJ0Jyk7XG4gIHZhciBzZWxlY3QgPSBndWkuX19wcmVzZXRfc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VsZWN0Jyk7XG4gIGlmIChndWkubG9hZCAmJiBndWkubG9hZC5yZW1lbWJlcmVkKSB7XG4gICAgQ29tbW9uLmVhY2goZ3VpLmxvYWQucmVtZW1iZXJlZCwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgIGFkZFByZXNldE9wdGlvbihndWksIGtleSwga2V5ID09PSBndWkucHJlc2V0KTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBhZGRQcmVzZXRPcHRpb24oZ3VpLCBERUZBVUxUX0RFRkFVTFRfUFJFU0VUX05BTUUsIGZhbHNlKTtcbiAgfVxuICBkb20uYmluZChzZWxlY3QsICdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGd1aS5fX3ByZXNldF9zZWxlY3QubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICBndWkuX19wcmVzZXRfc2VsZWN0W2luZGV4XS5pbm5lckhUTUwgPSBndWkuX19wcmVzZXRfc2VsZWN0W2luZGV4XS52YWx1ZTtcbiAgICB9XG4gICAgZ3VpLnByZXNldCA9IHRoaXMudmFsdWU7XG4gIH0pO1xuICBkaXYuYXBwZW5kQ2hpbGQoc2VsZWN0KTtcbiAgZGl2LmFwcGVuZENoaWxkKGdlYXJzKTtcbiAgZGl2LmFwcGVuZENoaWxkKGJ1dHRvbik7XG4gIGRpdi5hcHBlbmRDaGlsZChidXR0b24yKTtcbiAgZGl2LmFwcGVuZENoaWxkKGJ1dHRvbjMpO1xuICBpZiAoU1VQUE9SVFNfTE9DQUxfU1RPUkFHRSkge1xuICAgIHZhciBleHBsYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RnLWxvY2FsLWV4cGxhaW4nKTtcbiAgICB2YXIgbG9jYWxTdG9yYWdlQ2hlY2tCb3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGctbG9jYWwtc3RvcmFnZScpO1xuICAgIHZhciBzYXZlTG9jYWxseSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZy1zYXZlLWxvY2FsbHknKTtcbiAgICBzYXZlTG9jYWxseS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oZ2V0TG9jYWxTdG9yYWdlSGFzaChndWksICdpc0xvY2FsJykpID09PSAndHJ1ZScpIHtcbiAgICAgIGxvY2FsU3RvcmFnZUNoZWNrQm94LnNldEF0dHJpYnV0ZSgnY2hlY2tlZCcsICdjaGVja2VkJyk7XG4gICAgfVxuICAgIHNob3dIaWRlRXhwbGFpbihndWksIGV4cGxhaW4pO1xuICAgIGRvbS5iaW5kKGxvY2FsU3RvcmFnZUNoZWNrQm94LCAnY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgZ3VpLnVzZUxvY2FsU3RvcmFnZSA9ICFndWkudXNlTG9jYWxTdG9yYWdlO1xuICAgICAgc2hvd0hpZGVFeHBsYWluKGd1aSwgZXhwbGFpbik7XG4gICAgfSk7XG4gIH1cbiAgdmFyIG5ld0NvbnN0cnVjdG9yVGV4dEFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGctbmV3LWNvbnN0cnVjdG9yJyk7XG4gIGRvbS5iaW5kKG5ld0NvbnN0cnVjdG9yVGV4dEFyZWEsICdrZXlkb3duJywgZnVuY3Rpb24gKGUpIHtcbiAgICBpZiAoZS5tZXRhS2V5ICYmIChlLndoaWNoID09PSA2NyB8fCBlLmtleUNvZGUgPT09IDY3KSkge1xuICAgICAgU0FWRV9ESUFMT0dVRS5oaWRlKCk7XG4gICAgfVxuICB9KTtcbiAgZG9tLmJpbmQoZ2VhcnMsICdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBuZXdDb25zdHJ1Y3RvclRleHRBcmVhLmlubmVySFRNTCA9IEpTT04uc3RyaW5naWZ5KGd1aS5nZXRTYXZlT2JqZWN0KCksIHVuZGVmaW5lZCwgMik7XG4gICAgU0FWRV9ESUFMT0dVRS5zaG93KCk7XG4gICAgbmV3Q29uc3RydWN0b3JUZXh0QXJlYS5mb2N1cygpO1xuICAgIG5ld0NvbnN0cnVjdG9yVGV4dEFyZWEuc2VsZWN0KCk7XG4gIH0pO1xuICBkb20uYmluZChidXR0b24sICdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBndWkuc2F2ZSgpO1xuICB9KTtcbiAgZG9tLmJpbmQoYnV0dG9uMiwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIHZhciBwcmVzZXROYW1lID0gcHJvbXB0KCdFbnRlciBhIG5ldyBwcmVzZXQgbmFtZS4nKTtcbiAgICBpZiAocHJlc2V0TmFtZSkge1xuICAgICAgZ3VpLnNhdmVBcyhwcmVzZXROYW1lKTtcbiAgICB9XG4gIH0pO1xuICBkb20uYmluZChidXR0b24zLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgZ3VpLnJldmVydCgpO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGFkZFJlc2l6ZUhhbmRsZShndWkpIHtcbiAgdmFyIHBtb3VzZVggPSB2b2lkIDA7XG4gIGd1aS5fX3Jlc2l6ZV9oYW5kbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgQ29tbW9uLmV4dGVuZChndWkuX19yZXNpemVfaGFuZGxlLnN0eWxlLCB7XG4gICAgd2lkdGg6ICc2cHgnLFxuICAgIG1hcmdpbkxlZnQ6ICctM3B4JyxcbiAgICBoZWlnaHQ6ICcyMDBweCcsXG4gICAgY3Vyc29yOiAnZXctcmVzaXplJyxcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJ1xuICB9KTtcbiAgZnVuY3Rpb24gZHJhZyhlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGd1aS53aWR0aCArPSBwbW91c2VYIC0gZS5jbGllbnRYO1xuICAgIGd1aS5vblJlc2l6ZSgpO1xuICAgIHBtb3VzZVggPSBlLmNsaWVudFg7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGZ1bmN0aW9uIGRyYWdTdG9wKCkge1xuICAgIGRvbS5yZW1vdmVDbGFzcyhndWkuX19jbG9zZUJ1dHRvbiwgR1VJLkNMQVNTX0RSQUcpO1xuICAgIGRvbS51bmJpbmQod2luZG93LCAnbW91c2Vtb3ZlJywgZHJhZyk7XG4gICAgZG9tLnVuYmluZCh3aW5kb3csICdtb3VzZXVwJywgZHJhZ1N0b3ApO1xuICB9XG4gIGZ1bmN0aW9uIGRyYWdTdGFydChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHBtb3VzZVggPSBlLmNsaWVudFg7XG4gICAgZG9tLmFkZENsYXNzKGd1aS5fX2Nsb3NlQnV0dG9uLCBHVUkuQ0xBU1NfRFJBRyk7XG4gICAgZG9tLmJpbmQod2luZG93LCAnbW91c2Vtb3ZlJywgZHJhZyk7XG4gICAgZG9tLmJpbmQod2luZG93LCAnbW91c2V1cCcsIGRyYWdTdG9wKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgZG9tLmJpbmQoZ3VpLl9fcmVzaXplX2hhbmRsZSwgJ21vdXNlZG93bicsIGRyYWdTdGFydCk7XG4gIGRvbS5iaW5kKGd1aS5fX2Nsb3NlQnV0dG9uLCAnbW91c2Vkb3duJywgZHJhZ1N0YXJ0KTtcbiAgZ3VpLmRvbUVsZW1lbnQuaW5zZXJ0QmVmb3JlKGd1aS5fX3Jlc2l6ZV9oYW5kbGUsIGd1aS5kb21FbGVtZW50LmZpcnN0RWxlbWVudENoaWxkKTtcbn1cbmZ1bmN0aW9uIHNldFdpZHRoKGd1aSwgdykge1xuICBndWkuZG9tRWxlbWVudC5zdHlsZS53aWR0aCA9IHcgKyAncHgnO1xuICBpZiAoZ3VpLl9fc2F2ZV9yb3cgJiYgZ3VpLmF1dG9QbGFjZSkge1xuICAgIGd1aS5fX3NhdmVfcm93LnN0eWxlLndpZHRoID0gdyArICdweCc7XG4gIH1cbiAgaWYgKGd1aS5fX2Nsb3NlQnV0dG9uKSB7XG4gICAgZ3VpLl9fY2xvc2VCdXR0b24uc3R5bGUud2lkdGggPSB3ICsgJ3B4JztcbiAgfVxufVxuZnVuY3Rpb24gZ2V0Q3VycmVudFByZXNldChndWksIHVzZUluaXRpYWxWYWx1ZXMpIHtcbiAgdmFyIHRvUmV0dXJuID0ge307XG4gIENvbW1vbi5lYWNoKGd1aS5fX3JlbWVtYmVyZWRPYmplY3RzLCBmdW5jdGlvbiAodmFsLCBpbmRleCkge1xuICAgIHZhciBzYXZlZFZhbHVlcyA9IHt9O1xuICAgIHZhciBjb250cm9sbGVyTWFwID0gZ3VpLl9fcmVtZW1iZXJlZE9iamVjdEluZGVjZXNUb0NvbnRyb2xsZXJzW2luZGV4XTtcbiAgICBDb21tb24uZWFjaChjb250cm9sbGVyTWFwLCBmdW5jdGlvbiAoY29udHJvbGxlciwgcHJvcGVydHkpIHtcbiAgICAgIHNhdmVkVmFsdWVzW3Byb3BlcnR5XSA9IHVzZUluaXRpYWxWYWx1ZXMgPyBjb250cm9sbGVyLmluaXRpYWxWYWx1ZSA6IGNvbnRyb2xsZXIuZ2V0VmFsdWUoKTtcbiAgICB9KTtcbiAgICB0b1JldHVybltpbmRleF0gPSBzYXZlZFZhbHVlcztcbiAgfSk7XG4gIHJldHVybiB0b1JldHVybjtcbn1cbmZ1bmN0aW9uIHNldFByZXNldFNlbGVjdEluZGV4KGd1aSkge1xuICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgZ3VpLl9fcHJlc2V0X3NlbGVjdC5sZW5ndGg7IGluZGV4KyspIHtcbiAgICBpZiAoZ3VpLl9fcHJlc2V0X3NlbGVjdFtpbmRleF0udmFsdWUgPT09IGd1aS5wcmVzZXQpIHtcbiAgICAgIGd1aS5fX3ByZXNldF9zZWxlY3Quc2VsZWN0ZWRJbmRleCA9IGluZGV4O1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gdXBkYXRlRGlzcGxheXMoY29udHJvbGxlckFycmF5KSB7XG4gIGlmIChjb250cm9sbGVyQXJyYXkubGVuZ3RoICE9PSAwKSB7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lJDEuY2FsbCh3aW5kb3csIGZ1bmN0aW9uICgpIHtcbiAgICAgIHVwZGF0ZURpc3BsYXlzKGNvbnRyb2xsZXJBcnJheSk7XG4gICAgfSk7XG4gIH1cbiAgQ29tbW9uLmVhY2goY29udHJvbGxlckFycmF5LCBmdW5jdGlvbiAoYykge1xuICAgIGMudXBkYXRlRGlzcGxheSgpO1xuICB9KTtcbn1cblxudmFyIGluZGV4ID0ge1xuICBjb2xvcjoge1xuICAgIENvbG9yOiBDb2xvcixcbiAgICBtYXRoOiBDb2xvck1hdGgsXG4gICAgaW50ZXJwcmV0OiBpbnRlcnByZXRcbiAgfSxcbiAgY29udHJvbGxlcnM6IHtcbiAgICBDb250cm9sbGVyOiBDb250cm9sbGVyLFxuICAgIEJvb2xlYW5Db250cm9sbGVyOiBCb29sZWFuQ29udHJvbGxlcixcbiAgICBPcHRpb25Db250cm9sbGVyOiBPcHRpb25Db250cm9sbGVyLFxuICAgIFN0cmluZ0NvbnRyb2xsZXI6IFN0cmluZ0NvbnRyb2xsZXIsXG4gICAgTnVtYmVyQ29udHJvbGxlcjogTnVtYmVyQ29udHJvbGxlcixcbiAgICBOdW1iZXJDb250cm9sbGVyQm94OiBOdW1iZXJDb250cm9sbGVyQm94LFxuICAgIE51bWJlckNvbnRyb2xsZXJTbGlkZXI6IE51bWJlckNvbnRyb2xsZXJTbGlkZXIsXG4gICAgRnVuY3Rpb25Db250cm9sbGVyOiBGdW5jdGlvbkNvbnRyb2xsZXIsXG4gICAgQ29sb3JDb250cm9sbGVyOiBDb2xvckNvbnRyb2xsZXJcbiAgfSxcbiAgZG9tOiB7XG4gICAgZG9tOiBkb21cbiAgfSxcbiAgZ3VpOiB7XG4gICAgR1VJOiBHVUlcbiAgfSxcbiAgR1VJOiBHVUlcbn07XG5cbnJldHVybiBpbmRleDtcblxufSkpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdC5ndWkuanMubWFwXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbm9kZV9tb2R1bGVzL2RhdC5ndWkvYnVpbGQvZGF0Lmd1aS5qcyJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7Ozs7Ozs7Ozs7O0FBYUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbEhBO0FBQ0E7QUFvSEE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBWEE7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFYQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFiQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQWRBO0FBMUNBO0FBRkE7QUErREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQURBO0FBRkE7QUFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQWRBO0FBZ0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFiQTtBQWpCQTtBQUZBO0FBcUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFwQkE7QUFzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFsQkE7QUFvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBcEJBO0FBc0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBbEJBO0FBakVBO0FBRkE7QUF5RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBekRBO0FBQ0E7QUEyREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFEQTtBQVFBO0FBQ0E7QUFDQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWRBO0FBZ0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFkQTtBQWdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQS9CQTtBQWlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWhKQTtBQUNBO0FBa0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkE7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYkE7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFwQ0E7QUFzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFuQkE7QUFDQTtBQXFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZEE7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCQTtBQW1CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZEE7QUFoRkE7QUFpR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdE1BO0FBd01BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBOUJBO0FBZ0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBV0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQURBO0FBR0E7QUF2QkE7QUFDQTtBQXlCQTtBQUVBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///17\n")},function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\n\nvar _analyser = __webpack_require__(1);\n\nvar _analyser2 = _interopRequireDefault(_analyser);\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = [\n\n/* if it\'s an object, it is considered as a property\r\n{\r\n  },*/\n\n["Audio settings", {\n  object: _app2.default,\n  property: "volume",\n  min: 0, max: 1, step: 0.05,\n  callback: null // this will be programmatically changed in the main\n}],\n\n// if it\'s an array, and first parameter is a string, it is considered as a folder\n["Peak detection", {\n  object: _analyser2.default.options.peakDetection.options,\n  property: "threshold",\n  min: 0, max: 6, step: 0.1\n}, {\n  object: _analyser2.default.options.peakDetection.options,\n  property: "ignoreTime",\n  min: 0, max: 5000, step: 10\n}, {\n  object: _analyser2.default.options.peakDetection.options,\n  property: "energyPersistence",\n  min: 300, max: 6000, step: 10\n}, {\n  object: _analyser2.default.options.peakDetection.options,\n  property: "peakPersistency",\n  min: 0, max: 2000, step: 10\n}]];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3VzZXItY29udHJvbHMuanM/NzlmYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQW5hbHlzZXJDb25maWcgZnJvbSAnLi9jb25maWcvYW5hbHlzZXIuY29uZmlnJztcclxuaW1wb3J0IEFwcENvbmZpZyBmcm9tICcuL2NvbmZpZy9hcHAuY29uZmlnJztcclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBbXHJcblxyXG4gIC8qIGlmIGl0J3MgYW4gb2JqZWN0LCBpdCBpcyBjb25zaWRlcmVkIGFzIGEgcHJvcGVydHlcclxuICB7XHJcblxyXG4gIH0sKi9cclxuXHJcbiAgW1xyXG4gICAgXCJBdWRpbyBzZXR0aW5nc1wiLFxyXG5cclxuICAgIHtcclxuICAgICAgb2JqZWN0OiBBcHBDb25maWcsXHJcbiAgICAgIHByb3BlcnR5OiBcInZvbHVtZVwiLFxyXG4gICAgICBtaW46IDAsIG1heDogMSwgc3RlcDogMC4wNSxcclxuICAgICAgY2FsbGJhY2s6IG51bGwgICAgICAgICAgICAgICAgLy8gdGhpcyB3aWxsIGJlIHByb2dyYW1tYXRpY2FsbHkgY2hhbmdlZCBpbiB0aGUgbWFpblxyXG4gICAgfVxyXG4gIF0sXHJcblxyXG4gIC8vIGlmIGl0J3MgYW4gYXJyYXksIGFuZCBmaXJzdCBwYXJhbWV0ZXIgaXMgYSBzdHJpbmcsIGl0IGlzIGNvbnNpZGVyZWQgYXMgYSBmb2xkZXJcclxuICBbXHJcbiAgICBcIlBlYWsgZGV0ZWN0aW9uXCIsXHJcblxyXG4gICAge1xyXG4gICAgICBvYmplY3Q6IEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMucGVha0RldGVjdGlvbi5vcHRpb25zLFxyXG4gICAgICBwcm9wZXJ0eTogXCJ0aHJlc2hvbGRcIixcclxuICAgICAgbWluOiAwLCBtYXg6IDYsIHN0ZXA6IDAuMVxyXG4gICAgfSxcclxuXHJcbiAgICB7XHJcbiAgICAgIG9iamVjdDogQW5hbHlzZXJDb25maWcub3B0aW9ucy5wZWFrRGV0ZWN0aW9uLm9wdGlvbnMsXHJcbiAgICAgIHByb3BlcnR5OiBcImlnbm9yZVRpbWVcIixcclxuICAgICAgbWluOiAwLCBtYXg6IDUwMDAsIHN0ZXA6IDEwXHJcbiAgICB9LFxyXG5cclxuICAgIHtcclxuICAgICAgb2JqZWN0OiBBbmFseXNlckNvbmZpZy5vcHRpb25zLnBlYWtEZXRlY3Rpb24ub3B0aW9ucyxcclxuICAgICAgcHJvcGVydHk6IFwiZW5lcmd5UGVyc2lzdGVuY2VcIixcclxuICAgICAgbWluOiAzMDAsIG1heDogNjAwMCwgc3RlcDogMTBcclxuICAgIH0sXHJcblxyXG4gICAge1xyXG4gICAgICBvYmplY3Q6IEFuYWx5c2VyQ29uZmlnLm9wdGlvbnMucGVha0RldGVjdGlvbi5vcHRpb25zLFxyXG4gICAgICBwcm9wZXJ0eTogXCJwZWFrUGVyc2lzdGVuY3lcIixcclxuICAgICAgbWluOiAwLCBtYXg6IDIwMDAsIHN0ZXA6IDEwXHJcbiAgICB9LFxyXG4gIF0sXHJcblxyXG5dO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvdXNlci1jb250cm9scy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFFQTtBQUNBO0FBQ0E7Ozs7QUFLQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQU9BO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFDQTtBQUNBO0FBSEE7QUFPQTtBQUNBO0FBQ0E7QUFIQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///18\n')},function(module,exports,__webpack_require__){"use strict";eval("\n\nvar anchor;\nvar keys = 'protocol hostname host pathname port search hash href'.split(' ');\nfunction _parseURL(url) {\n  if (!anchor) {\n    anchor = document.createElement('a');\n  }\n\n  var result = {};\n\n  anchor.href = url || '';\n\n  for (var i = 0, len = keys.length; i < len; i++) {\n    var key = keys[i];\n    result[key] = anchor[key];\n  }\n\n  return result;\n}\n\nfunction _appendQueryParam(url, param, value) {\n  var U = _parseURL(url);\n  var regex = /\\?(?:.*)$/;\n  var chr = regex.test(U.search) ? '&' : '?';\n  var result = U.protocol + '//' + U.host + U.port + U.pathname + U.search + chr + param + '=' + value + U.hash;\n\n  return result;\n}\n\nfunction SoundCloud(clientId) {\n  if (!(this instanceof SoundCloud)) {\n    return new SoundCloud(clientId);\n  }\n\n  if (!clientId) {\n    console.info('SoundCloud API requires clientId, get it at https://developers.soundcloud.com');\n  }\n\n  this._events = {};\n\n  this._clientId = clientId;\n  this._baseUrl = 'https://api.soundcloud.com';\n\n  this.playing = false;\n  this.duration = 0;\n\n  this.audio = document.createElement('audio');\n}\n\nSoundCloud.prototype.resolve = function (url, callback) {\n  var resolveUrl = this._baseUrl + '/resolve.json?url=' + encodeURIComponent(url) + '&client_id=' + this._clientId;\n\n  this._json(resolveUrl, function (data) {\n    this.cleanData();\n\n    if (Array.isArray(data)) {\n      var tracks = data;\n      data = { tracks: tracks };\n      this._playlist = data;\n    } else if (data.tracks) {\n      this._playlist = data;\n    } else {\n      this._track = data;\n\n      // save timings\n      var U = _parseURL(url);\n      this._track.stream_url += U.hash;\n    }\n\n    this.duration = data.duration && !isNaN(data.duration) ? data.duration / 1000 : // convert to seconds\n    0; // no duration is zero\n\n    callback(data);\n  }.bind(this));\n};\n\n// deprecated\nSoundCloud.prototype._jsonp = function (url, callback) {\n  var target = document.getElementsByTagName('script')[0] || document.head;\n  var script = document.createElement('script');\n  var id = 'jsonp_callback_' + new Date().valueOf() + Math.floor(Math.random() * 1000);\n\n  window[id] = function (data) {\n    if (script.parentNode) {\n      script.parentNode.removeChild(script);\n    }\n    window[id] = function () {};\n    callback(data);\n  };\n\n  script.src = _appendQueryParam(url, 'callback', id);\n  target.parentNode.insertBefore(script, target);\n};\n\nSoundCloud.prototype._json = function (url, callback) {\n  var xhr = new XMLHttpRequest();\n\n  xhr.open('GET', url);\n  xhr.onreadystatechange = function () {\n    if (xhr.readyState === 4) {\n      if (xhr.status === 200) {\n        var resp = {};\n        try {\n          resp = JSON.parse(xhr.responseText);\n        } catch (err) {\n          // fail silently\n        }\n        callback(resp);\n      }\n    }\n  };\n\n  xhr.send(null);\n};\n\nSoundCloud.prototype.on = function (e, fn) {\n  this._events[e] = fn;\n  this.audio.addEventListener(e, fn, false);\n};\n\nSoundCloud.prototype.off = function (e, fn) {\n  this._events[e] = null;\n  this.audio.removeEventListener(e, fn);\n};\n\nSoundCloud.prototype.unbindAll = function () {\n  for (var e in this._events) {\n    var fn = this._events[e];\n    if (fn) {\n      this.off(e, fn);\n    }\n  }\n};\n\nSoundCloud.prototype.preload = function (streamUrl, preloadType) {\n  this._track = { stream_url: streamUrl };\n\n  if (preloadType) {\n    this.audio.preload = preloadType;\n  }\n\n  this.audio.src = this._clientId ? _appendQueryParam(streamUrl, 'client_id', this._clientId) : streamUrl;\n};\n\nSoundCloud.prototype.play = function (options) {\n  options = options || {};\n  var src;\n\n  if (options.streamUrl) {\n    src = options.streamUrl;\n  } else if (this._playlist) {\n    var length = this._playlist.tracks.length;\n    if (length) {\n      if (options.playlistIndex === undefined) {\n        this._playlistIndex = this._playlistIndex || 0;\n      } else {\n        this._playlistIndex = options.playlistIndex;\n      }\n\n      // be silent if index is out of range\n      if (this._playlistIndex >= length || this._playlistIndex < 0) {\n        this._playlistIndex = 0;\n        return;\n      }\n      src = this._playlist.tracks[this._playlistIndex].stream_url;\n    }\n  } else if (this._track) {\n    src = this._track.stream_url;\n  }\n\n  if (!src) {\n    throw new Error('There is no tracks to play, use `streamUrl` option or `load` method');\n  }\n\n  if (this._clientId) {\n    src = _appendQueryParam(src, 'client_id', this._clientId);\n  }\n\n  if (src !== this.audio.src) {\n    this.audio.src = src;\n  }\n\n  this.playing = src;\n\n  return this.audio.play();\n};\n\nSoundCloud.prototype.pause = function () {\n  this.audio.pause();\n  this.playing = false;\n};\n\nSoundCloud.prototype.stop = function () {\n  this.audio.pause();\n  this.audio.currentTime = 0;\n  this.playing = false;\n};\n\nSoundCloud.prototype.next = function (options) {\n  options = options || {};\n  var tracksLength = this._playlist.tracks.length;\n\n  if (this._playlistIndex >= tracksLength - 1) {\n    if (options.loop) {\n      this._playlistIndex = -1;\n    } else {\n      return;\n    }\n  }\n\n  if (this._playlist && tracksLength) {\n    return this.play({ playlistIndex: ++this._playlistIndex });\n  }\n};\n\nSoundCloud.prototype.previous = function () {\n  if (this._playlistIndex <= 0) {\n    return;\n  }\n\n  if (this._playlist && this._playlist.tracks.length) {\n    return this.play({ playlistIndex: --this._playlistIndex });\n  }\n};\n\nSoundCloud.prototype.seek = function (e) {\n  if (!this.audio.readyState) {\n    return false;\n  }\n\n  var percent = e.offsetX / e.target.offsetWidth || (e.layerX - e.target.offsetLeft) / e.target.offsetWidth;\n\n  this.audio.currentTime = percent * (this.audio.duration || 0);\n};\n\nSoundCloud.prototype.cleanData = function () {\n  this._track = void 0;\n  this._playlist = void 0;\n};\n\nSoundCloud.prototype.setVolume = function (volumePercentage) {\n  if (!this.audio.readyState) {\n    return;\n  }\n\n  this.audio.volume = volumePercentage;\n};\n\nSoundCloud.prototype.setTime = function (seconds) {\n  if (!this.audio.readyState) {\n    return;\n  }\n\n  this.audio.currentTime = seconds;\n};\n\nmodule.exports = SoundCloud;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbm9kZV9tb2R1bGVzL3NvdW5kY2xvdWQtYXVkaW8vaW5kZXguanM/NmE3ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBhbmNob3I7XG52YXIga2V5cyA9ICdwcm90b2NvbCBob3N0bmFtZSBob3N0IHBhdGhuYW1lIHBvcnQgc2VhcmNoIGhhc2ggaHJlZicuc3BsaXQoJyAnKTtcbmZ1bmN0aW9uIF9wYXJzZVVSTCAodXJsKSB7XG4gIGlmICghYW5jaG9yKSB7XG4gICAgYW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICB9XG5cbiAgdmFyIHJlc3VsdCA9IHt9O1xuXG4gIGFuY2hvci5ocmVmID0gdXJsIHx8ICcnO1xuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBrZXlzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgcmVzdWx0W2tleV0gPSBhbmNob3Jba2V5XTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIF9hcHBlbmRRdWVyeVBhcmFtICh1cmwsIHBhcmFtLCB2YWx1ZSkge1xuICB2YXIgVSA9IF9wYXJzZVVSTCh1cmwpO1xuICB2YXIgcmVnZXggPSAvXFw/KD86LiopJC87XG4gIHZhciBjaHIgPSByZWdleC50ZXN0KFUuc2VhcmNoKSA/ICcmJyA6ICc/JztcbiAgdmFyIHJlc3VsdCA9IFUucHJvdG9jb2wgKyAnLy8nICsgIFUuaG9zdCArIFUucG9ydCArIFUucGF0aG5hbWUgKyBVLnNlYXJjaCArIGNociArIHBhcmFtICsgJz0nICsgdmFsdWUgKyBVLmhhc2g7XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gU291bmRDbG91ZCAoY2xpZW50SWQpIHtcbiAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFNvdW5kQ2xvdWQpKSB7XG4gICAgcmV0dXJuIG5ldyBTb3VuZENsb3VkKGNsaWVudElkKTtcbiAgfVxuXG4gIGlmICghY2xpZW50SWQpIHtcbiAgICBjb25zb2xlLmluZm8oJ1NvdW5kQ2xvdWQgQVBJIHJlcXVpcmVzIGNsaWVudElkLCBnZXQgaXQgYXQgaHR0cHM6Ly9kZXZlbG9wZXJzLnNvdW5kY2xvdWQuY29tJyk7XG4gIH1cblxuICB0aGlzLl9ldmVudHMgPSB7fTtcblxuICB0aGlzLl9jbGllbnRJZCA9IGNsaWVudElkO1xuICB0aGlzLl9iYXNlVXJsID0gJ2h0dHBzOi8vYXBpLnNvdW5kY2xvdWQuY29tJztcblxuICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcbiAgdGhpcy5kdXJhdGlvbiA9IDA7XG5cbiAgdGhpcy5hdWRpbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XG59XG5cblNvdW5kQ2xvdWQucHJvdG90eXBlLnJlc29sdmUgPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaykge1xuICB2YXIgcmVzb2x2ZVVybCA9IHRoaXMuX2Jhc2VVcmwgKyAnL3Jlc29sdmUuanNvbj91cmw9JyArIGVuY29kZVVSSUNvbXBvbmVudCh1cmwpICsgJyZjbGllbnRfaWQ9JyArIHRoaXMuX2NsaWVudElkO1xuXG4gIHRoaXMuX2pzb24ocmVzb2x2ZVVybCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICB0aGlzLmNsZWFuRGF0YSgpO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgIHZhciB0cmFja3MgPSBkYXRhO1xuICAgICAgZGF0YSA9IHt0cmFja3M6IHRyYWNrc307XG4gICAgICB0aGlzLl9wbGF5bGlzdCA9IGRhdGE7XG4gICAgfSBlbHNlIGlmIChkYXRhLnRyYWNrcykge1xuICAgICAgdGhpcy5fcGxheWxpc3QgPSBkYXRhO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl90cmFjayA9IGRhdGE7XG5cbiAgICAgIC8vIHNhdmUgdGltaW5nc1xuICAgICAgdmFyIFUgPSBfcGFyc2VVUkwodXJsKTtcbiAgICAgIHRoaXMuX3RyYWNrLnN0cmVhbV91cmwgKz0gVS5oYXNoO1xuICAgIH1cblxuICAgIHRoaXMuZHVyYXRpb24gPSBkYXRhLmR1cmF0aW9uICYmICFpc05hTihkYXRhLmR1cmF0aW9uKSA/XG4gICAgICBkYXRhLmR1cmF0aW9uIC8gMTAwMCA6IC8vIGNvbnZlcnQgdG8gc2Vjb25kc1xuICAgICAgMDsgLy8gbm8gZHVyYXRpb24gaXMgemVyb1xuXG4gICAgY2FsbGJhY2soZGF0YSk7XG4gIH0uYmluZCh0aGlzKSk7XG59O1xuXG4vLyBkZXByZWNhdGVkXG5Tb3VuZENsb3VkLnByb3RvdHlwZS5fanNvbnAgPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaykge1xuICB2YXIgdGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdIHx8IGRvY3VtZW50LmhlYWQ7XG4gIHZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgdmFyIGlkID0gJ2pzb25wX2NhbGxiYWNrXycgKyAobmV3IERhdGUoKSkudmFsdWVPZigpICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMCk7XG5cbiAgd2luZG93W2lkXSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgaWYgKHNjcmlwdC5wYXJlbnROb2RlKSB7XG4gICAgICBzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuICAgIH1cbiAgICB3aW5kb3dbaWRdID0gZnVuY3Rpb24gKCkge307XG4gICAgY2FsbGJhY2soZGF0YSk7XG4gIH07XG5cbiAgc2NyaXB0LnNyYyA9IF9hcHBlbmRRdWVyeVBhcmFtKHVybCwgJ2NhbGxiYWNrJywgaWQpO1xuICB0YXJnZXQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2NyaXB0LCB0YXJnZXQpO1xufTtcblxuU291bmRDbG91ZC5wcm90b3R5cGUuX2pzb24gPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaykge1xuICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG4gIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgIHZhciByZXNwID0ge307XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmVzcCA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIC8vIGZhaWwgc2lsZW50bHlcbiAgICAgICAgfVxuICAgICAgICBjYWxsYmFjayhyZXNwKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgeGhyLnNlbmQobnVsbCk7XG59O1xuXG5Tb3VuZENsb3VkLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChlLCBmbikge1xuICB0aGlzLl9ldmVudHNbZV0gPSBmbjtcbiAgdGhpcy5hdWRpby5hZGRFdmVudExpc3RlbmVyKGUsIGZuLCBmYWxzZSk7XG59O1xuXG5Tb3VuZENsb3VkLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoZSwgZm4pIHtcbiAgdGhpcy5fZXZlbnRzW2VdID0gbnVsbDtcbiAgdGhpcy5hdWRpby5yZW1vdmVFdmVudExpc3RlbmVyKGUsIGZuKTtcbn07XG5cblNvdW5kQ2xvdWQucHJvdG90eXBlLnVuYmluZEFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgZm9yICh2YXIgZSBpbiB0aGlzLl9ldmVudHMpIHtcbiAgICB2YXIgZm4gPSB0aGlzLl9ldmVudHNbZV07XG4gICAgaWYgKGZuKSB7XG4gICAgICB0aGlzLm9mZihlLCBmbik7XG4gICAgfVxuICB9XG59O1xuXG5Tb3VuZENsb3VkLnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24gKHN0cmVhbVVybCwgcHJlbG9hZFR5cGUpIHtcbiAgdGhpcy5fdHJhY2sgPSB7c3RyZWFtX3VybDogc3RyZWFtVXJsfTtcblxuICBpZiAocHJlbG9hZFR5cGUpIHtcbiAgICB0aGlzLmF1ZGlvLnByZWxvYWQgPSBwcmVsb2FkVHlwZTtcbiAgfVxuXG4gIHRoaXMuYXVkaW8uc3JjID0gdGhpcy5fY2xpZW50SWQgP1xuICAgIF9hcHBlbmRRdWVyeVBhcmFtKHN0cmVhbVVybCwgJ2NsaWVudF9pZCcsIHRoaXMuX2NsaWVudElkKSA6XG4gICAgc3RyZWFtVXJsO1xufTtcblxuU291bmRDbG91ZC5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB2YXIgc3JjO1xuXG4gIGlmIChvcHRpb25zLnN0cmVhbVVybCkge1xuICAgIHNyYyA9IG9wdGlvbnMuc3RyZWFtVXJsO1xuICB9IGVsc2UgaWYgKHRoaXMuX3BsYXlsaXN0KSB7XG4gICAgdmFyIGxlbmd0aCA9IHRoaXMuX3BsYXlsaXN0LnRyYWNrcy5sZW5ndGg7XG4gICAgaWYgKGxlbmd0aCkge1xuICAgICAgaWYgKG9wdGlvbnMucGxheWxpc3RJbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMuX3BsYXlsaXN0SW5kZXggPSB0aGlzLl9wbGF5bGlzdEluZGV4IHx8IDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9wbGF5bGlzdEluZGV4ID0gb3B0aW9ucy5wbGF5bGlzdEluZGV4O1xuICAgICAgfVxuXG4gICAgICAvLyBiZSBzaWxlbnQgaWYgaW5kZXggaXMgb3V0IG9mIHJhbmdlXG4gICAgICBpZiAodGhpcy5fcGxheWxpc3RJbmRleCA+PSBsZW5ndGggfHwgdGhpcy5fcGxheWxpc3RJbmRleCA8IDApIHtcbiAgICAgICAgdGhpcy5fcGxheWxpc3RJbmRleCA9IDA7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHNyYyA9IHRoaXMuX3BsYXlsaXN0LnRyYWNrc1t0aGlzLl9wbGF5bGlzdEluZGV4XS5zdHJlYW1fdXJsO1xuICAgIH1cbiAgfSBlbHNlIGlmICh0aGlzLl90cmFjaykge1xuICAgIHNyYyA9IHRoaXMuX3RyYWNrLnN0cmVhbV91cmw7XG4gIH1cblxuICBpZiAoIXNyYykge1xuICAgIHRocm93IG5ldyBFcnJvcignVGhlcmUgaXMgbm8gdHJhY2tzIHRvIHBsYXksIHVzZSBgc3RyZWFtVXJsYCBvcHRpb24gb3IgYGxvYWRgIG1ldGhvZCcpO1xuICB9XG5cbiAgaWYgKHRoaXMuX2NsaWVudElkKSB7XG4gICAgc3JjID0gX2FwcGVuZFF1ZXJ5UGFyYW0oc3JjLCAnY2xpZW50X2lkJywgdGhpcy5fY2xpZW50SWQpO1xuICB9XG5cbiAgaWYgKHNyYyAhPT0gdGhpcy5hdWRpby5zcmMpIHtcbiAgICB0aGlzLmF1ZGlvLnNyYyA9IHNyYztcbiAgfVxuXG4gIHRoaXMucGxheWluZyA9IHNyYztcblxuICByZXR1cm4gdGhpcy5hdWRpby5wbGF5KCk7XG59O1xuXG5Tb3VuZENsb3VkLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5hdWRpby5wYXVzZSgpO1xuICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcbn07XG5cblNvdW5kQ2xvdWQucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuYXVkaW8ucGF1c2UoKTtcbiAgdGhpcy5hdWRpby5jdXJyZW50VGltZSA9IDA7XG4gIHRoaXMucGxheWluZyA9IGZhbHNlO1xufTtcblxuU291bmRDbG91ZC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB2YXIgdHJhY2tzTGVuZ3RoID0gdGhpcy5fcGxheWxpc3QudHJhY2tzLmxlbmd0aDtcblxuICBpZiAodGhpcy5fcGxheWxpc3RJbmRleCA+PSB0cmFja3NMZW5ndGggLSAxKSB7XG4gICAgaWYgKG9wdGlvbnMubG9vcCkge1xuICAgICAgdGhpcy5fcGxheWxpc3RJbmRleCA9IC0xO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgaWYgKHRoaXMuX3BsYXlsaXN0ICYmIHRyYWNrc0xlbmd0aCkge1xuICAgIHJldHVybiB0aGlzLnBsYXkoe3BsYXlsaXN0SW5kZXg6ICsrdGhpcy5fcGxheWxpc3RJbmRleH0pO1xuICB9XG59O1xuXG5Tb3VuZENsb3VkLnByb3RvdHlwZS5wcmV2aW91cyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMuX3BsYXlsaXN0SW5kZXggPD0gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0aGlzLl9wbGF5bGlzdCAmJiB0aGlzLl9wbGF5bGlzdC50cmFja3MubGVuZ3RoKSB7XG4gICAgcmV0dXJuIHRoaXMucGxheSh7cGxheWxpc3RJbmRleDogLS10aGlzLl9wbGF5bGlzdEluZGV4fSk7XG4gIH1cbn07XG5cblNvdW5kQ2xvdWQucHJvdG90eXBlLnNlZWsgPSBmdW5jdGlvbiAoZSkge1xuICBpZiAoIXRoaXMuYXVkaW8ucmVhZHlTdGF0ZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHZhciBwZXJjZW50ID0gZS5vZmZzZXRYIC8gZS50YXJnZXQub2Zmc2V0V2lkdGggfHwgKGUubGF5ZXJYIC0gZS50YXJnZXQub2Zmc2V0TGVmdCkgLyBlLnRhcmdldC5vZmZzZXRXaWR0aDtcblxuICB0aGlzLmF1ZGlvLmN1cnJlbnRUaW1lID0gcGVyY2VudCAqICh0aGlzLmF1ZGlvLmR1cmF0aW9uIHx8IDApO1xufTtcblxuU291bmRDbG91ZC5wcm90b3R5cGUuY2xlYW5EYXRhID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLl90cmFjayA9IHZvaWQgMDtcbiAgdGhpcy5fcGxheWxpc3QgPSB2b2lkIDA7XG59O1xuXG5Tb3VuZENsb3VkLnByb3RvdHlwZS5zZXRWb2x1bWUgPSBmdW5jdGlvbiAodm9sdW1lUGVyY2VudGFnZSkge1xuICBpZiAoIXRoaXMuYXVkaW8ucmVhZHlTdGF0ZSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuYXVkaW8udm9sdW1lID0gdm9sdW1lUGVyY2VudGFnZTtcbn07XG5cblNvdW5kQ2xvdWQucHJvdG90eXBlLnNldFRpbWUgPSBmdW5jdGlvbiAoc2Vjb25kcykge1xuICBpZiAoIXRoaXMuYXVkaW8ucmVhZHlTdGF0ZSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuYXVkaW8uY3VycmVudFRpbWUgPSBzZWNvbmRzO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTb3VuZENsb3VkO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIG5vZGVfbW9kdWxlcy9zb3VuZGNsb3VkLWF1ZGlvL2luZGV4LmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///19\n")}]);